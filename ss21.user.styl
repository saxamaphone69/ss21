/* ==UserStyle==
@name           ss21
@namespace      https://github.com/saxamaphone69/
@version        2.5.2
@description    a self-centered, fresh attempt at (user)styling 4chan
@author         sax
@homepageURL    https://github.com/saxamaphone69/ss21
@updateURL      https://github.com/saxamaphone69/ss21/raw/main/ss21.user.styl
@supportURL     https://github.com/saxamaphone69/ss21/issues
@license        CC-BY-SA-4.0
@preprocessor   stylus
@var range      ss21fontSize         "Default font size" [16, 10, 18, 2, "px"]
@var checkbox   ss21roundedCorners   "Rounded corners" 1
@var select     ss21readingMode      "Reading mode" ["ss21dark:Dark theme*", "ss21light:Light theme", "ss21yotsuba:Yotsuba", "ss21tomorrow:Tomorrow", "ss21photon:Photon"]
@var color      ss21primary          "Primary colour" #FFBE98
@var select     ss21spacingLevel     "Spacing amount" ["0:Comfortable", "1:Compact"]
@var checkbox   ss21underlineLink    "Underline external links" 1
@var checkbox   ss21postWidth        "Full-width posts" 1
@var checkbox   ss21boardCenter      "Centered board" 1
@var select     ss21sidebar          "Sidebar" ["0:None*", "1:Right-hand side", "2:Left-hand side"]
@var select     ss21QRPosition       "QR position" ["1:Floating*", "2:Locked right", "3:Fixed pop-out"]
@var select     ss21buttonStyle      "Button style" ["1:Contained", "2:Outline", "3:Text", "4:Material 3*"]
@var select     ss21textStyle        "Text input style" ["1:Outline*", "2:Fill"]
@var checkbox   ss21quoteColour      "Default olive" 0
@var checkbox   ss21boardBanner      "Enable board title and banner" 1
@var checkbox   ss21evenPosts        "Recolour even post backgrounds" 1
@var checkbox   ss21blotter          "Show blotter" 0
@var select     ss21headerHeight     "Header height" ["1:Tall", "2:Short"]
@var checkbox   ss21opacityHeader    "Make header slightly transparent" 0
@var checkbox   ss21forcedAnon       "Hide all names/tripcodes/IDs" 0
@var checkbox   ss21onlyNames        "Only show names/tripcodes/IDs" 0
@var checkbox   ss21postInfoBg       "Give post information a background" 0
@var checkbox   ss21postInfoFont     "Shrink post information font size" 1
@var checkbox   ss21postInfoDisplay  "Show post information on hover" 1
@var select     ss21fileInfo         "File information" ["1:Always displayed", "2:On hover*", "3:As a card"]
@var checkbox   ss21threeWide        "On wide screens, show 3 threads" 1
@var checkbox   ss21thumbnailOpacity "Drastically reduce opacity of thumbnails" 0
@var select     ss21flatness         "Materialness" ["0:Flat", "1:Elevated", "2:Bordered*"]
@var select     ss21openThread       "Open Thread style" ["0:Traditional", "1:FAB*"]
@var checkbox   ss21allowContest     "If unblocked, show contest banners" 0
@var checkbox   ss21allowAds         "If unblocked, show ads (yuck)" 0
@var select     ss21iconFont         "Icon font" ["1:Bootstrap", "2:Material Symbols*"]
@var checkbox   ss21navRail          "Display settings as navigation rail" 1
@var select     ss21watchButton      "Watch thread button" ["1:Always displayed*", "2:On hover"]
@var select     ss21watchButtonIcon  "Watch thread icon" ["1:Heart*", "2:Star"]
@var select     ss21catalogueStyle   "Catalogue styling" ["1:Default-esque*", "2:Masonry (buggy)"]
@var select     ss21backlinkStyle    "Backlink styling" ["1:Text*", "2:Icon"]
@var checkbox   ss21catalogueIcons   "Display icons for catalogue stats" 0
@var checkbox   ss21compressBoards   "Reduce width of full board list" 0
@var checkbox   ss21floatingHeader   "Detaches the header from the top" 0
@var checkbox   ss21nonPrimaryHeader "Makes the header surface-coloured" 0
@var checkbox   ss21noReplyAllowed   "Make 'You cannot reply anymore' appear as a toast" 1
@var checkbox   ss21tableView        "'All threads' appear as a table" 1
==/UserStyle== */

@-moz-document regexp('https://(boards|find)\\.4chan(?:nel)?\\.org.*')
	// XXX: probably should allow custom ui font, and monospace font
	@import url('https://rsms.me/inter/inter.css');
	@import url('https://fonts.googleapis.com/css2?family=Inconsolata&display=swap');
	if ss21iconFont == 1
		@import url("https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css");
	else if ss21iconFont == 2
		@import url('https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200');
	/*
	material spec:
	 text black on white, #000 high .87
	 text black on white, #000 medium .6
	 text black on white, #000 disabled .38
	 
	 icon black on white, active+focus .87
	 icon black on white, active+NOT focused .54
	 icon black on white, inactive .38
	*/
	
	/*
	 * yes, ss21 is still around, even 5 years later. it utilises the latest and
	 * greatest web technologies and practices to create a userstyle that is
	 * unique; standing out from the (onee|app)chan styles that the majority of
	 * ricers use.
	 */
	// really, this should also be able to accept a text emphasis/state level
	// and then determine how much opacity to apply
	// for example, if te === high, take white and make it .87,
	// if te === medium, take white (or black) and make it .6
	tc(colour, emphasis)
		if emphasis == high
			_emphasis = .87
		if emphasis == medium
			_emphasis = .6
		if emphasis == low
			_emphasis = .38
		if contrast(#fff, colour).ratio >= 4.5
			color rgba(255, 255, 255, _emphasis)
		else
			color rgba(33, 33, 33, _emphasis)
	if ss21readingMode == ss21dark
		ss21OppColour = #fff
		ss21TextPrimary = alpha(#fff, .87)
		ss21TextSecondary = alpha(#fff, .6)
		ss21TextHint = alpha(#fff, .38)
		ss21BackgroundColour = #121212
		ss21BackgroundElevated = #1f1f1f
	else if ss21readingMode == ss21light
		ss21OppColour = #212121
		ss21TextPrimary = alpha(#212121, .87)
		ss21TextSecondary = alpha(#212121, .6)
		ss21TextHint = alpha(#212121, .38)
		ss21BackgroundColour = #eaeaea
		ss21BackgroundElevated = #fff
	else if ss21readingMode == ss21yotsuba
		ss21OppColour = #212121
		ss21TextPrimary = alpha(#212121, .87)
		ss21TextSecondary = alpha(#212121, .6)
		ss21TextHint = alpha(#212121, .38)
		ss21BackgroundColour = #eef2ff
		ss21BackgroundElevated = #d6daf0
		:root.ws
			--4chan-subject #0f0c5d
			--4chan-name #117743
			--4chan-trip #117743
			--4chan-quote #789922
			--4chan-link #34345c
			--4chan-link-hover #d00
			--4chan-board-title #af0a0f
			--4chan-text #000
			--4chan-text-link #000
			--4chan-background #eef2ff
			--4chan-post-bg #d6daf0 // header and dialogs
			--4chan-post-border #b7c5d9 // borders and hr
		:root.nws
			--4chan-subject #cc1105
			--4chan-name #117743
			--4chan-trip #117743
			--4chan-quote #789922
			--4chan-link #00e
			--4chan-link-hover #f00
			--4chan-board-title #800
			--4chan-text #800
			--4chan-text-link #800
			--4chan-background #ffe
			--background-primary #f0e0d6 // header and dialogs
			--4chan-post-border #d9bfb7 // borders and hr
	else if ss21readingMode == ss21tomorrow
		ss21OppColour = #212121
		ss21TextPrimary = alpha(#c5c8c6, .87)
		ss21TextSecondary = alpha(#c5c8c6, .6)
		ss21TextHint = alpha(#c5c8c6, .38)
		ss21BackgroundColour = #1d1f21
		ss21BackgroundElevated = #282a2e
	else if ss21readingMode == ss21photon
		ss21OppColour = #212121
		ss21TextPrimary = alpha(#333, .87)
		ss21TextSecondary = alpha(#333, .6)
		ss21TextHint = alpha(#333, .38)
		ss21BackgroundColour = #eee
		ss21BackgroundElevated = #ddd
	z-depth(n = 1)
		if n == 1
			box-shadow 0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px 0px rgba(0, 0, 0, 0.14), 0px 1px 3px 0px rgba(0, 0, 0, 0.12)
		if n == 2 // card, button
			box-shadow 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)
		if n == 4 // top app bar, button hover
			box-shadow 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12)
		if n == 6 // snackbar
			box-shadow 0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12)
		if n == 8 // menu, button active
			box-shadow 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12)
		if n == 16 // nav drawer
			box-shadow 0px 8px 10px -5px rgba(0, 0, 0, 0.2), 0px 16px 24px 2px rgba(0, 0, 0, 0.14), 0px 6px 30px 5px rgba(0, 0, 0, 0.12)
		if n == 24 // dialogue
			box-shadow 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12)
	
	borderRadius()
		if ss21roundedCorners
			border-radius 4px
	
	i = !important
	/* thankfully we have css custom properties (a.k.a. variables) we can use,
	 * along with stylus-lang to create a dynamic and truly customisable
	 * userstyle
	 */
	// stylus variables, only so we can use functions
	ss21-primary = ss21primary
	ss21-on-primary = tc(ss21primary, high)
	ss21-surface = #fff
	ss21-on-surface = #000
	ss21posterFounder = #117743
	ss21posterAdmin = #f44336
	ss21posterMod = #9c27b0
	ss21posterDev = #0000f0
	ss21posterManager = #ff0080
	ss21posterVerified = #007fff
	ss21posterPass = #afb42b
	ss21poster(type)
		if type == 'founder'
			return #117743
		if type == 'admin'
			return #f44336
		if type == 'mod'
			return #9c27b0
		if type == 'dev'
			return #0000f0
		if type == 'manager'
			return #ff0080
		if type == 'verified'
			return #007fff
		if type == 'pass'
			return #afb42b
	ss21red = #f44336
	ss21blue = #2196f3
	ss21green = #4caf50
	ss21purple = #9c27b0
	ss21orange = #ff9800
	ss21minContrastRatio = 3
	// should be tint to lighten
	// should be shade to darken
	ss21spacer = 1rem
	// bootstrap breakpoints
	// sm 540, md 720, lg 960, xl 1140, xxl 1320
	// https://github.com/twbs/bootstrap/blob/master/scss/_variables.scss
	// https://github.com/twbs/bootstrap/blob/master/scss/_functions.scss
	:root
		--primary ss21primary
		--secondary invert(ss21primary)
		--text-primary-on-background ss21TextPrimary
		--text-secondary-on-background ss21TextSecondary
		--text-hint-on-background ss21TextHint
		//--text-primary-on-primary ss21-on-primary
		/*
		--text-primary-on-primary textContraster(ss21primary, .87)
		--text-secondary-on-primary textContraster(ss21primary, .6)
		--text-hint-on-primary textContraster(ss21primary, .38)
		*/
		--background-primary ss21BackgroundElevated
		--background-secondary ss21BackgroundColour
		--grey-100 #f8f8fb
		--grey-300 #eeeef2
		--grey-500 #b3b3b6
		--grey-700 #737376
		--grey-900 #303033
		--grey-12 #121212
		--font-default 'InterVariable', system-ui
		--font-monospace 'Inconsolata', monospace, monospace
	// SIDEDISH: we add a `site-loading` class to `html` to hide content while
	// it loads. also create a pseudo element loader/spinner in the mean time
	/*
	:root.site-loading
		#delform
			display flex
			align-items center
			justify-content center
			height 70vh
			&::before
				content ''
				display block
				border .5rem solid grayscale(ss21primary)
				border-top-color ss21primary
				border-radius 50%
				width 10rem
				height 10rem
				margin auto
				animation loading 1s infinite
		#header-bar,
		#bannerCnt,
		.navLinks,
		.board,
		.pagelist
			display none i
	*/
	:root
		interpolate-size allow-keywords
	
	@css {
		@supports (view-transition-name: none) {
			@view-transition {
				navigation: auto;
			}
			::view-transition-group(root) {
				animation-duration: 2s;
			}
			::view-transition-old(root) {
				animation-name: slide-out;
			}
			::view-transition-new(root) {
				animation-name: slide-in;
			}
			@keyframes slide-in {
				from {
					translate: 100vw 0;
				}
			}
			@keyframes slide-out {
				to {
					translate: -100vw 0;
				}
			}
			.op .fileThumb,
			.boardBanner {
				view-transition-name: heroimg;
			}
		}
	}
	
	@css {
	@keyframes loading {
		to {
			transform: rotate(359deg);
		}
	}
	}
	// let's hide stuff we don't need: ads!
	// first, let's keep `!important` away as to not pollute scope
	.center,
	.arc-ads,
	.adl,
	.danbo-slot,
	[hidden]
		display none i
	
	// and while we're here:
	// 1. mobile elements
	// 2. a bunch of elements we never use also have `.desktop`, so that's convenient
	// 3. all `hr` elements, bar the unread line
	// 4. ccd0 caters for mentally challenged people who can't manage to start a thread
	// 5. the original post form (use the qr)
	// 6. checkboxes next to posts (use the menu)
	// 7. ad pleas (buy a 4chan pass, friend)
	// 8. the '>>' to the left of posts when reply hiding isn't on
	.mobile,
	.desktop:not(#bannerCnt, .postInfo, .postNum, .summary, .pagelist, #boardNavDesktopFoot),
	hr:not(#unread-line),
	.qr-link-container,
	.postForm,
	.postInfo > input,
	.ad-plea,
	.adt-800,
	.adaps,
	.sideArrows,
	#navbotright,
	#toggleMsgBtn // sometimes this leaks through, so we add it despite it having `.desktop`
		display none
	// as always, using tried and tested web frameworks and design systems to
	// create a reset, reboot, and sensible base
	// reset everything on `:root` as opposed to `body`
	// 1. use google web fonts, or `system-ui`
	// 2. set a relative baseline `font-size` and `line-height` for easy math
	// 3. default `color` and `background` to help us determine light|dark mode
	// 4. make text render a little nicer
	// 5. always apply a scrollbar regardless of page height
	:root
		font-family var(--font-default)
		font-size 1rem
		line-height 1.5
		color var(--text-primary-on-background)
		background-color var(--background-secondary)
		-webkit-font-smoothing antialiased
		-moz-osx-font-smoothing grayscale
		scroll-behavior smooth
		text-rendering optimizeLegibility // XXX: despite https://marco.org/2012/11/15/text-rendering-optimize-legibility - inter ui needs it for ligatures
		overflow-y scroll
		overflow-wrap anywhere
		//word-break break-word // XXX: might not even work tbh
		box-sizing border-box
		transition color .25s, background-color .25s
		accent-color ss21primary
		if ss21readingMode == ss21dark
			color-scheme dark
	@css {
	:root .navLinks {
		--is-nws: brown;
		background-color: var(--is-nws, var(--primary)) !important;
	}
	:root.ws .navLinks {
		--is-nws: initial;
	}
	}
	// XXX: https://css-tricks.com/fixing-smooth-scrolling-with-find-on-page/
	:root:focus-within
		scroll-behavior smooth
	// https://github.com/csstools/sanitize.css/blob/main/sanitize.css#L54
	// this doesn't actually work but?
	/*
	:where(body)
		block-size -moz-available
		block-size -webkit-fill-available
		block-size stretch
		min-height 100vh
		//font-size ss21fontSize
	*/
	:root
		-webkit-text-size-adjust none
		text-size-adjust none
	// let's reset `box-sizing` so that when we say `1rem`, we mean it
	// http://www.paulirish.com/2012/box-sizing-border-box-ftw/ along with
	// https://css-tricks.com/inheriting-box-sizing-probably-slightly-better-best-practice/
	*,
	::before,
	::after
		box-sizing inherit
	
	// it is bad practice/UX to not give focused elements visual feedback (not
	// to mention against the law), but there is a 0% chance anyone with visual
	// impairments would be using a userstyle
	// XXX: i actually want to support this
	:focus
		outline 0
		//box-shadow 0 0 0 .25rem alpha(lighten(ss21primary, 50%), .25)
		//isolation isolate
	
	:focus-visible
		box-shadow 0 0 0 .25rem alpha(lighten(ss21primary, 50%), .25)
	
	// XXX: should only apply when using keyboard
	// :focus-within is any type of focus
	/*
	.postContainer:focus-within .post
		background-color mix(ss21primary, ss21BackgroundElevated, 7%)
		box-shadow 0 0 0 .25rem alpha(lighten(ss21primary, 50%), .25)
	*/
	
	// https://developer.mozilla.org/en-US/docs/Web/CSS/:focus-visible
	// https://developer.paciellogroup.com/blog/2018/03/focus-visible-and-backwards-compatibility/
	
	//[tabindex="-1"]:focus:not(:focus-visible)
	//	outline 0 !important
	
	// make highlighted elements match the theme. also let's appreciate the fact
	// that after 10 years, we no longer need 2 separate declarations here
	// https://bugzilla.mozilla.org/show_bug.cgi?id=509958
	// https://caniuse.com/#feat=css-selection
	::selection
		background-color alpha(lighten(ss21primary, 25%), .1)
	
	// give scrollbars in webkit browsers some non-standard love
	// https://developer.mozilla.org/en-US/docs/Web/CSS/::-webkit-scrollbar
	// and hopefully one day, a standard is agreed upon
	// https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Scrollbars
	// https://drafts.csswg.org/css-scrollbars-1/
	/*
	::-webkit-scrollbar
		width .5rem
		height .5rem
		background-color var(--grey-500)
	::-webkit-scrollbar-thumb
		background-color var(--grey-700)
	*/
	// address `font-weight` set incorrectly in all browsers. while we're here we
	// set other elements we want to `bold`, too
	b, strong, th
		font-weight 700
	
	.subject, .name
		font-weight 700
	
	// XXX: potentially expensive override to inline-styled elements to ensure
	// consistent styling
	[style*="weight:"]
		font-weight 700 i
	
	// reset the default margin given to these elements
	blockquote,
	body,
	h1, h2, h3, h4, h5, h6,
	p
		margin 0
	
	// in the off chance that an announcement is done with the heading elements,
	// at least make it look nice
	h1, h2, h3, h4, h5, h6
		line-height 1.2
		font-weight 700
		//margin-bottom .5rem
	
	h1
		font-size calc(1.375rem + 1.5vw)
	
	h2
		font-size calc(1.325rem + .9vw)
	
	h3
		font-size calc(1.3rem + .6vw)
	
	h4
		font-size calc(1.275rem + .3vw)
	
	h5
		font-size 1.25rem
	
	h6
		font-size 1rem
	
	p
		margin-bottom 1rem
	
	// ensure the correct `font-size` in all browsers
	:where(small)
		font-size .875em
	
	// prevent `sup` and `sub` elements from affecting line height
	sup,
	sub
		font-size .75em
		line-height 0
		vertical-align baseline
		position relative
	
	sup
		top -.5em
	
	sub
		bottom -.25em
	
	// opt for `inherit` being used because very few `a` elements are a consistent
	// colour, and also remove all underlines, if enabled
	// XXX: linkify links should be the option, not the exception
	a
		color inherit
		text-decoration none
		transition color .25s
	
	// the exception being linkified links
	.linkify,
	//:where(.globalMessage) :where(a):not(.fa), // XXX until theres another global announcement, there is no way this shit is good
	// 2025XXX: For whatever reason, I had this complex selector to underline external links.
	// Just let `Linkify` do it.
	//.postMessage > a[href*="//"]:not([href*="boards.4chan.org"]),
	//.postMessage a[href*="boards.4chan.org"]:not(.quotelink):not(.hashlink)
		text-decoration solid underline
		text-underline-offset 2px // XXX: 1px suddenly stopped looking good?
		unless ss21underlineLink
			text-decoration none
		color ss21primary
		&:hover
			color shade(ss21primary, 15%)
	
	linkify-icons($icon, $icon2 = null)
		content ''
		display inline-block
		width 1em
		height 1em
		vertical-align -.125em
		margin-right .25rem
		background-position 50% 50%
		background-repeat no-repeat
		if $icon2
			background-image $icon, $icon2
		else
			background-image $icon
	
	// icons are, for the most part, grabbed from font awesome
	.linkify
		&.youtube::before
			linkify-icons(url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 576 512'%3E%3Cpath fill='%23f00' d='M549.7 124.1c-6.3-23.7-24.8-42.3-48.3-48.6C458.8 64 288 64 288 64S117.2 64 74.6 75.5c-23.5 6.3-42 24.9-48.3 48.6-11.4 42.9-11.4 132.3-11.4 132.3s0 89.4 11.4 132.3c6.3 23.7 24.8 41.5 48.3 47.8C117.2 448 288 448 288 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zm-317.5 213.5V175.2l142.7 81.2-142.7 81.2z'/%3E%3C/svg%3E"), radial-gradient(white .25em, transparent .25em))
		&.twitter::before
			linkify-icons(url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath fill='%231da1f2' d='M459.4 151.7c.3 4.5 .3 9.1 .3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53 51.7 63.7 129.3 105.3 216.4 109.8-1.6-7.8-2.6-15.9-2.6-24 0-57.8 46.8-104.9 104.9-104.9 30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3z'/%3E%3C/svg%3E"))
		&[href^="https://x.com"]::before
			linkify-icons(url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath fill='" + hsl(ss21OppColour) + "' d='M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z'/%3E%3C/svg%3E"))
		&.vocaroo
			color #CAFF70 i
		&[href^="https://github.com"]::before
			linkify-icons(url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='black' viewBox='0 0 16 16'%3E%3Cpath d='M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z'/%3E%3C/svg%3E"))
		&[href*="reddit.com"]::before
			linkify-icons(url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath fill='%23FF5700' d='M0 256C0 114.6 114.6 0 256 0S512 114.6 512 256s-114.6 256-256 256L37.1 512c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256zM349.6 153.6c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34c-34.5 3.7-61.4 33-61.4 68.4l0 .2c-37.5 1.6-71.8 12.3-99 29.1c-10.1-7.8-22.8-12.5-36.5-12.5c-33 0-59.8 26.8-59.8 59.8c0 24 14.1 44.6 34.4 54.1c2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54c0-33-26.8-59.8-59.8-59.8c-13.7 0-26.3 4.6-36.4 12.4c-27.4-17-62.1-27.7-100-29.1l0-.2c0-25.4 18.9-46.5 43.4-49.9l0 0c4.4 18.8 21.3 32.8 41.5 32.8zM177.1 246.9c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6s-31.4-8.8-30.4-30.5s15.4-38.3 32.1-38.3zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6c-1-21.7 11.8-39.3 28.5-39.3s31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9 .8-6.2 3.9-6.5c18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1 .3 5.1 3.6 3.9 6.5z'/%3E%3C/svg%3E"), radial-gradient(white .45em, transparent .45em))
		&.twitchtv::before
			linkify-icons(url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath fill='%23a970ff' d='M391.2 103.5H352.5v109.7h38.6zM285 103H246.4V212.8H285zM120.8 0 24.3 91.4V420.6H140.1V512l96.5-91.4h77.3L487.7 256V0zM449.1 237.8l-77.2 73.1H294.6l-67.6 64v-64H140.1V36.6H449.1z'/%3E%3C/svg%3E"))
		&.pastebin::before
			linkify-icons(url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAIGNIUk0AAHomAACAhAAA+gAAAIDoAAB1MAAA6mAAADqYAAAXcJy6UTwAAAAqUExURf///1ZZXHN7hfX29+7v8Gt1f2FrdvLz9I2UnHmAiYOJkc3MzHF5g////woBzAAAAAABdFJOUwBA5thmAAAAAWJLR0QAiAUdSAAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAAd0SU1FB+kBEAAlFGLPml8AAABRSURBVAjXY2AQBAMFBkZjY2djY2NTIEMYBM0YGA1BAMYwRmGAVBgKghhggMwohmsXBkGoYouZKyGM2bsTgFKChoKztzFAdM2ewMAAdsZJBgYAfJgWEYVsGdgAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjUtMDEtMTZUMDA6Mzc6MDArMDA6MDA//s61AAAAJXRFWHRkYXRlOm1vZGlmeQAyMDI1LTAxLTE2VDAwOjM3OjAwKzAwOjAwTqN2CQAAACh0RVh0ZGF0ZTp0aW1lc3RhbXAAMjAyNS0wMS0xNlQwMDozNzoyMCswMDowMFuTUKsAAAAASUVORK5CYII="))
	
	// correct some weird browser inconsistencies in font inheritance, and while
	// we're here, set tripcodes and user ids to also use a monospace font
	pre,
	code,
	kbd,
	.postertrip,
	.posteruid
		font-family var(--font-monospace)
		font-size 1em
	
	pre.prettyprint
		font-size .875rem
		-webkit-font-smoothing subpixel-antialiased
		white-space pre-wrap
		word-wrap normal
		word-spacing normal
		word-break normal
		tab-size 4
		hyphens none
		overflow auto // don't allow content to break outside
		padding .125rem .25rem // override prettify.css default if not blocked
		border 0 // remove prettify.css default if not blocked
		margin 0 // remove browser default
		display inline-block
		vertical-align middle
		max-width 100%
	
	// 4chan uses google prettify to format [code] tags on /g/
	// MIT License; github.com/jmblog/color-themes-for-google-code-prettify
	// Tomorrow on light theme, Tomorrow Night Eighties for all others
	// XXX: this can be cleaned up, and should apply to `kbd` and other `pre` too
	if ss21readingMode == ss21light
		pre.prettyprint
			background-color #fff
			.pln,
			.pun,
			.opn,
			.clo
				color #4d4d4c
			.str
				color #718c00
			.kwd
				color #8959a8
			.com
				color #8e908c
			.typ,
			.fun
				color #4271ae
			.lit,
			.atn,
			.dec
				color #f5871f
			.tag,
			.var
				color #c82829
			.atv
				color #3e999f
	else
		pre.prettyprint
			background-color #2d2d2d
			.pln,
			.pun,
			.opn,
			.clo
				color #ccc
			.str
				color #99cc99
			.kwd
				color #cc99cc
			.com
				color #999999
			.typ,
			.fun
				color #6699cc
			.lit,
			.atn,
			.dec
				color #f99157
			.tag,
			.var
				color #f2777a
			.atv
				color #66cccc
	
	// fix spacing of media objects, and make them responsive by default
	// XXX: `video` controls will appear slightly off the bottom of the video
	// when height is not a rounded amount
	embed,
	img,
	video
		display block // was `vertical-align: middle`
		height auto
		max-width 100%
	
	// `audio` separate, because it doesn't need to be responsive
	:where(audio)
		vertical-align middle
		width 100%
	
	:where(svg)
		height auto
		max-width 100%
	
	// remove the default border given to `iframe`
	iframe
		border 0
		vertical-align middle
	
	// prevent double borders in tables
	table
		border-collapse collapse
		border-spacing 0
	
	// reset generic form elements to look consistent across browsers
	// XXX: https://bugzil.la/1536148 - except `option` in Firefox, which due to
	// how they "render the process" cannot accept web fonts
	button,
	input,
	option,
	select,
	textarea
		font inherit
		color inherit
		margin 0
	
	button:not(.watch-thread-link),
	input[type="button"],
	input[type="submit"],
	a.replylink,
	:root.oneechan .options-button
		font-size .875rem
		line-height 1
		letter-spacing .09em
		text-transform uppercase
		position relative
		display inline-flex
		align-items center
		justify-content center
		//vertical-align middle
		padding 0 .75rem
		border 0
		min-height 2.25rem
		min-width 4rem
		borderRadius()
		cursor pointer
		user-select none
		transition all .25s
		if ss21buttonStyle == 1
			background-color ss21primary
			tc(ss21primary, high)
			z-depth(2)
			&:hover
				background-color mix(#fff, @background-color, 10%)
			&:active
				background-color mix(#fff, @background-color, 12%)
				transform translateY(1px)
		else if ss21buttonStyle == 2
			color ss21primary
			background transparent
			border 1px solid ss21primary
			&:hover
				background-color rgba(ss21primary, 0.1)
			&:active
				background-color rgba(ss21primary, 0.25)
				transform translateY(1px)
		else if ss21buttonStyle == 3
			color ss21primary
			background transparent
			&:hover
				background-color rgba(ss21primary, 0.1)
			&:active
				background-color rgba(ss21primary, 0.25)
				transform translateY(1px)
		else if ss21buttonStyle == 4
			background-color ss21primary
			text-transform none
			border-radius 32rem
			height 40px
			padding 0 24px
			&:hover
				background-color mix(#fff, @background-color, 10%)
			&:active
				background-color mix(#fff, @background-color, 12%)
	
	a.replylink
		min-height initial
		height 1.5rem
		margin-left .25rem
	
	// okay, so there are only a handful of input fields used in 4chan x anyway:
	// index search field (with 3 select dropdowns), qr, and the settings
	.field,
	:root.is-search .commentForm input[name='q']
		display inline-block
		background inherit
		padding .5rem .75rem
		border 1px solid alpha(ss21OppColour, .33)
		borderRadius()
		transition border .25s, box-shadow .25s
		&:hover
			border-color alpha(ss21OppColour, .8)
		&:focus
			border-color ss21primary
			box-shadow 0 0 0 .2rem alpha(ss21primary, .25)
	
	if ss21textStyle == 2
		.field
			background var(--ss21-dc-inverseOnSurface)
			border 0
			border-bottom-left-radius 0
			border-bottom-right-radius 0
			border-bottom 1px solid var(--ss21-dc-outline)
	
	// checkboxes used to be pseudo elements, but generic styling is pretty easy and reliable now
	// HEAVILY inspired from bootstrap, gov.uk, and carbon
	input[type="checkbox"]
		width 1.25em
		height 1.25em
		background-repeat no-repeat
		background-position center
		background-size contain
		border 2px solid alpha(ss21OppColour, .33)
		borderRadius()
		-webkit-appearance none
		-moz-appearance none
		appearance none
		vertical-align text-top
		margin-right .25rem
		cursor pointer // opinionated
		transition all .25s
		&:hover
			border-color alpha(ss21OppColour, .8)
		&:active
			filter brightness(90%)
		&:focus
			outline 0
			box-shadow 0 0 0 .2rem alpha(lighten(ss21primary, 15%), 25%)
		&:checked
			background-color ss21primary
			if contrast(#fff, ss21primary).ratio >= 4.5
				$tick = "%23fff"
			else
				$tick = "%23000"
			background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='" + $tick + "' d='M21 7L9 19l-5.5-5.5 1.41-1.41L9 16.17 19.59 5.59 21 7z'/%3E%3C/svg%3E")
			border-color darken(ss21primary, 33%)
	
	// XXX: dropdown arrow sometimes covers writing, may need more padding on right
	// XXX: the border needs to remain transparent OR opaque, cannot go between each
	select
		display inline-block
		tc(ss21BackgroundColour, high)
		background-color var(--background-primary)
		background-repeat no-repeat
		background-position bottom 1rem right .5rem
		background-size 16px 12px
		background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath fill='" + alpha(ss21OppColour, .54) + "' d='M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z'%3E%3C/path%3E%3C/svg%3E")
		padding .5rem 1.75rem .5rem .75rem
		border 1px solid alpha(ss21OppColour, .33)
		borderRadius()
		transition border-color .25s, box-shadow .25s
		word-wrap normal
		-webkit-appearance none
		-moz-appearance none
		appearance none
		&:hover
			border 1px solid alpha(ss21OppColour, .8)
		&:focus
			border 1px solid alpha(tint(ss21primary, 33%), .9)
			box-shadow 0 0 0 .25rem alpha(lighten(ss21primary, 50%), .25)
	textarea
		background inherit
		padding .5rem .75rem
		border 1px solid alpha(ss21OppColour, .33)
		borderRadius()
		resize vertical // `textarea` should only resize vertically as to not break their containers
		transition border .25s, box-shadow .25s
		&:hover
			border-color alpha(ss21OppColour, .8)
		&:focus
			border-color ss21primary
			box-shadow 0 0 0 .2rem alpha(ss21primary, .25)
	
	// generic styling for all disabled elements using the pseudo selector
	:disabled
		color var(--grey-900)
		background-color var(--grey-500)
		border 1px solid var(--grey-700)
		//cursor not-allowed
		pointer-events none
		opacity .5
	
	// make `label` elements appear clickable, because that's our opinion
	// https://medium.com/simple-human/buttons-shouldnt-have-a-hand-cursor-b11e99ca374b
	// https://fvsch.com/styling-buttons/
	label
		cursor pointer
	
	// make `fieldset` behave more like a block element
	fieldset
		min-width 0
		padding 0
		border 0
		margin 0
	
	// give `placeholder` text a specific colour, and ensure it renders
	// consistently across browsers
	::placeholder
		color var(--text-hint-on-background)
		opacity 1
	
	// correct cursor style of +/- buttons in safari for `input[type="number"]`
	:where(input[type="number"])
		-moz-appearance textfield
		&:hover,
		&:focus
			-moz-appearance number-input
	
	// removes the 'clear' button that chrome adds to `input[type=search]` elements
	::-webkit-search-decoration,
	::-webkit-search-cancel-button
		-webkit-appearance none
	
	// remove inner padding and border of buttons in firefox
	::-moz-focus-inner
		padding 0
		border-style none
	
	// ensure the only `hr` you will see, `#unread-line`, is styled consistently
	// across browsers and also set to green (as opposed to red)
	:where(#unread-line)
		box-sizing content-box
		height 0
		overflow visible
		border 0
		border-top 1px solid ss21green
		margin 1rem 0
	
	// `s` is used for [spoiler] text. occasionally, this has issues with
	// links and quoted text within spoilers
	s,
	s > .quote,
	s > a
		text-decoration none
		color var(--grey-12) i
		background-color var(--grey-12) i
		transition color .25s
	
	s:hover,
	s:hover .quote,
	s:hover a
		color var(--grey-100) i
	
	/*
<blockquote class="postMessage" id="m561357917"><a href="#p561357657" class="quotelink">&gt;&gt;561357657</a><br>Compare pic related to his Dx2 model which looks great<br><s><a class="linkify" rel="noreferrer noopener" target="_blank" href="https://static.wikia.nocookie.net/megamitensei/images/9/95/Metatron_in_DX2.png/revision/latest?cb=20191110121222">https://static.wikia.nocookie.net/m<wbr>egamitensei/images/9/95/Metatron_in<wbr>_DX2.png/revision/latest?cb=2019111<wbr>0121222</a></s></blockquote>

<blockquote class="postMessage" id="m82226876">/mkg/ - God damn it dude I'm so fucking sick of Cherry MX edition<br><br><span class="quote">&gt;Keyboard recommendation template</span><br><a class="linkify pastebin" rel="noreferrer noopener" target="_blank" href="https://pastebin.com/n220xk9V">https://pastebin.com/n220xk9V</a> <a class="embedder" href="javascript:;" data-key="Pastebin" data-uid="n220xk9V" data-options="undefined" data-href="https://pastebin.com/n220xk9V">(<span>un</span>embed)</a><br><br><span class="quote">&gt;Where to buy keyboards</span><br><a class="linkify" rel="noreferrer noopener" target="_blank" href="https://www.alexotos.com/keyboard-vendor-list/">https://www.alexotos.com/keyboard-v<wbr>endor-list/</a><br><a class="linkify" rel="noreferrer noopener" target="_blank" href="https://www.mechmap.tech/themap">https://www.mechmap.tech/themap</a><br><a class="linkify" rel="noreferrer noopener" target="_blank" href="https://keycaplendar.firebaseapp.com">https://keycaplendar.firebaseapp.co<wbr>m</a><br><br><span class="quote">&gt;Charts!</span><br><a class="linkify" rel="noreferrer noopener" target="_blank" href="https://kiibohd.com">https://kiibohd.com</a><br><br><span class="quote">&gt;QMK</span><br><a class="linkify" rel="noreferrer noopener" target="_blank" href="https://config.qmk.fm/">https://config.qmk.fm/</a><br><a class="linkify" rel="noreferrer noopener" target="_blank" href="https://beta.docs.qmk.fm">https://beta.docs.qmk.fm</a><br><br>Last thread: <a href="https://boards.4channel.org/g/thread/82209582/" target="_blank">https://boards.4channel.org/g/threa<wbr>d/82209582/</a></blockquote>

<blockquote class="postMessage" id="m561402095"><a href="#p561401769" class="quotelink">&gt;&gt;561401769</a><br>This is unironically him trying to sweep shit under the rug lmao<br><a href="#p561401960" class="quotelink">&gt;&gt;561401960</a><br>There's archived threads in which he got mass banned, I think this was the first mass ban he scored <a class="linkify quotelink" rel="noreferrer noopener" target="_blank" href="https://arch.b4k.co/v/thread/499343579/#q499358153" data-board-i-d="v" data-thread-i-d="499343579" data-post-i-d="499358153">https://arch.b4k.co/v/thread/499343<wbr>579/#q499358153</a><br>Look for how many posts got deleted</blockquote>

<blockquote class="postMessage" id="m4662311"><a href="#p4662298" class="quotelink">&gt;&gt;4662298</a><br><a href="//boards.4chan.org/r/#s=eddit" class="quotelink">&gt;&gt;&gt;/r/eddit</a></blockquote>

<blockquote class="postMessage" id="m563068435"><s>&gt;Is an asshole to you throughout the game<br><span class="quote">&gt;Tries to kill you and won't tell you why</span><br><span class="quote">&gt;Gets all your friends to betray and try to kill you</span><br><span class="quote">&gt;You still hang out with your "friends" like nothing they don't even bother to tell you why they want you dead and you're such a loser that you're fine with that and them continuing to try to oppose you.</span><br><span class="quote">&gt;You are also fine with her killing your dad, being free to kill you along with your friends trying to kill you.</span><br></s><br><br>No sane humans acts like this.<s><br>Yet you are all fine with it, do you enjoy your friends wanting to kill you and your family?</s><br>Explain.</blockquote>

<blockquote class="postMessage" id="m201302280"><s></s><a class="linkify" rel="noreferrer noopener" target="_blank" href="https://thetvapp.to/tv/hbo-east-live-stream/"><s>https://thetvapp.to/tv/hbo-east-liv<wbr>e-stream/</s></a> ep 4 right now</blockquote>

*/
	
	// 4CHANX: technically not a reset, but this is the only time we mention spoilers
	// so we're putting this here. if the reveal spoilers setting is on, support it
	:root.reveal-spoilers
		s,
		s > a
			color var(--grey-100) i
		.removed-spoiler
			&::before
				content '[spoiler]'
			&::after
				content '[/spoiler]'
	
	// https://github.com/stylus/stylus/issues/2750#issuecomment-1378498822
	buildL4(type, args...) {
		st1 = join('', ':', type, '(', join('\, ', args), ')')
		selector(st1)
	}
	
	:root.fourchan-xt .icon
		display none
	
	icon-style()
		if ss21iconFont == 1
			display inline-flex
			font-family bootstrap-icons
			font-style normal
			font-size 1.5rem
			font-weight normal
			font-variant normal
			text-transform none
			line-height 1
			-webkit-font-smoothing antialiased
			-moz-osx-font-smoothing grayscale
			visibility visible // added from 4chan x
		else if ss21iconFont == 2
			font-family 'Material Symbols Outlined'
			font-weight normal
			font-style normal
			font-size 1.5rem
			line-height: 1
			letter-spacing normal
			text-transform none
			display inline-flex // better vertical alignment
			justify-content center
			align-items center
			white-space nowrap
			word-wrap normal
			direction ltr
			-webkit-font-feature-settings 'liga'
			-webkit-font-smoothing antialiased
			color inherit // generally not explicity set, but should be
			visibility visible // added from 4chan x
			font-variation-settings 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24
	
	:root.fourchan-xt
		.shortcut > a,
		#thread-watcher .refresh,
		.menu-button,
		.hide-thread-button,
		.hide-reply-button,
		.show-post-button .stub-icon,
		.download-button,
		#qr-oekaki-button
		#qr-filerm,
		#url-button,
		#paste-area,
		#custom-cooldown-button,
		#dump-button,
		#split-post
			font-size 0
			&::after
				icon-style()
	
	// XXX: ICONS! by no means a perfect implementation due to the limitations
	// and the "workarounds" used in order to get icons to appear
	// XXX: end of 2023 note, this does not support 4chan XT as it removes font-awesome
	$icons,
	.fa::after,
	.menu-button::after,
	.n-pu::after,
	.contact-links::after,
	#navlinks a::after,
	.postJumper a::after,
	#index-rev::after,
	.indicator::after,
	.pagelist :is(.prev, .next) a::after,
	//.pagelist .next a::after,
	.watch-thread-link::after,
	#watched-threads > div > a::after,
	#index-search-clear::after,
	.has-submenu::after,
	.show-announcement::after,
	.report-link::after,
	.download-link::after,
	.copy-text-link::after,
	.qr-preview-spoiler::after,
	.checkbox-letter::after,
	#add-post::after,
	.gal-start::after,
	.gal-stop::after,
	.gal-close::after,
	.close::after,
	.jump::after,
	:is(.file--video, .file--gif, .file--pdf):not(.expanded-image) > .post > .file > .fileThumb::after,
	.file--sound:not(.expanded-image) > .post > .file > .fileThumb > .mobile::after
	.native-settings::after,
	.post--dubs .postNum a:nth-child(2n)::after,
	span.fileThumb::before,
	.qr-preview .remove::after,
	.summary::before,
	.ss21--board-drawer-toggle,
	.ss21--download-all,
	.page-num--icon::after,
	:root.fourchan-xt .hide-announcement-button::after,
	#qr-view::after,
	#split-post::after,
	.fxt-meta_profile + a::after,
	.fxt-stats_meta span::after
		icon-style()
	
	:root.fourchan-xt .spin::after,
	.fa-spin::after
		animation spin 2s infinite linear
	
	:root.fourchan-xt .close
		font-size 0 i
	
	// XXX: we use @css to get rid of the prefixes added by stylus
	@css {
		@keyframes spin {
			0% {
				transform: rotate(0);
			}
			100% {
				transform: rotate(1turn);
			}
		}
	}
	
	.menu-button::after // menus
		content ss21iconFont == 1 ? '\F5D3' : 'more_vert'
	.catalog-post .menu-button::after // menus in catalogue mode
		content ss21iconFont == 1 ? '\F5D4' : 'more_horiz'
	:root.fourchan-xt #watcher-link::after,
	.fa-eye::after // thread watcher
		content ss21iconFont == 1 ? '\F33E' : 'remove_red_eye'
	:root.fourchan-xt .expand-all-shortcut::after,
	.fa-expand::after // expand all images
		content ss21iconFont == 1 ? '\F3DF' : 'open_in_full'
	:root.fourchan-xt .contract-all-shortcut::after,
	.fa-compress::after // compress all images
		content ss21iconFont == 1 ? '\F3DE' : 'close_fullscreen'
	:root.fourchan-xt #shortcut-gallery > a::after,
	.fa-picture-o::after // gallery mode
		content ss21iconFont == 1 ? '\F42A' : 'photo'
	:root.fourchan-xt #shortcut-qr > a::after,
	.fa-comment-o::after // menus in catalogue mode
		content ss21iconFont == 1 ? '\F25B' : 'comment'
	:root.fourchan-xt #shortcut-index-refresh > a::after,
	:root.fourchan-xt #thread-watcher .refresh::after,
	.fa-refresh::after // refresh index
		content ss21iconFont == 1 ? '\F116' : 'refresh'
	:root.fourchan-xt .settings-link::after,
	.fa-wrench::after // 4chan x settings
		content ss21iconFont == 1 ? '\F3E2' : 'settings'
	:root.fourchan-xt #shortcut-native > a::after,
	.fa-book::after // native catalog settings
		content ss21iconFont == 1 ? '\F5B1' : 'style'
	:root.fourchan-xt .hide-thread-button::after,
	:root.fourchan-xt .hide-reply-button::after,
	:root.fourchan-xt .hide-announcement-button::after,
	.fa-minus-square::after,
	.fa-minus-square-o::after // hide post
		content ss21iconFont == 1 ? '\F27D' : 'unfold_less'
	:root.fourchan-xt .show-post-button .stub-icon::after,
	.fa-plus-square::after,
	.fa-plus-square-o::after // show post
		content ss21iconFont == 1 ? '\F283' : 'unfold_more'
	.fa-times::after,
	.close::after,
	#watched-threads > div > a:first-of-type::after,
	.gal-close::after // close
		content ss21iconFont == 1 ? '\F659' : 'close'
	:root.fourchan-xt #shortcut-prefetch > a::after,
	.fa-bolt::after // prefetch
		content ss21iconFont == 1 ? '\F46E' : 'flash_on'
	.watch-thread-link::after // watch thread
		if ss21iconFont == 1
			content '\F417'
			color ss21red
		else if ss21iconFont == 2
			font-variation-settings 'FILL' 0
			if ss21watchButtonIcon == 1
				content 'favorite'
				color ss21red
			else if ss21watchButtonIcon == 2
				content 'star'
				color ss21orange
	.watch-thread-link.watched::after // watched/unwatch thread
		if ss21iconFont == 1
			content '\F415'
		else if ss21iconFont == 2
			font-variation-settings 'FILL' 1
	#navlinks
		a:first-of-type::after // navigate up
			content ss21iconFont == 1 ? '\F286' : 'keyboard_arrow_up'
		a:last-of-type::after // navigate down
			content ss21iconFont == 1 ? '\F282' : 'keyboard_arrow_down'
	.postJumper
		.prev:first-of-type::after // jump to previous post by id
			content ss21iconFont == 1 ? '\F148' : 'arrow_upward'
		.next:last-of-type::after // jump to next post by id
			content ss21iconFont == 1 ? '\F128' : 'arrow_downward'
	#index-rev::after // reverse index order
		content ss21iconFont == 1 ? '\F127' : 'swap_vert'
	.pagelist
		.prev a::after // pagelist, previous page ($$$?)
			content ss21iconFont == 1 ? '\F12F' : 'arrow_back'
		.next a::after // pagelist, next page ($$$?)
			content ss21iconFont == 1 ? '\F138' : 'arrow_forward'
	:root.fourchan-xt #qr-oekaki-button::after,
	.fa-edit::after // oeaki mode in qr
		content ss21iconFont == 1 ? '\F4B0' : 'format_paint'
	:root.fourchan-xt #url-button::after,
	.copy-text-link::after,
	.fxt-meta_profile + a::after,
	.fa-link::after // copy
		content ss21iconFont == 1 ? '\F471' : 'link'
	#paste-area::after // paste mode in qr
		content ss21iconFont == 1 ? '\F290' : 'content_paste'
	:root.fourchan-xt #custom-cooldown-button::after,
	.fa-clock-o::after // auto poster in qr
		content ss21iconFont == 1 ? '\F597' : 'timer'
	:root.fourchan-xt #dump-button::after,
	#qr .fa-plus-square::after,
	#add-post::after // dump list in qr
		content ss21iconFont == 1 ? '\F4FC' : 'add_box'
	:root.fourchan-xt #qr-filerm::after,
	#index-search-clear::after,
	.qr-preview .remove::after,
	.fa-times-circle::after // remove/clear
		if ss21iconFont == 1
			content '\F622'
		else if ss21iconFont == 2
			content 'cancel'
			font-variation-settings 'FILL' 0
	.qr-preview-spoiler::after,
	.checkbox-letter::after // spoilers in qr
		content ss21iconFont == 1 ? '\F5F5' : 'strikethrough_s'
	.gal-start::after // play slideshow in gallery mode
		content ss21iconFont == 1 ? '\F4F4' : 'play_arrow'
	.gal-stop::after // stop slideshow in gallery mode
		content ss21iconFont == 1 ? '\F592' : 'stop'
	.has-submenu::after // add icon to menu entry
		content ss21iconFont == 1 ? '\F285' : 'keyboard_arrow_right'
	.left .has-submenu::after // add icon to menu entry
		content ss21iconFont == 1 ? '\F284' : 'keyboard_arrow_left'
	.jump::after // jumper in embedder
		content ss21iconFont == 1 ? '\F132' : 'subdirectory_arrow_right'
	.show-announcement::after // add icon to menu entry
		content ss21iconFont == 1 ? '\F483' : 'announcement'
	.report-link::after // add icon to menu entry
		content ss21iconFont == 1 ? '\F33A' : 'warning'
	.file--video:not(.expanded-image) > .post > .file > .fileThumb::after // play icon for webm thumbnails
		if ss21iconFont == 1
			content '\F4F3'
		else if ss21iconFont == 2
			content 'play_circle'
			font-variation-settings 'FILL' 0
	.file--gif:not(.expanded-image) > .post > .file > .fileThumb::after // gif icon for gif thumbnails
		if ss21iconFont == 1
			content '\F747'
		else if ss21iconFont == 2
			content 'gif_box'
			font-variation-settings 'FILL' 0
	.file--pdf:not(.expanded-image) > .post > .file > .fileThumb::after // pdf icon for pdf thumbnails
		if ss21iconFont == 1
			content '\F756'
		else if ss21iconFont == 2
			content 'picture_as_pdf'
			font-variation-settings 'FILL' 0
	.file--sound:not(.expanded-image) > .post > .file > .fileThumb > .mobile::after
		if ss21iconFont == 1
			content '\F756'
		else if ss21iconFont == 2
			content 'music_note'
	:root.fourchan-xt .download-button::after,
	.fa-download::after,
	.download-link::after // file download and add icon to menu entry
		content ss21iconFont == 1 ? '\F30A' : 'download'
	.n-pu::after // 4chan pass user
		content ss21iconFont == 1 ? '\F4DA' : 'person'
	#shortcut-werk .indicator::after // werk tyme indicator
		content ss21iconFont == 1 ? '\F1CB' : 'work'
	#shortcut-fappe .indicator::after // fappe tyme indicator
		content ss21iconFont == 1 ? '\F219' : 'burst_mode'
	.native-settings::after // native 4chan extension
		content ss21iconFont == 1 ? '\F5DB' : 'settings_applications'
	.contact-links::after // for admins and mods
		content ss21iconFont == 1 ? '\F4DB' : 'contact_support'
	.post--dubs .postNum a:nth-child(2n)::after // dubs if filtered
		content ss21iconFont == 1 ? '\F26F' : 'check'
	span.fileThumb::before,
	.dead-thread .fa-times::after,
	#watched-threads .dead-thread > a:first-of-type::after // dead thread and remove from thread watcher
		content ss21iconFont == 1 ? '\F5DD' : 'delete_forever'
	.fa-play-circle::after // https://github.com/rcc11/4chan-sounds-player support
		content ss21iconFont == 1 ? '\F4A0' : 'music_note'
	.page-num--icon::after
		content ss21iconFont == 1 ? '\F4A0' : 'draft'
	#qr-view::after
		content ss21iconFont == 1 ? '\F4A0' : 'preview'
	#split-post::after
		content ss21iconFont == 1 ? '\F528' : 'content_cut'
	.fxt-likes::after
		content ss21iconFont == 1 ? '\F415' : 'favorite'
	.fxt-reposts::after
		content ss21iconFont == 1 ? '\F813' : 'repeat'
	.fxt-replies::after
		content ss21iconFont == 1 ? '\F24E' : 'chat_bubble'
	
	.page-num--icon
		position relative
	.page-num--icon::after
		font-size .75rem
		position absolute
		top 1px
	
	if ss21iconFont == 1
		.shortcut .fa::after,
		.shortcut .menu-button::after
			font-size 1.5rem
		.watch-thread-link::after,
		.post .menu-button::after,
		.postContainer a[class$='reply-button'] .fa::after
			font-size 18px
		.ss21--board-drawer-toggle
			font-size 0
			&::after
				content '\F479'
				font-size 1.5rem
		.ss21--download-all
			font-size 0
			&::after
				content '\F1B9'
				font-size 1.5rem
	
	if ss21openThread == 1
		.is_index .summary::before
			tc(ss21primary, medium)
			font-size .875rem
			margin-right .25rem
			justify-content center
			align-items center
			transition color .25s
			content ss21iconFont == 1 ? '\F1C5' : 'open_in_new'
			/:root.ua-gecko ^[0]
				margin-top 1px
		.is_index .summary:hover::before
			tc(ss21primary, high)
		.is_index .summary-bottom
			display none i
	
	// we also sub out the default 4chan icons to material icons, albeit as svg
	// closed: lock, archive: inbox-multiple, sticky: place/pin
	// XXX: need to make it so this changes along with which icon font you pick
	default-icon-style()
		height 0
		width 1.25rem
		padding-top 1.25rem
		background-repeat no-repeat
		opacity .87
	
	.closedIcon
		if ss21iconFont == 1
			--closed-icon url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='" + hsl(ss21OppColour) + "' viewBox='0 0 16 16'%3E%3Cpath d='M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z'/%3E%3C/svg%3E")
		else if ss21iconFont == 2
			--closed-icon url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='" + hsl(ss21OppColour) + "' viewBox='0 0 20 20'%3E%3Cpath d='M5.417 18.917q-.875 0-1.459-.584-.583-.583-.583-1.458V8.708q0-.875.583-1.458.584-.583 1.459-.583v-2q0-1.938 1.343-3.282Q8.104.042 10 .042q1.917 0 3.25 1.343 1.333 1.344 1.333 3.282v2q.875 0 1.459.583.583.583.583 1.458v8.167q0 .875-.583 1.458-.584.584-1.459.584ZM10 14.625q.75 0 1.271-.531.521-.532.521-1.261 0-.75-.532-1.271-.531-.52-1.26-.52-.75 0-1.271.531-.521.531-.521 1.26 0 .75.532 1.271.531.521 1.26.521ZM7.458 6.667h5.084v-2q0-1.063-.74-1.823-.74-.761-1.802-.761t-1.802.761q-.74.76-.74 1.823Z'/%3E%3C/svg%3E")
		default-icon-style()
		//margin-left .25rem
		background-image var(--closed-icon)
	
	.stickyIcon
		if ss21iconFont == 1
			--sticky-icon url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='" + hsl(ss21OppColour) + "' viewBox='0 0 16 16'%3E%3Cpath d='M4.146.146A.5.5 0 0 1 4.5 0h7a.5.5 0 0 1 .5.5c0 .68-.342 1.174-.646 1.479-.126.125-.25.224-.354.298v4.431l.078.048c.203.127.476.314.751.555C12.36 7.775 13 8.527 13 9.5a.5.5 0 0 1-.5.5h-4v4.5c0 .276-.224 1.5-.5 1.5s-.5-1.224-.5-1.5V10h-4a.5.5 0 0 1-.5-.5c0-.973.64-1.725 1.17-2.189A6 6 0 0 1 5 6.708V2.277a3 3 0 0 1-.354-.298C4.342 1.674 4 1.179 4 .5a.5.5 0 0 1 .146-.354'/%3E%3C/svg%3E")
		else if ss21iconFont == 2
			--sticky-icon url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='" + hsl(ss21OppColour) + "' d='M16,12V4H17V2H7V4H8V12L6,14V16H11.2V22H12.8V16H18V14L16,12Z' /%3E%3C/svg%3E")
		default-icon-style()
		//margin-left .25rem
		background-image var(--sticky-icon)
	
	.archivedIcon
		if ss21iconFont == 1
			--archived-icon url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='" + hsl(ss21OppColour) + "' viewBox='0 0 16 16'%3E%3Cpath d='M12.643 15C13.979 15 15 13.845 15 12.5V5H1v7.5C1 13.845 2.021 15 3.357 15zM5.5 7h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1M.8 1a.8.8 0 0 0-.8.8V3a.8.8 0 0 0 .8.8h14.4A.8.8 0 0 0 16 3V1.8a.8.8 0 0 0-.8-.8z'/%3E%3C/svg%3E")
		else if ss21iconFont == 2
			--archived-icon url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='" + hsl(ss21OppColour) + "' d='M19,8V5H5V8H9A3,3 0 0,0 12,11A3,3 0 0,0 15,8H19M19,3A2,2 0 0,1 21,5V12A2,2 0 0,1 19,14H5A2,2 0 0,1 3,12V5A2,2 0 0,1 5,3H19M3,15H9A3,3 0 0,0 12,18A3,3 0 0,0 15,15H21V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V15Z' /%3E%3C/svg%3E")
		default-icon-style()
		margin-left .25rem
		background-image var(--archived-icon)
	
	.identityIcon
		default-icon-style()
	
	// XXX: on "retina" (`window.devicePixelRatio >= 2`) displays, 4chan x switches
	// to the @2x version of certain icons. until we switch the identityIcon to an
	// svg, force the icon to still render at the correct size
	.retina
		height 1.25rem
		width 1.25rem
	
	// 4CHANX: while shortcut icons are encouraged, if for some odd reason you
	// choose not to use them, still provide support
	:root.shortcut-icons
		#shortcuts .fa,
		.native-settings
			font-size 0
			visibility hidden
		
	:root:not(.shortcut-icons) #shortcuts .fa::after,
	:root:not(.shortcut-icons) .native-settings::after
		display none
	
	:root:not(.shortcut-icons) #shortcuts
		grid-template-columns 1fr repeat(6, min-content)
		.shortcut a
			font-size inherit
			white-space nowrap
			&::after
				display none
	/*
	:root.fourchan-xt:not(.shortcut-icons) #shortcuts
		.shortcut a
			font-size inherit
			white-space nowrap
			&::after
				display none
	*/
	// 4chan xt 2.7.0
	:root.fourchan-xt.shortcut-icons #shortcuts .icon--alt-text,
	:root.fourchan-xt:not(.shortcut-icons) .shortcut::after
		display none
	
	// generic classes used throughout 4chan and 4chan x
	// quoted text, a.k.a. >implying implications in current year, ishygddt
	:where(.quote)
		if ss21quoteColour
			color #789922
		else
			color ss21green
	
	// on /gd/'s pinned thread, quotes are hardcoded colour
	:where([style*="color:#789922"])
		if ss21quoteColour
			color #789922 i
		else
			color ss21green i
	
	// make warning text visually different
	.warning
		color ss21red
	
	// ($$$) add another potentially expensive override to inline-styled
	// elements to ensure they use our red, not `red` red
	[color="red"],
	[style*="color:red"],
	[style*="color: red"],
	[style*="color:#ff0000"],
	[style*="color:#FF0000"]
		color ss21red i
	
	:where(.hand)
		cursor pointer
	
	.move
		cursor grab
		overflow hidden
		&:active
			cursor grabbing
	
	// poster unique ids (/bant/, /biz/, /pol/, /qst/, /soc/)
	.posteruid
		font-size 0
		display inline-block
		.hand
			font-size .75rem
	
	// if enabled, poster unique id's are painted different colours to easily
	// identify posters
	.painted
		position relative
		padding .0625rem .25rem .125rem
		borderRadius()
		&::after
			content ''
			display block
			position absolute
			top 0
			left 0
			width 100%
			height 100%
			borderRadius()
			background-color rgba(0 0 0 .1)
			opacity 0
			transition opacity .25s
			pointer-events none
		&:hover::after
			opacity 1
	
	// 4CHANX: anti-autoplay
	// rarely happens, so this is just taken straight from 4chan x
	audio.controls-added
		display block
		margin auto
	:root.anti-autoplay
		div.embed
			position static
			width auto
			height auto
			text-align center
		.autoplay-removed
			visibility visible i
			min-width 640px
			min-height 360px
			margin auto // centers the media (usually an iframe) when shown
	
	// 4chan x header
	// offset the header and body when it's fixed
	// XXX: this first one might not be needed because we have the header transparent
	// until a certain scroll threshold
	
	//:root.fixed.top-header body
	//	padding-top 3rem
	
	//:root.fixed.bottom-header body
	//	padding-bottom 3rem
	
	#header-bar
		right 0
		left 0
		z-index 8
		background-color ss21primary
		tc(@background-color, high)
		if ss21opacityHeader
			background-color alpha(@background-color, .5)
			backdrop-filter blur(1rem)
		z-depth(4)
		position relative
		padding 0 1rem
		display flex
		align-items center
		justify-content space-between
		flex-wrap wrap
		//will-change background-color, transform
		transition background-color .25s, transform .25s
	:root.fixed #header-bar
		position fixed
	:root.top-header #header-bar
		top 0
	:root.bottom-header #header-bar
		bottom 0
	// 4CHANX: if enabled, center the board links in the header
	:root.centered-links #board-list,
	:root.centered-links #header-bar .boardList
		justify-content center
	// autohide the header when not hovered
	:root.fixed.top-header #header-bar.autohide:not(:hover)
		margin-bottom -1rem
		transform translateY(-100%)
	:root.fixed.bottom-header #header-bar.autohide:not(:hover)
		transform translateY(100%)
	// when viewing the full board list, hide all the [, ], and /'s that are
	// used as dividers
	#full-board-list .boardList span
		display none
	
	// XXX: most of these styles are applied to #board-list because we want
	// shortcuts to always stay to the right
	/*
	#board-list
		display flex
		flex 1
		width 100%
		overflow auto hidden
		white-space nowrap // forces a scrollbar for long board lists
		a
			padding .25rem
	#board-list
		padding .5rem
	*/
	// XXX: i am sure this can go...
	/*
	#board-list,
	#custom-board-list,
	#full-board-list,
	#full-board-list .boardList
		display flex
		align-items center
	*/
	// SIDEDISH: button to toggle the off canvas menu
	.ss21--board-drawer-toggle
		display inline-flex
		align-items center
		justify-content center
		order -1
		cursor pointer
		min-width 3rem
		opacity .6
		will-change opacity
		transition opacity .25s
		&:hover
			opacity .87
	
	// 4CHANX: container for the board list, custom or not
	#board-list
		display flex
		flex 1
		width 100%
		user-select none
		margin-right .5rem
		//margin-bottom -1rem
		//padding -.5rem 0
		//margin -.75rem 0
		overflow auto hidden
		white-space nowrap
		scrollbar-width thin
		a
			//text-transform lowercase
			display inline-flex
			align-items center
			justify-content center
			//position relative
			height 3rem
			min-width 1.5rem
			padding 0 .5rem
			transition opacity .25s
			/*
			if ss21headerHeight == 1
				height 3rem
			else if ss21headerHeight == 2
				height 2rem
				*/
			&:not(.current)
				opacity .7
				&:hover
					opacity .85
		.current
			box-shadow inset 0 -.125rem 0 invert(ss21primary)
			opacity 1
	
	#custom-board-list
		display flex
		align-items center
	
	if ss21compressBoards == 1
		#full-board-list a
			font-size .875rem
			min-width auto
			padding 0
			padding-right .125rem
		#header-bar:has(#full-board-list:not([hidden])) .ss21--board-drawer-toggle
			display none
	
	// XXX: btw this makes notifications transparent too, silly
	if ss21floatingHeader == 1
		:root.fixed.top-header #header-bar
			top 1rem
			left 1rem
			right 1rem
			border-radius 64px
			background-color alpha(ss21primary, .25) i
			opacity .7 i
			&:hover
				opacity .9 i
		//#scroll-progress
		//	width 90vw i
		//	left 5vw i
	/*
			&::after
				display none
				position absolute
				bottom 0
				left 0
				width 100%
				height 2px
				content ''
				pointer-events none
				background-color invert(ss21primary)
			&:hover::after,
			&.current::after
				display block*/
	/*
	if ss21headerHeight == 2
		#board-list a
			font-size .75rem
			min-width 2rem
		.ss21--board-drawer-toggle,
		.ss21--download-all,
		.shortcut .fa::after,
		.shortcut .menu-button::after
			font-size 18px // XXX: it's insane how bad this looks lmao
	*/
	// 4CHANX: in the event there are no shortcuts (not sure when this is),
	// hide the whole element
	#shortcuts:empty
		display none
	
	// 4CHANX: at some point, 4chan x may add `.autohiding-scrollbar`, so if this
	// affects you, we support you
	// XXX2024: sike, not anymore
	/*
	:root.autohiding-scrollbar #shortcuts
		margin-right 2rem
	*/
	#shortcuts
		display grid
		//grid-template-columns 1fr repeat(6, 2rem)
		//grid-template-columns 1fr repeat(auto-fill, 2rem)
		grid-auto-rows 1fr
		grid-auto-flow column
	
	.shortcut
		grid-row span 2
	
	#shortcut-updater
		font-size .8rem
		justify-content flex-end
		grid-column 1
		grid-row 1
		padding 0
		margin-right .25rem
	
	#shortcut-stats
		font-size .8rem
		justify-content flex-end
		grid-column 1
		grid-row 2
		padding 0
		margin-right .25rem
	
	@css {
		#shortcuts:not(:has(#shortcut-stats)) #shortcut-updater {
			grid-row: span 2;
		}
		#shortcuts:not(:has(#shortcut-updater)) #shortcut-stats {
			grid-row: span 2;
		}
	}
	
	// XXX: 2023-03: changed to grid just to have stats/updater on new lines
	/*
	#shortcuts
		display flex
		align-items center
	*/
	// XXX: make the board list overflow hide behind a gradient
	/*
	&::before
		content ''
		position absolute
		background-image linear-gradient(to right, rgba(0, 0, 0, 0), rgba(ss21primary, .8))
		pointer-events none
		height 100%
		width 1.5rem
		right 100%
	*/
	
	.shortcut
		display inline-flex
		align-items center
		justify-content center
		padding .25rem
		& > a,
		.menu-button
			tc(ss21primary, medium)
			transition color .25s
		& > a:hover,
		.menu-button:hover,
		.menu-button.active,
		.fa-bolt:not(.disabled),
		#watcher-link:not(.disabled),
		.fa-comment-o:not(.disabled)
			tc(ss21primary, high)
	
	:root.fourchan-xt #shortcut-qr a:not(.disabled)::after,
	:root.fourchan-xt #shortcut-prefetch a:not(.disabled)::after
		tc(ss21primary, high)
	
		/*
		.fa::after,
		.menu-button::after,
		.native-settings::after
			tc(ss21primary, medium)
			transition color .25s
		.fa:hover::after,
		.menu-button.active::after,
		.menu-button:hover::after,
		.fa-bolt:not(.disabled)::after,
		#watcher-link:not(.disabled)::after,
		.fa-comment-o:not(.disabled)::after
			tc(ss21primary, high)
		& > .menu-button
			display inline-flex
	*/
	
	// 4CHANX: only show fappe/werk indicators when they're active
	:root:not(.fappeTyme) #shortcut-fappe,
	:root:not(.werkTyme) #shortcut-werk
		display none
	
	// 4CHANX: `#scroll-marker` is used to determine unread post position, amongst
	// other things
	#scroll-marker
		position absolute
		display none
		height 1rem
		right 0
		left 0
	
	#header-bar:not(.autohide) #scroll-marker
		pointer-events none
	
	:root.fixed #scroll-marker
		display block
	
	:root.fixed.top-header #scroll-marker
		top 100%
	
	:root.fixed.bottom-header #scroll-marker
		bottom 100%
	
	#scroll-progress
		--bar-colour ss21green
	
	@css {
		:root {
			scroll-timeline: --page-scroll-progress block, --page-text-shadow block, --page-parallax block;
		}
		/*
		#scroll-progress {
			position: absolute;
			top: 100%;
			left: 0;
			width: 100%;
			height: .25rem;
			background-color: var(--bar-colour);
			transform-origin: 0 50%;
			animation: grow-progress auto linear;
			animation-timeline: --page-scroll-progress;
		}
		@keyframes grow-progress {
			from {
				transform: scaleX(0);
			}
			to {
				transform: scaleX(1);
			}
		}*/
		@property --scroll-progress {
			syntax: "<percentage>";
			initial-value: 0%;
			inherits: false;
		}
		#scroll-progress {
			position: absolute;
			top: 100%;
			left: 0;
			width: 100%;
			height: .25rem;
			background-image: linear-gradient(to right, var(--bar-colour) var(--scroll-progress), var(--grey-500) var(--scroll-progress));
			animation: grow-progress auto linear;
			animation-timeline: --page-scroll-progress;
		}
		@keyframes grow-progress {
			from {
				--scroll-progress: 0%;
			}
			to {
				--scroll-progress: 100%;
			}
		}
		.boardTitle {
			animation: shadow-shift auto linear;
			animation-timeline: --page-text-shadow;
			animation-range: 0 23vh;
		}
		@keyframes shadow-shift {
			from {
				text-shadow: 1rem 1rem 0 var(--primary-500);
			}
			to {
				text-shadow: 0 0 0 var(--primary-500);
			}
		}
		/*
		.boardBanner {
			animation: parallax-shift auto linear;
			animation-timeline: --page-parallax;
			animation-range: 0 23vh;
		}
		@keyframes parallax-shift {
			from {
				transform: translate3d(0, 0, 0);
			}
			to {
				transform: translate3d(0, 50px, 0);
			}
		}*/
	}
	
	// SIDEDISH: we add a scrolling progress indicator
	// XXX: this only works if `#header-bar` is set to fixed
	/*
	#scroll-progress
		appearance none
		border 0
		position absolute
		top 100%
		left 0
		width 100%
		height .25rem
		opacity 0
		background-color var(--grey-500)
		//will-change opacity
		transition opacity .25s
		pointer-events none
		&::-webkit-progress-bar
			background-color var(--grey-500)
		&::-webkit-progress-value
			background-color ss21green
		&::-moz-progress-bar
			background-color ss21green
	
	:root.bottom-header #scroll-progress
		top auto
		bottom 100%
	
	#header-bar.scrolled #scroll-progress
		opacity 1
	*/
	@media (max-width: 66rem)
		#header-bar
			padding 0 .5rem
		.ss21--board-drawer-toggle
			min-width 1.5rem
		#board-list a
			font-size .875rem
			min-width 1.5rem
		.shortcut
			min-width 1.5rem
			padding 0 .25rem
	
	@css {
		.ss21--moved-select {
			display: none;
		}
		#header-bar {
			container: header / inline-size;
		}
		#board-list {
			container: boardlist / inline-size;
		}
		@container header (width < 60rem) {
			.ss21--board-drawer-toggle {
				display: none;
			}
			#board-list {
				/*background: red;*/
			}
			#shortcuts {
				/*background: blue;*/
			}
		}
		@container boardlist (width < 25rem) {
			#custom-board-list,
			#full-board-list {
				display: none;
			}
			.ss21--moved-select {
				display: block;
				field-sizing: content;
				margin-block: .25rem;
			}
		}
	}
	
	// notifications
	// styled half-way between an alert and a snackbar
	/*
	4CHANX: here's the js to make a notification:
	document.dispatchEvent(new CustomEvent('CreateNotification', {
	detail: {
	type: 'success', // info, warning, error
	content: 'TEXT HERE',
	lifetime: 0
	}
	}));
	*/
	
	#notifications
		position fixed
		inset 0
		&:empty
			display none
	
	// this adjusts the notifications' y position when the header is hidden
	:root.fixed.top-header:not(.gallery-open) #notifications,
	:root.fixed.top-header #header-bar.autohide #notifications
		position absolute
		top 100%
	
	.notification
		display flex
		align-items center
		justify-content center
		padding .75rem .5rem .75rem .75rem
		borderRadius()
		margin .5rem auto
		width 50rem
		max-width 100%
		z-depth(6)
		will-change opacity
		transition opacity .25s
		&.error
			background-color alpha(ss21red, .9) 
			tc(@background-color, high)
		&.info
			background-color alpha(ss21blue, .9)
			tc(@background-color, high)
		&.success
			background-color alpha(ss21green, .9)
			tc(@background-color, high)
		&.warning
			background-color alpha(ss21orange, .9)
			tc(@background-color, high)
		.message
			order -1
			flex-grow 1
			max-height 10rem
			white-space pre-line
			overflow auto
			a
				text-decoration solid underline
				text-decoration-skip ink
		.close
			display inline-flex
			align-items center
			margin-left .5rem
			opacity .6
			//will-change opacity
			transition opacity .25s
			&:hover
				opacity .87
	
	// in the event of multiple 4chan x instances running
	:root.tainted .report-error
		display none
	
	if ss21nonPrimaryHeader
		#header-bar
			color var(--text-primary-on-background)
			background-color var(--background-primary)
		#updater,
		#thread-stats span,
		#shortcuts a,
		#shortcuts span
			color var(--text-primary-on-background) i
	
	// if enabled, show the board title as a customisable hero image
	if ss21boardBanner
		.boardBanner
			color rgba(255, 255, 255, .87)
			position relative
			display flex // XXX: was inline-flex, but left like a 8px margin between the bottom and next item
			flex-direction column
			align-items center
			justify-content center
			text-align center
			height 330px
			width 100%
			//z-index -1
			background-image linear-gradient(45deg, #8c696f, #014c82)
			background-size 400% 400%
			overflow hidden
			user-select none
			contain layout
			transform translate3d(0, 0, 0)
			//will-change transform
			//box-shadow inset 0 0 0px 20px red
			animation gradientShift 10s ease infinite
			&::after
				content ''
				display block
				//background red
				//background-image linear-gradient(to bottom, rgba(ss21BackgroundColour, 0), 80%, rgba(ss21BackgroundColour, 1))
				//box-shadow inset 0 0 50px 0 blue
				position absolute
				height calc(100% + 2rem)
				width calc(100% + 2rem)
				top -1rem
				left -1rem
				background-size cover
				background-repeat no-repeat
				background-position 50% 50%
				box-shadow inset 0 0 10rem 2rem #000
				filter blur(2px) saturate(.75)
				z-index -1
				pointer-events none
		@css {
			@keyframes gradientShift {
				0% {
					background-position: 84% 0%;
					}
				50% {
					background-position: 17% 100%;
					}
				100% {
					background-position: 84% 0%;
				}
			}
		}
		
		.ss21--op-banner
			position absolute
			height 100%
			width 100%
			filter blur(3px) saturate(.75)
			z-index 0
			object-fit cover
			transform scale(1.075)
			transform-origin 50% 50%
			pointer-events none
		
		.boardTitle
			font-size calc(100% + 5vw)
			color ss21BackgroundColour
			line-height 1
			text-transform lowercase
			--primary-500 ss21primary
			text-shadow 1rem 1rem 0 var(--primary-500)
			//will-change text-shadow
			transition text-shadow .1s
			z-index 1
		
		// support for custom board titles in 4chan x, making it visually obvious they can be edited
		.boardTitle,
		.boardSubtitle
			white-space pre-line
			&[title]
				cursor help
			&[contenteditable="true"]
				cursor text
				border-bottom 1px dashed
		
		// since you ignored our request to block title cards, here's your support.
		// don't get upset if it doesn't work well
		#bannerCnt
			position absolute
			top 0
			left 0
			height 100%
			width 100%
			> img
				height 100%
				width 100%
				z-index 0
				object-fit cover
				filter blur(3px) saturate(.5)
	else
		body
			padding-top 3rem
		.boardBanner
			display none
		.navLinks.json-index
			margin 1rem auto i
	
	// XXX: 2023 hotness, scroll-driven animations, all in css with no js
	/*
	.boardTitle
		animation txtShadow linear forwards
		animation-timeline scroll()
		animation-range 0vh 33vh
	
	@keyframes txtShadow
		from
			text-shadow 1rem 1rem 0 var(--primary)
		to
			text-shadow 0 0 0 var(--primary)
	*/
	// SIDEDISH: check if the board banner was actually blocked
	:root.ss21--banner-blocked #bannerCnt
		display none
	
	// announcement hiding
	.globalMessage
		display none
	
	@css {
		@scope (.globalMessage) {
			* {
				margin: 0;
			}
			br {
				display: none;
			}
			a:not(.hide-announcement-button) {
				color: var(--primary);
			}
		}
	}
	:root.fourchan-xt .hide-announcement-button
		font-size 0
	
	// XXX: for some reason the announcements was showing during page load
	// ideally the icon should just be a dismiss label button
	// and since the announcement is always inconsistent with h* and links,
	// it's difficult to style this consistently and per material spec
	// XXX: FIX FOR UNDER 75REM
	
	//:where(:root.ss21--banner-blocked) .globalMessage:not([hidden])
	// 2024XXX: this will always look bad because of the inconsistent elements placed
	// inside the announcement, and that the elements arent wrapped in anything
	:root.fourchan-x .globalMessage:not([hidden])
		background-color ss21BackgroundElevated
		position fixed
		top 3rem
		width 100%
		padding 1rem 1.5rem
		display grid
		grid-template-columns 1fr auto 1fr
		z-depth(6)
		z-index 2
		text-align center
		transition top .25s
		&::before,
		&::after
			content ''
			display block
		&::before
			grid-column 1
		&::after
			grid-column 3
		:where(*):not(.hide-announcement-button)
			grid-column 2
			justify-self center
			color ss21red
		.hide-announcement-button
			position absolute
			display block
			opacity .55
			height 1.5rem
			top calc(50% - .75rem)
			grid-column 1
			transition opacity .25s
			&:hover
				opacity .84
	
	:root.top-header
		#header-bar:not(.autohide):not(.scrolled) ~ .globalMessage
			top calc(var(--headerBar-height) + .25rem)
		#header-bar.autohide ~ .globalMessage
			top 0
		#header-bar.scrolled ~ .globalMessage
			top .25rem
		#header-bar.scrolled:not(.autohide) ~ .globalMessage
			top 3.5rem
		//#header-bar.autohide.scrolled ~ .globalMessage
		//	top .5rem
	:root.bottom-header,
	:root.top-header:not(.fixed) #header-bar.scrolled ~ 
		.globalMessage
			top 0
	
	// when announcement is shown, don't have it cover the boardBanner
	:root.top-header:has(#globalMessage:not([hidden])) body
		padding-top 7.5rem
	
	// blotter support - one day it'd be nice if 4chan x could hide this in a
	// similar fashion to announcement hiding, where it only shows when its
	// content changes
	if ss21blotter == 1
		#blotter
			display table i
			min-width 40rem
			max-width 100%
			margin 1rem auto 2.5rem // need to account for boardBanner being present or not, plus header-bar/autohide
			borderRadius()
			background-color ss21BackgroundElevated
			overflow hidden
			position relative
			tr:not(:only-child)
				if ss21readingMode == ss21light
					border-bottom 1px solid darken(ss21BackgroundElevated, 10%)
				else if ss21readingMode == ss21dark
					border-bottom 1px solid lighten(ss21BackgroundElevated, 15%)
			td
				padding .5rem 1rem
			thead
				background-color ss21primary
				color tc(ss21primary, high)
				td::before
					content '4chan blotter (barely updated, best kept hidden within ss21)'
			#blotter-msgs
				.blotter-date
					color var(--text-hint-on-background)
				.blotter-content a
					color ss21primary
			tfoot
				text-align right
				a
					color ss21primary
					transition color .25s
					&:hover
						color shade(ss21primary, 10%)
		.is_thread #blotter
			margin-bottom 1rem
	
	// XXX: if you unblock and want to see contest banners, you need to enable
	// this setting within ss21
	if ss21allowContest == 1
		.middlead
			display block i
			a
				display block
				width 468px
				height 60px
				margin 1rem auto 0
	
	// XXX: Thread closed. You may not reply at this time.
	// Option 1 is the usual banner style (only at the top of the page)
	// Option 2 is a non-dismisable toast
	if ss21noReplyAllowed == 0
		.closed
			font-size 2rem
			font-weight 700
			text-align center
			background-color ss21red
			position relative
	else if ss21noReplyAllowed == 1
		.closed
			position fixed
			z-index 3
			background-color alpha(ss21red, .69)
			inset auto auto 1rem 50%
			transform translateX(-50%)
			inline-size calc(100% - 1rem)
			max-inline-size 80rem
			padding 1rem
			borderRadius()
	
	// index sorting and what not. only enabled with json mode in 4chan x
	// first up, only some elements are shown, depending on which mode is enabled
	.indexlink, // hide the link to the original index
	.cataloglink, // hide the link to the original catalogue
	.archlistlink, // hide the link to the original archive
	.bottomlink, // hide the link that navigates to the bottom of the page
	:root:not(.paged-mode) .pagelist, // hide the page list except for when in paged mode
	:root:not(.catalog-mode) #hidden-label, // hide the hidden threads viewer except for when in catalogue mode
	:root:not(.catalog-mode) #index-size, // hide the thumbnail size option except for when in catalogue mode
	#index-search:not([data-searching]) + #index-search-clear // unless searching the index, hide the 'clear search' icon
		display none
	
	.navLinks.json-index
		background-color ss21primary
		tc(@background-color, high)
		//width 100%
		max-width 75rem
		padding .25rem 1.5rem
		margin -1.5rem auto 1.5rem
		position relative
		z-index 1
		display flex
		flex-wrap wrap
		align-items center
		justify-content center
		gap .25rem
		borderRadius()
		select
			background-color ss21BackgroundElevated
			tc(@background-color, high)
			field-sizing content
	
	@media (max-width: 77rem)
		.navLinks.json-index
			font-size .875rem
			margin -1.5rem 1rem 1.5rem
			max-width none
		#index-last-refresh,
		#hidden-label
			font-size .875rem
			min-width 0
			white-space nowrap
			overflow hidden
			text-overflow ellipsis
		#index-size
			max-width 12ch
		#index-search
			max-width 7rem
	
	#index-search
		background-color ss21BackgroundElevated
		tc(@background-color, high)
		padding-right 1rem
	
	#hidden-label
		tc(ss21primary, medium)
	
	#index-rev
		all unset
		visibility hidden
		display inline-flex
		align-items center
		&::after
			tc(ss21primary, medium)
			visibility visible
			cursor pointer
			transition color .25s
		&:hover::after
			tc(ss21primary, high)
		&:checked::after
			color var(--secondary)
	
	#index-options
		display inline-flex
		align-items center
		gap .25rem
	/*
	@css {
		.navLinks.json-index {
			container: indexoptions / inline-size;
		}
		@container indexoptions (inline-size < 1200px) {
			#index-search {
				max-width: 5rem;
			}
			#index-size {
				width: 10ch;
			}
		}
	}
	*/
	#lastlong-options
		display inline-flex
		flex-direction column
		& > input
			font-family var(--font-monospace)
			text-align center
			background none
			height 50%
			width 2.25rem
			padding 0
			border 0
			margin 1px 0
	
	// replace the original clear search 'x' with an icon
	// XXX: `:focus` is off
	#index-search-clear
		font-size 0
		width 0
		&::after
			position relative
			color ss21red
			left -2rem
			opacity .54
			transition opacity .25s
		&:hover::after
			opacity .87
	
	/* 2025 style? */
	#index-search
		padding-left 32px
		padding-right 32px
		background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' height='20px' viewBox='0 -960 960 960' width='20px' fill='" + alpha(hsl(ss21OppColour), .54) + "'%3E%3Cpath d='M381.03-314Q271-314 194-391t-77-187q0-110 77-187t187-77q110 0 187 77t77 187.03q0 41.39-11 79.18Q623-461 601-429l208 208q15 15 15 34t-15 34q-15 15-34.5 15T740-153L533-359q-30 21-70.29 33-40.29 12-81.68 12Zm-.03-98q70 0 118-48t48-118q0-70-48-118t-118-48q-70 0-118 48t-48 118q0 70 48 118t118 48Z'/%3E%3C/svg%3E")
		background-repeat no-repeat
		background-size 1.25rem auto
		background-position center left 8px
		border-radius 90px
		width 8rem
		transition width .25s
		&:focus
			width 15rem
	#index-search-clear::after
		font-size 20px
		font-variation-settings 'FILL' 0, 'wght' 400, 'GRAD' 200, 'opsz' 20
	
	// since `a` has `color: inherit`, a lot of the linked elements within
	// posts need to be recoloured
	// XXX: can still sometimes be too/under specific
	.postNum a:not(.replylink),
	.postMessage > a,
	.container > a
	/*
	.quotelink,
	.backlink,
	.embedder,
	.hashlink*/
		color ss21primary
		&:hover
			color shade(ss21primary, 15%)
	/*
	@css {
		@scope (.postNum) {
			a:first-child {
				font-size: 0;
			}
			a:first-child::after {
				content: '#';
				font-size: var(--post-info-fs, 0.75rem);
			}
			a {
				color: red;
			}
			a:hover {
				color: maroon;
			}
		}
	}
	*/
	// support for [sjis] on /jp/
	// pretty much straight copied because it needs to be a specific size
	/*
	<blockquote class="postMessage"><span class="sjis">　　　　　　　　　　　　　／￣￣￣￣￣￣￣￣<br>　　　　 　∧＿∧ 　 ＜　 wrong message...<br>　　　　　（　´_ゝ`）　　　＼＿＿＿＿＿＿＿＿<br>　　　　／　　　　 ＼<br>　　　/ /＼　　　/￣＼<br>　＿|￣￣ ＼　/　 ヽ　＼_<br>　＼￣￣￣￣￣￣ ＼＿_）、<br>　　||＼　　　　　　　　　　　　＼<br>　　||＼||￣￣￣￣￣￣￣||￣<br>　　||　 ||￣￣￣￣￣￣￣||<br>　　 　 .||　　　　　　　　　　.||<br></span></blockquote> */
	.sjis
		font 16px/1 "IPAMonaPGothic", "Mona", "MS PGothic", monospace
		white-space pre
		overflow auto
		display block
		clear left
	
	// support for [math] on /sci/
	// allows for overflow scroll when posts arent wide enough
	// creates a span.MathJax within .postMessage
	// e.g.: [math]\lim_{(x,y) \to (0,0)} \frac{\left| \frac{x^2y}{\sqrt{|xy|}}-0-\begin{pmatrix} 0 & 0 \end{pmatrix} \begin{pmatrix} x-0 \\ y-0 \end{pmatrix} \right|}{\| (x,y) \| }   = \lim_{(x,y) \to (0,0)} \frac{\left| \frac{x^2y}{\sqrt{|xy|}} \right|}{ \sqrt{x^2+y^2} }   = \lim_{(x,y) \to (0,0)} \frac{x^2\left|y\right|}{\sqrt{|xy|(x^2+y^2)}}   = \lim_{r \to 0^+} \frac{r^2\cos^2(\theta)\left|r\sin(\theta)\right|}{\sqrt{|r^2\cos(\theta)\sin(\theta)| \cdot r^2}}   = \lim_{r \to 0^+} \left|r\right| \frac{\cos ^2\left(\theta\right)\sqrt{\left|\sin \left(\theta\right)\right|}}{\sqrt{\left|\cos \left(\theta\right)\right|}}=0[/math]
	// [math]\dfrac{s^n\cdot\binom{n(s-1)}{r-n}}{\binom{ns}r}[/math]
	.post:has(.MathJax)
		overflow-x auto
	
	// a very crude and simple sidebar, for those that can't let go of oneechan
	if ss21sidebar != 0
		body
			if ss21sidebar == 1
				padding-right 25rem
			if ss21sidebar == 2
				padding-left 25rem
		/*
		.boardBanner
			position fixed
			width 25rem
			top 0
			right 0
			transform none i
			.boardTitle
				font-size 2rem
		.navLinks.json-index
			margin 4.5rem auto 1.5rem
		*/
		#id_css
			position fixed
			pointer-events none
			z-index -1
			bottom 0
			right 0
			display block
			opacity .45
			width 25rem
			height 25rem
			background-repeat no-repeat
			background-position 100% 100%
	
	.board
		padding 0 1rem
		if ss21boardCenter
			margin 1rem auto
			max-width 75rem
		else
			margin 1rem 0
		transition margin .25s
	
	.thread
		position relative
		padding 0 1rem
		margin-bottom 1rem // this collapses anyway
	
	.board .thread:last-of-type
		margin-bottom 0
	
	@media (max-width: 77rem)
		.thread
			padding 0
	
	// XXX: if there are no search results from index
	:root.ss21--index-searching .board:empty::after
		content 'no results; try another search term'
		color var(--text-secondary-on-background)
		display flex
		justify-content center
		align-items center
		min-height 10rem
		if ss21threeWide
			grid-column span 3
	
	if ss21threeWide
		@media (min-width: 75rem)
			:root.paged-mode .is_index .board
				max-width none
				display grid
				grid-gap 0
				grid-template-columns repeat(3, 1fr)
	
	.postContainer
		position relative
		margin-bottom 1rem
		if ss21postWidth
			max-width 100%
		else
			display table
	
	.thread .postContainer:last-of-type
		margin-bottom 0
	
	.post
		display flow-root
		background-color var(--background-primary)
		//padding .75rem 1rem
		borderRadius()
		max-width 100%
		transition background-color .25s
	
	if ss21flatness == 2
		.post,
		.catalog-post,
		.summary,
		.stub,
		#menu,
		.submenu
			if ss21readingMode == ss21light
				border 1px solid darken(ss21BackgroundElevated, 10%)
			else if ss21readingMode == ss21dark
				border 1px solid lighten(ss21BackgroundElevated, 15%)
	
	// XXX: when fappe tyme enabled, this won't work due to the elements retaining
	// their odd or even-ness in the dom tree
	// XXX: this should be odd not even, duh
	if ss21evenPosts
		.postContainer:nth-of-type(even) > .post
			if ss21readingMode == ss21light
				background-color darken(ss21BackgroundElevated, 3%)
			else if ss21readingMode == ss21dark
				background-color lighten(ss21BackgroundElevated, 5%)
	
	// XXX: USE GAP FOR ALL THE POST INFO ELEMENTS
	:where(.postContainer) > :where(.post) > .postInfo
		if ss21readingMode == ss21light
			background-color rgba(33, 33, 33, .02)
		else if ss21readingMode == ss21dark
			background-color rgba(255, 255, 255, .05)
		display flex
		flex-flow row wrap
		align-items center
		//flex-wrap nowrap // XXX: not ideal, especially on boards like /pol/
		//padding .125rem 4rem .25rem 1rem
		padding .125rem 4rem .125rem .5rem
		// XXX: provides space for menu/hide button on long post infos
		//height 1.75rem XXX: 2021-12 the cut off subjects always bothered me
		gap 0 .25rem
		borderRadius()
		border-bottom-left-radius 0
		border-bottom-right-radius 0
	
	.noFile > .post > .postInfo
		if ss21readingMode == ss21light
			box-shadow 0 1px 0 0 darken(ss21BackgroundElevated, 10%)
		else if ss21readingMode == ss21dark
			box-shadow 0 1px 0 0 lighten(ss21BackgroundElevated, 15%)
	
	.subject
		min-inline-size 0
		max-inline-size 25ch
		text-overflow ellipsis
		white-space nowrap
		overflow hidden
		&:hover
			white-space initial
		&:empty
			display none
	
	.nameBlock
		//margin-right .25rem
		display inline-flex
		align-items center
		gap 0 .25rem
	
	if ss21forcedAnon == 1
		.nameBlock
			display none
		.subject:not(:empty)::after
			display none i
	
	if ss21onlyNames == 1
		.postContainer:not(.poster--named)
			.nameBlock,
			.subject:not(:empty)::after
				display none i
	
	// if a post from a new ip is added to a thread, 4chan x makes a guess that
	// the recent posts are of that new ip and adds an indicator
	// XXX: make this consistent
	.ip-counter
		color var(--text-hint-on-background)
	
	.dateTime
		color var(--text-hint-on-background)
	
	.page-num
		color var(--text-hint-on-background)
		margin-left .25rem
	
	.postNum
		display inline-flex
		align-items center
	
	// coverts the "No.6900" into "#6900", where the '#' functions the same as the 'No.'
	.postNum
		& > a:first-child
			font-size 0
			&::after
				content '#'
				font-size var(--post-info-fs, .75rem)
		& > span:last-child
			font-size 0
	
	.postMessage
		padding .5rem .75rem // XXX: was `.75rem 1.5rem`
		&:empty
			display none
	
	// make subjects look nice by adding 'by'
	.subject:not(:empty)::after
		content ' by'
		color var(--text-hint-on-background)
		font-weight 400
		//margin 0 .25rem
	
	// XXX: thread summaries are targeted in sidedish to make the numbers wrapped in bold
	.summary
		display block
		text-align center
		background-color var(--background-primary)
		line-height 3
		padding 0 .5rem
		margin-top 1px
		z-index 1
		position relative
		borderRadius()
		&:focus
			box-shadow 0 0 0 .25rem alpha(lighten(ss21primary, 50%), .25)
	
	// XXX: when a thread is expanded on index, maintain our usual margins
	.is_index .summary + .postContainer,
	.summary-bottom
		margin-top 1rem
	
	.is_thread .summary
		margin-bottom 1rem
		&::before
			display none
	
	if ss21postWidth == 0
		.summary
			display inline-block
			padding 0 1rem
	
	if ss21openThread == 1
		// get rid if [View] / [Reply]
		.postNum > span:last-child
			display none
		// give the FAB a bit more breathing room
		.thread
			margin-bottom 1.5rem
		// turn it into a FAB
		.is_index .summary:not(.preview-summary)
			//all unset
			margin-top 0
			border 0
			tc(ss21primary, high)
			display flex
			align-items center
			background-color ss21primary
			font-size 0
			border-radius 1.5rem
			height 1.5rem
			padding 0 .75rem
			position absolute
			top -.75rem
			right 6rem
			z-index 2
			transition background-color .25s
			z-depth(2)
			&:hover
				background-color lighten(ss21primary, 5%)
			b
				font-size .875rem
				font-weight 400
				&:last-child:not(:only-child)::before
					content ' / '
					tc(ss21primary, low)
					margin-left .25rem
	
	// XXX: 4chan xt generates summaries for op every time, then shows it for inline
	// and quote previews, to match parity with the native extension
	.preview-summary
		display none
	// still needs some style work
	#qp .preview-summary
		all unset
		display block
		font-size 80%
		margin .25rem
	
	// Comment too long, and also EXIF data on /p/
	.abbr
		color var(--text-hint-on-background)
		a
			color alpha(ss21primary, .54)
			&:hover
				color alpha(ss21primary, .87)
	
	// EXIF data table on /p/
	.exif
		display none
		font-size .75rem
	
	// I found <span class="oldpost">Marked for deletion (old).</span>
	// in a thread on /f/!
	.oldpost
		color ss21red
		display block
		text-align center
		margin-bottom 1rem
	
	// on october 1st, we celebrate 4chan's birthday (est. 2003)
	.party-hat
		position absolute
		margin-top -2.5rem
		left 0
		z-index 1
		opacity .87
		pointer-events none
	
	// 4CHANX: quote previews (hovering over quotelinks and backlinks) along
	// with image hovering (and youtube thumbnails).
	// XXX: `#qp` has no children, just the text content 'Loading post No. XXX'
	#qp,
	#ihover
		position fixed
		z-index 15
		background-color var(--background-primary)
		borderRadius()
		z-depth(8)
		transform translateZ(1px)
		will-change top, left
		pointer-events none
		contain content
		margin 0 1rem
	
	#qp
		& > .postContainer
			margin 0
			min-width 20rem // XXX: narrow posts with an image get shrunk
			overflow-wrap initial
		&.warning
			padding .5rem 1rem
		img // XXX: would this even work? straight from 4chan x but like, what about videos?
			max-height 80vh
			max-width 50vw
	#ihover
		pointer-events none
		max-height 95vh
		max-width 100vw
	
	@css {
		#qp:not(:has(:first-child)) {
			padding: .5rem;
		}
	}
	
	// 4CHANX: quote threading (we reddit now)
	.threadContainer
		position relative
		//margin 0 0 1rem//1rem // bottom margin is the usual offset, left is the indent
	
	.threadContainer
		display grid
		grid-template-columns 1rem 1fr
	
	.threadContainer .postContainer
		margin-bottom 1rem i
	
	.threadContainer > *
		grid-column 2
	
	.threadContainer::before
		content ''
		position absolute
		left .5rem // not quite flush to the left
		top -1rem // puts it between flush to the post above due to the margin
		display block
		width 2px
		height calc(100% + 1rem)
		z-index -3
		background-color var(--background-primary)
	
	.threadContainer > .threadContainer:last-child::after
		content ''
		background var(--background-secondary)
		height 100%
		width 2px
		position absolute
		display block
		top 3rem
		left .5rem
		z-index -2
	
	.threadContainer > .postContainer::before
		content ''
		width 1rem
		height 5rem
		display block
		position absolute
		top -1rem
		left -.5rem
		z-index -1
		background-color var(--background-secondary)
		border-left 2px solid var(--background-primary)
		border-bottom 2px solid var(--background-primary)
		border-bottom-left-radius 1rem
		box-shadow 0 .5rem var(--background-secondary), -.5rem 0 var(--background-secondary)
		//box-shadow 0 .5rem var(--background-secondary), -1rem 0 var(--background-secondary)
	
	.threadContainer > .postContainer:last-child::after
		content ''
		background var(--background-secondary)
		height 100%
		width 2px
		position absolute
		display block
		top 3rem
		left -.5rem
		z-index -2
	/*
		&::before
			content ''
			position absolute
			left -.75rem // not quite flush to the left
			top -1rem // puts it between flush to the post above due to the margin
			display block
			width 2px
			height 100%
			z-index -3
			background-color blue//var(--background-primary)
		&::after
			content ''
			height 50%
			width 2px
			position absolute
			display block
			bottom 0
			left -.75rem
			z-index -4
			background-color red//var(--background-primary)
	
	.threadContainer > .postContainer
		&::before
			content ''
			width 3rem
			height 1rem
			display block
			position absolute
			top 50%
			left -.75rem
			z-index -1
			background-color var(--background-secondary)
			border-left 2px solid var(--background-primary)
			border-bottom 2px solid var(--background-primary)
			border-bottom-left-radius 1rem
			box-shadow 0 .5rem var(--background-secondary), -.5rem 0 var(--background-secondary)
			//box-shadow 0 .5rem var(--background-secondary), -1rem 0 var(--background-secondary)
		&::after
			content ''
			height 100%
			width 2px
			position absolute
			display block
			bottom 0
			left -.75rem
			z-index -3
			background-color green//var(--background-primary)
		&:last-child::after
			height 50%
	*/
	.is_thread .navLinksBot.desktop
		display block i
		font-size 0
		text-align center
	.threadnewlink > a
		font-size 1rem
		display block
	
	// 4chan x has border-left: 1px solid rgba(128,128,128,.3);
	// it also uses .threadOP clear both but i don't think we have that issue
	
	// 4CHANX: thread and reply hiding, and stubs
	.hide-thread-button,
	.hide-reply-button
		position absolute
		top 0
		right 2.75rem
		opacity 0
		z-index 1
		//will-change opacity
		display inline-flex
		align-items center
		height 1.75rem
		transition opacity .25s
		&:focus
			opacity .54
		& > span
			display inline-flex
			align-items center
	
	// XXX: high specificity to only show the button for the post being hovered
	.postContainer:hover > .hide-thread-button,
	.postContainer:hover > div > .hide-reply-button
		opacity .54
		&:hover
			opacity .87
	
	// XXX: stubs are gross and horrible. hopefully they are rewritten soon(tm)
	// and then they can be given some better love
	// icon black on white, active+focus .87
	// icon black on white, active+NOT focused .54
	// icon black on white, inactive .38
	
	// .stub ~ * is probably a little too expensive $$$ - but it's there because
	// if json index is off and replies are shown, it covers all bases
	
	.stub ~ *
		display none
	
	// XXX: 2024: this was .postContainer, but doesn't work on index.
	// but even with @scope, there are a lot of elements within .thread to be using
	// a * for
	/*
	@css {
		@scope (.thread) {
			.stub ~ * {
				display: none;
			}
		}
	}
*/
	.stub
		display flex
		align-items center
		justify-content left
		padding .5rem 1rem
		//height 3rem
		background-color var(--background-primary)
		borderRadius()
		.show-post-button
			flex 1
			display flex
			align-items center
			> .fa,
			> .stub-icon
				display inline-flex
				&::after
					opacity .54
					transition opacity .25s
			&:hover .fa::after,
			&:hover .stub-icon::after
				opacity .87
	
	/*
	 * as of 4chan-xt 2.15.0-2.15.2, stubs have a bit more styling options
	 */
	
	:root.fourchan-xt
		.show-post-button
			flex-wrap nowrap
			gap .25rem
		.stub-subject
			font-weight 700
			min-inline-size 0
			max-inline-size 30ch
			text-overflow ellipsis
			white-space nowrap
			overflow hidden
		.stub-name
			min-width 0
		.stub-replies
			color var(--text-hint-on-background)
		.stub-reasons
			color var(--text-hint-on-background)
			.stub-reason:not(:only-of-type, :last-child)::after
				content ', '
	
	// file formatting
	.file
		color var(--text-hint-on-background)
		position relative
	/*
<div class="file" id="f82365267"><div class="fileText" id="fT82365267"><span class="file-info"><a href="https://i.4cdn.org/g/1625305273170.jpg" target="_blank">4327773466e141f8b5cdbf29b5c4ad3b.jpeg.1280x0_q85-4327773466e141f8b5cdbf29b5c4ad3b.jpeg.1280x0_q85.jpg</a> (153 KB, 1200x1600) <a href="https://i.4cdn.org/g/1625305273170.jpg" download="4327773466e141f8b5cdbf29b5c4ad3b.jpeg.1280x0_q85-4327773466e141f8b5cdbf29b5c4ad3b.jpeg.1280x0_q85.jpg" class="fa fa-download download-button"></a> <a href="javascript:;" class="fa fa-times quick-filter-md5"></a></span><span class="fileText-original">File: <a title="4327773466e141f8b5cdbf29b5c4ad3b.jpeg.1280x0_q85-4327773466e141f8b5cdbf29b5c4ad3b.jpeg.1280x0_q85.jpg" href="https://i.4cdn.org/g/1625305273170.jpg" target="_blank">4327773466e141f8b5cdbf29b(...).jpg</a> (153 KB, 1200x1600)</span> <a target="_blank" class="sauce" href="https://www.google.com.au/searchbyimage?image_url=https%3A%2F%2Fi.4cdn.org%2Fg%2F1625305273170.jpg&amp;safe=off">g</a> <a target="_blank" class="sauce" href="https://yandex.com/images/search?rpt=imageview&amp;url=https%3A%2F%2Fi.4cdn.org%2Fg%2F1625305273170.jpg">yan</a> <a target="_blank" class="sauce" href="//iqdb.org/?url=https%3A%2F%2Fi.4cdn.org%2Fg%2F1625305273170.jpg">iqdb</a> <a target="_blank" class="sauce" href="https://trace.moe/?auto&amp;url=https%3A%2F%2Fi.4cdn.org%2Fg%2F1625305273170.jpg">trace</a> <a target="_blank" class="sauce" href="//saucenao.com/search.php?url=https%3A%2F%2Fi.4cdn.org%2Fg%2F1625305273170.jpg">sauce</a></div><a class="fileThumb" href="https://i.4cdn.org/g/1625305273170.jpg" target="_blank"><img src="//i.4cdn.org/g/1625305273170s.jpg" alt="153 KB" data-md5="xVHNvpcDjD6lFlYEvST5Pw==" style="height: 250px; width: 187px;" loading="lazy"></a></div>

<div class="fileText" id="fT4662288"><span class="file-info"><a href="https://i.4cdn.org/qa/1625528343446.jpg" target="_blank">__shikinami_asuka_langley_and_souryuu_asuka_langley_evangelion_3_0_you_can_not_redo_neon_genesis_evangelion_and_rebuild_of_evangelion_drawn_by_rabbit_wlsdnjs950__7da53d97f3f82326f2420446d168ddcc.jpg</a> (103 KB, 609x1000) <a href="https://i.4cdn.org/qa/1625528343446.jpg" download="__shikinami_asuka_langley_and_souryuu_asuka_langley_evangelion_3_0_you_can_not_redo_neon_genesis_evangelion_and_rebuild_of_evangelion_drawn_by_rabbit_wlsdnjs950__7da53d97f3f82326f2420446d168ddcc.jpg" class="fa fa-download download-button"></a> <a href="javascript:;" class="fa fa-times quick-filter-md5"></a></span><span class="fileText-original">File: <a title="__shikinami_asuka_langley_and_souryuu_asuka_langley_evangelion_3_0_you_can_not_redo_neon_genesis_evangelion_and_rebuild_of_evangelion_drawn_by_rabbit_wlsdnjs950__7da53d97f3f82326f2420446d168ddcc.jpg" href="https://i.4cdn.org/qa/1625528343446.jpg" target="_blank">__shikinami_asuka_langley(...).jpg</a> (103 KB, 609x1000)</span> <a target="_blank" class="sauce" href="https://www.google.com.au/searchbyimage?image_url=https%3A%2F%2Fi.4cdn.org%2Fqa%2F1625528343446.jpg&amp;safe=off">g</a> <a target="_blank" class="sauce" href="https://yandex.com/images/search?rpt=imageview&amp;url=https%3A%2F%2Fi.4cdn.org%2Fqa%2F1625528343446.jpg">yan</a> <a target="_blank" class="sauce" href="//iqdb.org/?url=https%3A%2F%2Fi.4cdn.org%2Fqa%2F1625528343446.jpg">iqdb</a> <a target="_blank" class="sauce" href="https://trace.moe/?auto&amp;url=https%3A%2F%2Fi.4cdn.org%2Fqa%2F1625528343446.jpg">trace</a> <a target="_blank" class="sauce" href="//saucenao.com/search.php?url=https%3A%2F%2Fi.4cdn.org%2Fqa%2F1625528343446.jpg">sauce</a></div>


<blockquote class="postMessage" id="m149986685"><a href="//boards.4chan.org/r/#s=eddit" class="quotelink">&gt;&gt;&gt;/r/eddit</a></blockquote>
	*/
	.fileText
		--file-gap .25rem
		font-size .75rem
		position relative
		display flex
		align-items center
		gap var(--file-gap)
		white-space normal // copied from 4chan x
		padding-inline .5rem
		padding-block-end .25rem
		if ss21readingMode == ss21light
			background-color rgba(33, 33, 33, .02)
		else if ss21readingMode == ss21dark
			background-color rgba(255, 255, 255, .05)
		if ss21readingMode == ss21light
			box-shadow inset 0 -1px 0 0 darken(ss21BackgroundElevated, 10%)
		else if ss21readingMode == ss21dark
			box-shadow inset 0 -1px 0 0 lighten(ss21BackgroundElevated, 15%)
		a
			color ss21primary
			unicode-bidi isolate // used to counter "malicious" filenames
			&:hover
				color shade(ss21primary, 10%)
		> a
			flex 0 0 auto
		.file-info
			display flex
			flex-wrap nowrap
			align-items center
			min-width 0
			white-space nowrap
			&:has(.fnswitch)
				white-space nowrap
			gap var(--file-gap)
			a:has(> .fnswitch)
				display contents
				white-space initial
			a[target]:not(:has(> .fnswitch))
				white-space nowrap
				overflow hidden
				text-overflow ellipsis
				&:hover
					white-space initial
					overflow initial
					text-overflow initial
			.download-button,
			.quick-filter-md5
				display contents // treat the icons as if they were just there
				align-self flex-end
				&::after
					font-size 1rem // make the icon slightly bigger than the font
					inline-size .75rem
	
	.fileText-original, // the original file text
	.fnswitch:hover > .fntrunc, // when hovering over a filename, hide the truncated version
	.fnswitch:not(:hover) > .fnfull, // when not hovering over a truncated version, hide the full filename
	.expanded-image > .post > .file > .fileThumb > video[data-md5], // when expanded, hide the thumbnail
	.expanded-image > .post > .file > .fileThumb > img[data-md5] // when expanded, hide the thumbnail
		display none
	
	// XXX: these are very specific as to not effect inlined posts
	.expanded-image > .post > .file > .fileThumb > .full-image
		display block
	
	// this is actually `.postContainer`
	.expanded-image
		clear left
		overflow-wrap normal // XXX: this should force text to go under an expanded image if it would be wrapped otherwise
	
	// `.fileThumb > img:first-child`
	.expanding
		opacity .5
	
	:root.fit-height .full-image
		max-height 100vh
	
	:root.fit-height.fixed .full-image
		max-height calc(100vh - 4.5rem)
	
	// XXX: these might not be needed since we make media responsive
	:root.fit-width .full-image
		max-width 100%
	
	:root.ua-gecko.fit-width .full-image
		width 100%
	/*
	.is_thread .expanded-image.file--wide
		.fileThumb
			margin 0
			opacity 1
			float none
			display block
		.full-image
			max-width none
			width 80vw
			position relative
			left calc(-40vw + (70rem / 2) - 2rem)
	*/
	.fileThumb
		float left
		margin .5rem
		if ss21readingMode == ss21dark
			opacity .8
		& > .warning
			clear both // if the file is deleted
		img[alt]
			borderRadius()
	
	/*
	<a class="fileThumb" href="https://i.4cdn.org/pol/1628658711552.webm" target="_blank"><img src="//i.4cdn.org/pol/1628658711552s.jpg" alt="2.26 MB" data-md5="usgTmBCj/BQFUGOYBO2zpg==" style="height: 125px; width: 125px;" loading="lazy" class=""><div class="warning">Error: Corrupt or unplayable video</div><div data-tip="" data-tip-cb="mShowFull" class="mFileInfo mobile">2.26 MB WEBM</div></a>
	this is what the html looks like with an error, which messes up webms
	*/
	
	span.fileThumb
		if ss21readingMode == ss21light
			background-color rgba(33, 33, 33, .02)
		else if ss21readingMode == ss21dark
			background-color rgba(255, 255, 255, .05)
		borderRadius()
		border 1px solid rgba(ss21red, .5)
		padding 1rem
		display inline-flex
		flex-direction column
		align-items center
		justify-content center
		&::before
			font-size 3rem
			color rgba(ss21red, .84)
			text-align center
		&::after
			content 'File deleted.'
			color var(--text-secondary-on-background)
		img
			display none
	
	// in the event the file is deleted, this is what the HTML becomes
	/*
	<span class="fileThumb">
	<img src="//s.4cdn.org/image/filedeleted-res.gif" alt="File deleted." class="fileDeletedRes retina">
	</span>
	*/
	
	// 4CHANX: `.webm` metadata
	.webm-title
		& > a::before
			content 'title'
		&.loading > a::after
			content '...'
		&.error > a:hover::before
			content 'error'
		& > span
			cursor text
		&.not-found > span::before
			content 'not found'
		&:not(:hover) > span,
		&:hover > span + a
			display none
	/*
	// make the icons you can add to the file info a little smaller
	// XXX: needs better vertical alignment
	.download-button,
	.quick-filter-md5
		&::after
			font-size 1rem
	
	// XXX: convert sauce links to icons for fun
	// XXX: on mac + chrome, have to add `white-space: pre` otherwise it still renders
	// the text
	.sauce[href*='google']
		color transparent i
		display inline-block
		white-space pre
		width .75rem
		opacity .54
		background-repeat no-repeat
		background-position 50% 50%
		background-image url("data:image/svg+xml,%3Csvg viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12.24 10.285V14.4h6.806c-.275 1.765-2.056 5.174-6.806 5.174-4.095 0-7.439-3.389-7.439-7.574s3.345-7.574 7.439-7.574c2.33 0 3.891.989 4.785 1.849l3.254-3.138C18.189 1.186 15.479 0 12.24 0c-6.635 0-12 5.365-12 12s5.365 12 12 12c6.926 0 11.52-4.869 11.52-11.726 0-.788-.085-1.39-.189-1.989H12.24z' fill='" + hsl(ss21primary) + "' /%3E%3C/svg%3E")
		transition opacity .25s
		&:hover
			opacity .8
	
	.file--huge > .post > .file .fileText .sauce[href*='google']
		color transparent
		background-image url("data:image/svg+xml,%3Csvg viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12.24 10.285V14.4h6.806c-.275 1.765-2.056 5.174-6.806 5.174-4.095 0-7.439-3.389-7.439-7.574s3.345-7.574 7.439-7.574c2.33 0 3.891.989 4.785 1.849l3.254-3.138C18.189 1.186 15.479 0 12.24 0c-6.635 0-12 5.365-12 12s5.365 12 12 12c6.926 0 11.52-4.869 11.52-11.726 0-.788-.085-1.39-.189-1.989H12.24z' fill='" + hsl(ss21green) + "' /%3E%3C/svg%3E")
	*/
	if ss21thumbnailOpacity == 1
		.fileThumb
			opacity .05
			transition opacity .25s
			&:hover
				opacity .15
	
	if ss21fileInfo == 2
		.postInfo
			if ss21readingMode == ss21light
				box-shadow 0 1px 0 0 darken(ss21BackgroundElevated, 10%)
			else if ss21readingMode == ss21dark
				box-shadow 0 1px 0 0 lighten(ss21BackgroundElevated, 15%)
		.file .fileText
			pointer-events none
			opacity 0
			position absolute
			z-index 1
			borderRadius()
			background-color ss21BackgroundColour
			box-shadow none
			padding .25rem .5rem
			max-width fit-content
			top 0
			transition transform .25s, opacity .25s
			transform-origin left bottom
			transform scale(0) translateY(-15%)
		.file:hover,
		:root.keyboard-focus .file:focus-within,
		:root.werkTyme .post:hover
			.fileText
				pointer-events auto
				transform scale(1) translateY(-70%)
				opacity .9
				display flex
	
	//@var checkbox   ss21fileCard         "Turns files into a card as opposed to the classic look" 0
	if ss21fileInfo == 3
		.file,
		.file a,
		.file span,
		.fileText
			all unset
		.fileText-original
			display none i
		.file
			display flex
			flex-direction column
			float inline-start
			margin .5rem
			background-color lighten(ss21BackgroundElevated, 3%)
			borderRadius()
			overflow hidden
			z-depth(4)
			width 150px
		.expanded-image .file
			width auto
		.fileThumb
			order 1
			display block
			cursor pointer
			width 100%
			img
				object-fit cover
				width 100% i
		.fileText
			order 2
			font-size .75rem
			padding .25rem .5rem
			.file-info
				display block
				white-space initial
			a
				color ss21primary
				cursor pointer
				&:hover
					color shade(ss21primary, 10%)
	
	// not gonna style this properly... right?
	if ss21fileInfo
		:root .board_f .file
			.fileText
				all revert
			a
				color ss21primary
	
	/**
	 * fancy underline animation, courtesy of https://theoutline.com
	 * https://www.news47ell.com/articles/use-svg-css-instead-text-decoration-underline/
	 * https://codepen.io/tigt/post/optimizing-svgs-in-data-uris
	 * thanks to stylus we can just escape at the right point in the string to add the
	 * variable'd colour. otherwise, we would not be able to access css variables
	 * from within an escaped svg within css added to the page
	 */
	.forwardlink
		background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 4'%3E%3Cpath fill='none' stroke='" + hsl(ss21primary) + "' class='s' d='M0 3.5c5 0 5-3 10-3s5 3 10 3 5-3 10-3 5 3 10 3'/%3E%3Cstyle%3E.s %7B animation: shift 0.3s linear infinite; %7D @keyframes shift %7B from %7B transform: translateX(0); %7D to %7B transform: translateX(-20px); %7D %7D%3C/style%3E%3C/svg%3E")
		background-position 0 100%
		background-size auto 3px
		background-repeat repeat-x
	
	.hashlink::before
		content ' '
	
	.filtered,
	.deadlink
		text-decoration line-through i // only because of the highly specific "links in a post" selector earlier
		opacity .6
	
	:root.hide-backlinks .backlink.filtered,
	:root.hide-backlinks .backlink.filtered + .hashlink.filtered
		display none
	
	.inlined
		opacity .6
	
	.inline
		display flow-root
		font-size 1rem
		clear both
		margin .5rem
		borderRadius()
		z-depth(2)
	
	.inline + .hashlink
		display none
	
	// XXX: when xt restores posts from the archive
	@css {
		@property --gradient-angle {
			syntax: "<angle>";
			initial-value: 0deg;
			inherits: false;
		}
		@keyframes rotation {
			0% {
				--gradient-angle: 0deg;
			}
			100% {
				--gradient-angle: 360deg;
			}
		}
		.from-archive::before {
			content: '';
			position: absolute;
			inset: -1px;
			z-index: -1;
			border-radius: 4px;
			background-image: conic-gradient(
				from var(--gradient-angle),
				rgba(255 255 255 / 0),
				rgba(255 255 255 / .5),
				rgba(255 255 255 / .8),
				rgba(255 255 255 / .5),
				rgba(255 255 255 / .1)
			);
			
			animation: rotation 2s linear infinite;
		}
	}
	
	// XXX: make special kinds of quotelinks appear `sup`-scripted
	+prefix-classes('qmark-')
		.ct
			font-size 0
			&::after
				content ' (CT)'
		.op,
		.you,
		.ct::after,
		.dead
			position relative
			font-size .75rem
			vertical-align baseline
			top -.5em
			left -.25ch
	
	// 4CHANX: backlinks
	:where(.container)
		display block
		font-size .75rem
		font-family var(--font-monospace)
		width 100%
		clear both // clears bottom container under file thumbnails
	.backlink.deadlink
		text-decoration none i // XXX: why !important (earlier)
	
	// top backlinks, enforcing the 'quoted by' style
	:where(:root:not(.bottom-backlinks)) :where(.container:not(:empty))
		color var(--text-hint-on-background)
		padding-inline-start .5rem
		&::before
			content 'quoted by: '
		&::after
			content '.'
		:where(.backlink:not(:only-of-type):not(:last-of-type))::after
			content ', '
			color var(--text-hint-on-background)
		:where(.backlink:not(:only-of-type):last-of-type)::before
			content ' and '
			color var(--text-hint-on-background)
	
	// bottom backlinks
	:where(:root.bottom-backlinks) :where(.container)
		padding .125rem .5rem
		if ss21readingMode == ss21light
			background-color rgba(33, 33, 33, .02)
			box-shadow inset 0 1px 0 0 darken(ss21BackgroundElevated, 10%)
		else if ss21readingMode == ss21dark
			background-color rgba(255, 255, 255, .05)
			box-shadow inset 0 1px 0 0 lighten(ss21BackgroundElevated, 15%)
	
	if ss21backlinkStyle == 2
		:where(.container)
			display flex
			flex-wrap wrap
		:where(.container) :where(.backlink)
			font-size 0
		:where(.container) :where(.backlink)::after
			icon-style()
			content ss21iconFont == 1 ? '\F51F' : 'reply'
			font-size 18px
			color ss21primary
			font-variation-settings 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24
			opacity .54
			will-change opacity
			transition opacity .25s
		:where(.container) :where(.backlink):hover::after
			opacity .87
		:where(.backlink.deadlink) span
			display none // removes the qmarks from dead backlinks
	
	/*
	<a href="#p91030252" class="backlink deadlink">#91030252<span class="qmark-dead">&nbsp;(Dead)</span></a>
	*/
	
	:where(.container:empty)
		display none
	
	// XXX: https://github.com/TuxedoTako/4chan-xt/issues/10#issuecomment-1865093994
	:root.fourchan-xt .post:target
		scroll-margin-top 5rem
	
	// 4CHANX: fappe and werk tyme support, including shortcuts indicators
	.indicator
		font-size 0
		tc(invert(ss21primary), high)
		background-color invert(ss21primary)
		display inline-flex
		align-items center
		justify-content center
		padding .25rem
		borderRadius()
		cursor pointer
		&::after
			font-size 1rem
	
	:root.fappeTyme .thread > .noFile,
	:root.fappeTyme .threadContainer > .noFile
		display none
	
	:root.werkTyme .postContainer:not(.noFile) .fileThumb,
	:root.werkTyme .catalog-thumb:not(.deleted-file):not(.no-file),
	:root:not(.werkTyme) .werkTyme-filename
		display none
	
	// 4CHANX: post highlighting and filter effects
	// some of these will only work if you added the filters i asked you to install
	.postContainer > .post:target, // for when a post is quoted in the url
	.filter-highlight > .post, // posts that match the default 4chan x highlight filter
	.highlight, // ???
	.postContainer > .qphl, // the current post being previewed from the post list
	:root.highlight-own .yourPost > .post, // post that is marked as your own
	:root.highlight-own .yourPost .stub // stubs of posts marked as your own
		background-color mix(#FFECB3, ss21BackgroundElevated, 7%) i
	
	:root.highlight-you .quotesYou > .post // replies to posts marked as your own
		background-color mix(#FFCDD2, ss21BackgroundElevated, 7%)
	
	// when in catalogue mode, give threads a red glow to show they are highlighted
	// XXX: probably can be simplified in our version of the catalogue
	:root:not(.werkTyme) .catalog-thread.filter-highlight .catalog-post,
	:root.werkTyme .catalog-thread.filter-highlight:not(:hover),
	:root.werkTyme:not(.catalog-hover-expand) .catalog-thread.filter-highlight,
	:root.werkTyme.catalog-hover-expand .catalog-thread.filter-highlight > .catalog-container:hover > .catalog-post,
	:root.catalog .thread.filter-highlight
		box-shadow 0 0 3px 3px rgba(255, 0, 0, .5)
	
	// when in catalogue mode, give watched threads a red outline
	// XXX: same here
	:root:not(.werkTyme) .catalog-thread.watched .catalog-post,
	:root:root.werkTyme .catalog-thread.watched:not(:hover),
	:root:root.werkTyme:not(.catalog-hover-expand) .catalog-thread.watched,
	:root.werkTyme.catalog-hover-expand .catalog-thread.watched > .catalog-container:hover > .catalog-post
		box-shadow 0 0 3px 3px rgba(255, 0, 0, .5)
	
	// XXX: needs to be coincided with normal .fileText
	.file--huge > .post > .file > .fileText > .file-info > a:first-child
		color ss21green
		&:hover
			color darken(ss21green, 10%)
	
	// XXX: depending on theme and primary colour, bottom backlinks become hard
	// to read; perhaps a text-shadow glow for backlinks?
	.postContainer.post--hot > .post
		if ss21readingMode == ss21light
			background-image linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(232, 163, 174, .33))
		else if ss21readingMode == ss21dark
			background-image linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(140, 35, 50, .33))
	
	/*
url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='" + hsl(ss21poster(admin)) + "' viewBox='0 0 16 16'%3E%3Cpath d='M10.067.87a2.89 2.89 0 0 0-4.134 0l-.622.638-.89-.011a2.89 2.89 0 0 0-2.924 2.924l.01.89-.636.622a2.89 2.89 0 0 0 0 4.134l.637.622-.011.89a2.89 2.89 0 0 0 2.924 2.924l.89-.01.622.636a2.89 2.89 0 0 0 4.134 0l.622-.637.89.011a2.89 2.89 0 0 0 2.924-2.924l-.01-.89.636-.622a2.89 2.89 0 0 0 0-4.134l-.637-.622.011-.89a2.89 2.89 0 0 0-2.924-2.924l-.89.01-.622-.636zm.287 5.984-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7 8.793l2.646-2.647a.5.5 0 0 1 .708.708z'/%3E%3C/svg%3E")
*/
	
	identity-icon-style(type)
		if ss21iconFont == 1
			background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='" + type + "' viewBox='0 0 16 16'%3E%3Cpath d='M10.067.87a2.89 2.89 0 0 0-4.134 0l-.622.638-.89-.011a2.89 2.89 0 0 0-2.924 2.924l.01.89-.636.622a2.89 2.89 0 0 0 0 4.134l.637.622-.011.89a2.89 2.89 0 0 0 2.924 2.924l.89-.01.622.636a2.89 2.89 0 0 0 4.134 0l.622-.637.89.011a2.89 2.89 0 0 0 2.924-2.924l-.01-.89.636-.622a2.89 2.89 0 0 0 0-4.134l-.637-.622.011-.89a2.89 2.89 0 0 0-2.924-2.924l-.89.01zm.287 5.984-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7 8.793l2.646-2.647a.5.5 0 0 1 .708.708'/%3E%3C/svg%3E")
		else if ss21iconFont == 2
			background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0z'/%3E%3Cpath fill='" + type + "' d='M23 12l-2.44-2.79.34-3.69-3.61-.82-1.89-3.2L12 2.96 8.6 1.5 6.71 4.69 3.1 5.5l.34 3.7L1 12l2.44 2.79-.34 3.7 3.61.82L8.6 22.5l3.4-1.47 3.4 1.46 1.89-3.19 3.61-.82-.34-3.69L23 12zm-12.91 4.72l-3.8-3.81 1.48-1.48 2.32 2.33 5.85-5.87 1.48 1.48-7.33 7.35z'/%3E%3C/svg%3E")
	
	.postContainer.poster--admin,
	.postContainer:has(> .postInfo > .capcodeAdmin)
		> .post
			background-color mix(ss21posterAdmin, ss21BackgroundColour, 10%)
			.identityIcon
				identity-icon-style(hsl(ss21poster(admin)))
			> .postInfo > .nameBlock
				color ss21posterAdmin
	
	// XXX: .stub:has(~ .postContainer:has(.capcodeAdmin)) would be nice
	.stub:has(~ .poster--mod)
		background-color mix(ss21posterAdmin, ss21BackgroundColour, 10%)
	
	.postContainer.poster--mod,
	.postContainer:has(> .postInfo > .capcodeMod)
		> .post
			background-color mix(ss21poster(mod), ss21BackgroundColour, 10%)
			.identityIcon
				identity-icon-style(hsl(ss21poster(mod)))
			> .postInfo > .nameBlock
				color ss21poster(mod)
	
	.stub:has(~ .poster--mod)
		background-color mix(ss21poster(mod), ss21BackgroundColour, 10%)
	
	.postContainer.poster--verified
		> .post
			background-color mix(ss21posterVerified, ss21BackgroundColour, 10%)
			.identityIcon
				identity-icon-style(hsl(ss21poster(verified)))
			> .postInfo > .nameBlock
				color ss21posterVerified
	
	:root:not(.anonymize) .postContainer.poster--pass
		> .stub
			background-color mix(ss21posterPass, ss21BackgroundColour, 5%)
		> .post
			background-color mix(ss21posterPass, ss21BackgroundColour, 5%)
			> .postInfo > .nameBlock
				color ss21posterPass
		if ss21openThread == 0
			+ .summary
				background-color mix(ss21posterPass, ss21BackgroundColour, 5%)
	
	.postContainer.post--aus
		> .post
			background-color mix(blue, ss21BackgroundColour, 3%)
	/*
	<span class="nameBlock"><span class="name">Anonymous</span> <span title="Pass user since 2014" class="n-pu"></span></span>
	*/
	.n-pu
		display inline-flex
		&::after
			font-size 20px //XXX: what is with this inconsistent icon sizing???
			opacity .54
	
	// give webms and gifs a little visual icon overlay
	// XXX: if a thumbnail is <32px high, the icon is higher than that
	.file--gif,
	.file--video,
	.file--pdf
		.fileThumb
			position relative
		&:not(.expanded-image) > .post > .file
			& > .fileThumb::after
				font-size 200%
				position absolute
				inset 0
				inline-size 100%
				block-size 100%
				justify-content center
				align-items center
				background-image linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 1))
				color #fff
				opacity .8
				border-radius 3px
				transition opacity .25s
				pointer-events none
				overflow hidden
			&:hover > .fileThumb::after
				opacity .6
	
	.file--sound
		.fileThumb
			position relative
		&:not(.expanded-image) > .post > .file
			& > .fileThumb .mobile
				display block
				font-size 0
				position absolute
				top 0
				left -2rem
				&::after
					content 'music_note'
					font-size 1rem
					color ss21blue
					pointer-events none
	
	.thread-chip--mire .post
		background-color mix(pink, ss21BackgroundColour, 10%)
	
	.post--dubs
		//will-change transform
		transform perspective(1px) translateZ(0)
		animation buzz .25s linear infinite
		z-index 1 // for some reason the menu gets offset when transformed
		--post--dubs-color ss21green
	@css {
		@scope (.post--dubs) {
			.postNum a:nth-child(2n)::after {
				color: var(--post--dubs-color);
				position: absolute;
				top: 0;
				pointer-events: none;
			}
		}
	}
	@css {
		@keyframes buzz {
			50% {
				transform: translateX(2px) rotate(.5deg);
			}
			100% {
				transform: translateX(-2px) rotate(-.5deg);
			}
		}
	}
	
	.file--ai .fileThumb
		position relative
		&::before
			content ''
			background-color #75ac9d
			background-repeat no-repeat
			background-position center center
			background-size 24px 24px
			background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='white' d='M19,1L17.74,3.75L15,5L17.74,6.26L19,9L20.25,6.26L23,5L20.25,3.75M9,4L6.5,9.5L1,12L6.5,14.5L9,20L11.5,14.5L17,12L11.5,9.5M19,15L17.74,17.74L15,19L17.74,20.25L19,23L20.25,20.25L23,19L20.25,17.74' /%3E%3C/svg%3E")
			border-radius 8px
			display block
			height 32px
			width 32px
			position absolute
			top -4px
			left -4px
			pointer-events none
			opacity .87
	
	if ss21postInfoBg == 0
		.postInfo
			background-color initial
			box-shadow none i
		.postMessage
			padding-top 0
	
	if ss21postInfoFont == 1
		.postInfo
			--post-info-fs .75rem
			font-size var(--post-info-fs, .75rem)
	/*
	@media (hover: none) {
		#header-bar {
			background: red !important;
		}
	}
	*/
	if ss21postInfoDisplay == 0
		.fileThumb
			//margin-top .25rem
	
	if ss21postInfoDisplay == 1
		.postInfo
			position absolute
			right 1px
			background-color inherit
			opacity 0
			transition opacity .25s
		.post:hover > .postInfo
			opacity 1
		.postMessage
			padding-top .5rem
	
	// posts that get deleted have `.deleted-post` added to `.postContainer`,
	// along with a `<strong class="warning">[Deleted]</strong>` added between
	// `.postInfo`'s checkbox and `.nameBlock`
	.deleted-post
		opacity .54
		// XXX: https://stackoverflow.com/a/11742116
		z-index 1
		.post,
		.stub
			background-color mix(ss21red, ss21BackgroundColour, 10%)
	
	// 4CHANX: applies contact links to admins and mods
	.contact-links
		display inline-flex
		a
			margin-right .25rem
		&::after
			font-size 20px
			cursor help
	.contact-links:not(:hover) a
		display none
	
	// 4CHANX: anonymise
	:root.anonymize
		.name
			font-size 0
			&::before
				content 'Anonymous'
				font-size 1rem
		.postertrip, // hide tripcodes
		.n-pu // hide pass identifier
			display none
	
	// `<strong>[Deleted]</strong>` appears before `.nameBlock`
	//.postInfo .warning
		//margin-right .25rem
	
	// 4CHANX: if enabled, allow you to jump to posts by the same id
	.is_index .postJumper
		display none // only show it in threads
	
	// we get fancy with the styling and make it stack
	.postJumper
		font-size 0
		display inline-flex
		flex-direction column
		justify-content center
		.next
			margin-top -2px
		.prev,
		.next
			width .625rem
			&::after
				font-size .625rem
				transition opacity .25s
				opacity .54
			&:hover::after
				opacity .89
	
	.flag
		top initial
	
	// 4CHANX: copy text link hidden textarea
	// wonder if a visiblity: hidden would suffice here
	// XXX: 2024 note: no, it doesnt
	.copy-text-element
		height 0
		width 0
		position absolute
		top -100rem
	
	// 4CHANX: permanent announcement on /qa/
	.fcx-announcement
		position fixed
		z-index 5
		bottom 1rem
		left 1rem
		background-color ss21BackgroundElevated
		padding .5rem 1rem
		borderRadius()
		z-depth(8)
		a
			color ss21primary
			&:hover
				color shade(ss21primary, 10%)
	
	/**
	* catalogue support 😂👌
	* what level of css archeticure are you on?
	* idk, bem or something
	* ha, pathetic; watch this
	*/
	// XXX: 2022 WOW CONTAINER QUERIES
	// might be useful somehow
	/*
	.catalog-thread
		container inline-size / post
	
	@container post (max-width: 30ch)
		.catalog-post
			background red
	*/
	// first thing, hide a bunch of elements not needed when in catalogue mode.
	// because normal threads/posts are given their own visual style,
	// and because most of the information is hidden when shown in this particular
	// card style, a lot of that has to get reset when represented here
	.catalog-container > .hide-thread-button, // if enabled, thread hiding button
	.catalog-post .container, // backlink container
	.catalog-post .file, // all file-related information
	.catalog-post .watch-thread-link, // love heart for watching threads
	.catalog-post .postJumper, // post jumper
	.catalog-post .postNum, // view/reply button
	.catalog-post .postInfo .menu-button, // original menu button
	.catalog-post .extra-linebreak,
	.catalog-post [class^='qmark'] // XXX: due to the way ss21 does qmarks, this looks weird
		display none
	
	// hides small/large thumbnail options when viewing as masonry
	if ss21catalogueStyle == 2
		:root.catalog-mode .is_index
			#index-size
				display none
			.navLinks::after
				content '"Masonry" mode might require an F5 to look good, as it tries to load full image thumbnails. You can also try quickly changing the sorting style. Ignore the bottom of the page...'
				display block
				text-align center
				padding .5rem 1rem
				borderRadius()
				background-color rgba(0, 0, 0, .69)
				tc(@background-color, high)
				position absolute
				bottom 0
				left 50%
				max-width 25rem
				transform translateX(-50%) translateY(-75%)
				pointer-events none
	
	// removes the direct link to thread thumbnail and thread stats when
	// switching between 4chan x index and catalog (it keeps the old html for some reason)
	:root:not(.catalog-mode)
		.catalog-link,
		.catalog-stats,
		.catalog-replies
			display none
	
	if ss21catalogueStyle
		:root
			--masonry 1
	
	// lots of explanation here for future looking back
	// next thing we do is reset `.board` a little
	:root.catalog-mode .board
		max-width 100% // normally `75rem`
		display grid
		grid-gap 1rem
		grid-auto-flow dense // honestly, this probably does nothing
		if ss21catalogueStyle == 1 // default-esque style
			grid-auto-rows 15rem // automatically create rows that are `240px` high
		if ss21catalogueStyle == 2
			grid-template-columns repeat(6, 1fr)
			//grid-template-columns repeat(auto-fit, minmax(min(15em, 100%), 1fr))
			grid-template-rows masonry // lifted from https://css-tricks.com/a-lightweight-masonry-solution/
			justify-content center
	
	if ss21catalogueStyle == 2
		:root.catalog-mode .board:is([data-thread-count="1"], [data-thread-count="2"], [data-thread-count="3"], [data-thread-count="4"], [data-thread-count="5"], [data-thread-count="6"])
			grid-template-columns repeat(6, 1fr)
	
	if ss21catalogueStyle == 1
		:root.catalog-mode
			.board
				&.catalog-small
					//grid-template-columns repeat(12, 1fr) // 12 columns for 'Small'
					grid-template-columns repeat(auto-fit, minmax(10rem, 1fr))
				&.catalog-large
					//grid-template-columns repeat(8, 1fr) // 8 columns for 'Large'
					grid-template-columns repeat(auto-fit, minmax(15rem, 1fr))
		.catalog-thread
			height 15rem
			.postMessage
				max-height calc(15rem - 7rem - 27px)
				overflow hidden
			&.thread--extra-long,
			&.thread--silly-long,
			&.thread--new-lines
				grid-column span 2
				grid-row span 2
				height 31rem
				.catalog-thumb,
				.catalog-thumb-video
					height 15rem i
				.postMessage
					max-height calc(31rem - 15rem - 1rem - .8rem)
					overflow hidden
	
	.catalog-thread
		// reset what would normally be `.thread`
		padding 0
		margin 0
		// the article says you need `align-self: start;`, but this doesn't apply to `block` elements...
		align-self start
		&:hover
			z-index 2
	
	// in order to achieve the "whole card expanded on hover"
	// but, this only applies in default-esque mode because in masonry mode, you will always
	// see the whole thread
	if ss21catalogueStyle == 1
		.catalog-container
			position absolute
			inset 0
			max-width none // normally `100%`, though not sure if it affects it
			&:hover
				.catalog-post
					transform scale(1.05) translateY(-1%)
					//margin -1rem -3rem
					// because menu is a child of the catalog post, the pixels used to calculate where to position it
					// next to the button you just clicked also get scaled up, so we try to counter the scale here
					/*
					.menu-button.active + #menu
						transform scale(1) translateX(70%) translateY(5%)
						position absolute
						top 16px i
						left auto i
						right 0 i
						&.left
							transform scale(1) translateX(0) translateY(5%)
					*/
				.postMessage
					max-height none
					overflow auto
	
	// regardless of `ss21catalogueStyle`, posts look different in catalogue mode
	.catalog-post
		// reset what would normally be `.post`
		display flex
		flex-direction column
		min-height 100% // XXX: better way to fill up container?
		transition all .25s
		width 100%
		position relative
	
	/**
	* html order is: file, link/thumb, stats, postinfo, postmessage
	* we switch it to: file, link/thumb, postinfo, postmessage, stats
	*/
	.file
		// XXX: if you ask me, this is not required and should not be used from the catalogue. even on hover
		order 1
	.catalog-link
		order 2
		display block // required to it being an `a` element
		.catalog-thumb,
		.catalog-thumb-video
			border-radius 4px 4px 0 0
			width 100% i
			// so the trade off here, is that you lose the "fluidity" of cards, that is
			// can't enforce the threads to keep to their 15rem height if each thumbnail
			// varies in height, so we force it at `7rem` which shrinks big images and
			// enlarges small ones
			height 7rem i
			if ss21catalogueStyle == 2
				height auto i
			// object-fit is here to try and make it look better, but since we can't determine
			// what image a user will upload, it may cut off in the grid
			object-fit cover
			if ss21readingMode == ss21dark
				opacity .8
			&.deleted-file
				min-height auto
		&:has(.no-file)
			min-height 4rem
	
	.file--tall .catalog-thumb
		object-fit contain
	
	.catalog-stats
		order 5
		padding .25rem .5rem
		margin-top auto
		display flex
		align-items center
		border-top 1px solid tint(ss21BackgroundElevated, 5%)
		span[title]
			font-size .75rem
			color var(--text-hint-on-background)
			cursor help
			span
				color var(--text-primary-on-background)
		.catalog-icons
			flex 1
			display flex
			justify-content flex-end
		.menu-button
			opacity 1
			transition opacity .25s
			//will-change opacity
	.catalog-post
		.postInfo
			all unset
			order 3
			position relative
			*
				display none
		.postMessage
			order 4
			font-size .75rem
			padding .25rem .5rem
			&:empty
				display none // this forces `catalog-stats` to the bottom
			if ss21catalogueStyle == 1
				flex 1
				//flex 1 1 0 // XXX: DUH WHY DONT I UTILISE FLEX BASES
				//overflow hidden
			if ss21catalogueStyle == 2
				flex 1
			// XXX: temp solution, make [code] %-based
			.prettyprint
				font-size 87.5%
	/*
	.catalog-post:has(.postMessage:empty)
		.catalog-link
			flex 1
		.catalog-thumb
			height 13.5rem i
	*/
	.catalog-icons:empty
		display none
	// XXX: maybe catalogue stats icons
	// media: photo_library
	// replies: content_copy
	// page: article, find_in_page, description
	
	if ss21catalogueIcons
		.catalog-stats
			width 100%
			flex-direction row
		.catalog-stats > span[title]
			font-size 0
			span
				font-size .75rem
				display inline-flex
				align-items center
				margin-right .25rem
			span::before
				icon-style()
				font-size 18px
				line-height 1
				font-variation-settings 'FILL' 0, 'wght' 400, 'GRAD' 200, 'opsz' 18
				margin-right .25rem
				opacity .54
			.post-count::before
				content ss21iconFont == 1 ? '\F759' : 'content_copy'
			.file-count::before
				content ss21iconFont == 1 ? '\F42B' : 'photo_library'
			.page-count::before
				content ss21iconFont == 1 ? '\F3B8' : 'description'
	
	// XXX: keep the subject overlay separate
	.catalog-post .subject:not(:empty)
		display block
		text-shadow 0 1px 2px rgba(0 0 0 .3)
		color #fff
		background-image linear-gradient(to top, black, transparent)
		padding .5rem
		width calc(100% - 1rem)
		position absolute
		bottom 0
		// 1 line subject, overflow hidden
		//overflow: hidden;
		//white-space: nowrap;
		//text-overflow: ellipsis;
		// https://ishadeed.com/article/css-short-long-content/
		// fancy line-clamp, but can't use padding
		padding-bottom .25rem
		display -webkit-box
		-webkit-line-clamp 2
		-webkit-box-orient vertical
		overflow hidden
		pointer-events none
		/*
		tc(black, high)
		text-shadow 0 1px 2px rgba(0 0 0 .3)
		background-image linear-gradient(to top, black, transparent)
		padding .5rem
		width 100%
		position absolute
		top calc(var(--tn-h) * 1px)
		pointer-events none
		*/
		&::after
			// get rid of 'by' that normally is applied
			display none
	
	:root.werkTyme .catalog-post .werkTyme-filename
		height 7rem
		display block
		width 100%
		text-align center
		overflow hidden
	
	// 4CHANX: if 'show replies' is enabled, on catalogue they are added to
	// `.catalog-post` upon hovering over `.thread`
	// XXX: at this stage, the issue is the text is not respecting the max width of each column in the grid
	/*
	* https://codepen.io/eddiebluh/pen/EyoWvp
	* https://codepen.io/shadeed/pen/mdyMmwd/398ccffcd437a2fb042f5ce3bdd68c57
	* https://ishadeed.com/article/min-max-css/#setting-min-width-to-zero-with-flexbox
	* https://ishadeed.com/article/css-short-long-content/
	*/
	.catalog-replies
		//display none i
		order 6
		font-size .75rem
		.catalog-reply
			display flex
			flex-direction row
			flex-wrap wrap
			align-items stretch
			padding .25rem
			border-top 1px solid darken(ss21BackgroundElevated, 25%)
			span
				font-size 0
				color var(--text-hint-on-background)
				margin-right .25rem
				time
					font-size .75rem
			.catalog-reply-excerpt
				overflow hidden
				white-space nowrap
				text-overflow ellipsis
				flex 1
				min-width 0
			.catalog-reply-preview
				margin-left .25rem
	
	// hide replies after hovering is done so they don't stay rendered
	.catalog-thread:not(:hover) .catalog-replies
		display none
	
	// only show the menu on hover
	// XXX: probably needs a background
	.catalog-thread:not(:hover):not(:focus-within) .menu-button
		opacity 0
	
	.is_index .thread--extra-new-lines
		max-height 25rlh
		overflow-y scroll
	
	// pagelist styling
	.pagelist
		display flex
		margin 1rem
		button
			display none // we utilise icons as opposed to buttons
		.pages:not(.cataloglink)
			font-size 0 // get rid of surrounding brackets
			flex-grow 1 // make all the pages fill the center
			display flex
			justify-content space-between // auto space, as pages can differ
			align-items center
			strong
				display contents
				a
					tc(ss21primary, high)
					background-color ss21primary
		a
			font-size 2rem
			font-weight 700
			flex-shrink 0
			display inline-flex
			justify-content center
			align-items center
			background-color transparent
			border-radius 100%
			aspect-ratio 1/1
			width clamp(4rem, 5rem, 6rem)
			transition color .25s, background-color .25s
			&:hover
				tc(ss21primary, high)
				background-color alpha(ss21primary, .54)
		.prev,
		.next
			display contents
			// XXX: $$$: the below CSS causes #qp to take incredibly long to render
			&:has(button[disabled])// a
				pointer-events none
				opacity .42
	@media (max-width: 75rem)
		.pagelist
			overflow-x auto
			a
				font-size 1rem
				width 2rem
	
	// non json index support
	.pagelist.desktop
		display flex i // XXX: might be able to drop the important with better selectors
		.prev,
		.next
			.pageSwitcherForm
				display contents
			span
				// treat it as a button, though this won't honour the button style
				font-size 0.875rem
				line-height 1
				letter-spacing 0.09em
				display inline-flex
				align-items center
				padding 0 0.75rem
				min-height 2.25rem
				min-width 4rem
				color var(--grey-900)
				background-color var(--grey-500)
				pointer-events none
				opacity .42
				border-radius 32rem
				padding 0 24px
			input[type="submit"]
				height auto
	
	// bottom board navigation
	// XXX: on fresh 4chan x install, this is disabled
	:root.hide-bottom-board-list
		#boardNavDesktopFoot
			display none
		.absBotText
			border-radius 4rem 4rem 0 0
	
	// SIDEDISH: this grabs the current board list and categories from 4chan.org
	// !important is used because it grabs the literal HTML, inline styles and all
	#boardNavDesktopFoot
		color var(--grey-500)
		background-color var(--grey-900)
		padding 3rem 1.5rem 1rem
		position relative
		border-radius 4rem 4rem 0 0
		margin 0 1rem
		.boardList
			display grid
			grid-gap 1rem
			grid-template-columns repeat(5, 1fr)
			@media (max-width: 60rem)
				grid-template-columns repeat(3, 1fr)
			@media (max-width: 40rem)
				grid-template-columns repeat(2, 1fr)
			max-width 75rem
			margin auto
			overflow-x auto
		h3
			font-size 1.25rem
			letter-spacing 0.03em
			text-transform uppercase
			color var(--grey-300)
		ul
			list-style none
			padding 0
			margin .25rem 0 1rem
		li
			margin-bottom .25rem
		sup
			color ss21red
		a:hover,
		.current
			color var(--grey-300)
	
	#boardNavDesktopFoot:not(.ss21--footer-enhanced)
		&::before
			content 'Full 4chan Board List'
			font-size 1.25rem
			letter-spacing 0.03em
			font-weight 700
			text-transform uppercase
			color var(--grey-300)
			display block
			max-width 75rem
			margin auto
		.boardList
			font-size 0
			display flex
			flex-wrap wrap
			flex-direction column
			align-items baseline
			height calc(1rlh * 20)
			gap 0 1rem
			a
				font-size 1rem
				display inline-block
				block-size 1.25rlh
				&::before
					content '/'
				&::after
					content '/ ' attr(title)
	
	// copyright information in the footer
	:root.hide-bottom-board-list .absBotDisclaimer
		border-top 0
		padding-top 3rem
	
	.absBotText
		font-size .875rem
		color var(--grey-500)
		background-color var(--grey-900)
		padding 0 1.5rem
		position relative
		overflow hidden
		margin 0 1rem
		user-select none
	
	.absBotDisclaimer
		display block
		border-top 1px solid var(--grey-500)
		max-width 75rem
		padding-top 1rem
		margin 0 auto 1rem
	
	#footer-links
		font-size 0
		max-width 75rem
		padding-bottom 3rem
		margin auto
		position relative
		display flex
		@media (max-width: 40rem)
			flex-direction column
			gap .25rem
			align-items baseline
		&::after
			content url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAABinRfyAAAACVBMVEUAAAAAAABmzDMXpqcGAAAAAXRSTlMAQObYZgAAADxJREFUCNdjYIADVgfGAAapCWxLGNiWSE1gkFoitYSBNYA1gAEJBLAyMDAukXKAKIEQKZITGBgFWBzACgCbuwrJhJgswAAAAABJRU5ErkJggg==')
			display block
			position absolute
			top 0
			right 0
			filter grayscale(1)
			opacity .69
		a
			font-size .875rem
			display inline-block
			margin-right 3rem
			@media (max-width: 40rem)
				padding .25rem 0
				margin-right 0
			&:hover
				color var(--grey-300)
	
	.ss21--spinner-text
		color var(--grey-500)
		position absolute
		pointer-events none
		width 250px
		top 0
		right 50px
		animation spinningText 40s infinite
		transform-origin 50% 50%
		opacity .3
		svg
			font-size 63px
			letter-spacing 22px
			font-weight 900
			fill var(--grey-500)
	
	@media (max-width: 1600px)
		.ss21--spinner-text
			top 69px
	
	@css {
		@keyframes spinningText {
			0% {
				transform: rotate(0deg);
				animation-timing-function: linear;
			}
			100% {
				transform: rotate(360deg);
			}
		}
	}
	
	// the quick reply
	// XXX: https://developer.mozilla.org/en-US/docs/Web/CSS/::file-selector-button
	// XXX: https://github.com/twbs/bootstrap/compare/98cd0eee62...a1d0afe81c
	// the qr is rendered the same essentially on every board, so let's get this
	// massive selector chain over and done with
	#qr.autohide:not(.focus):not(:hover):not(:active) > form, // autohide the qr form when not in use
	#autohide, // the checkbox to autohide (click the label)
	#qr.forced-anon input[data-name="name"]:not(.force-show),
	#qr.forced-anon input[data-name="sub"]:not(.force-show),
	#qr.reply-to-thread input[data-name="sub"]:not(.force-show),
	#qr.reply-to-thread:not(.show-new-thread-option) select[data-name="thread"], // hide new thread options if enabled
	body:not(.board_f) #qr [name="filetag"], // tag for flash files when not on /f/
	#qr.reply-to-thread [name="filetag"], // tag for flash files when in a thread (regardless if on /f/ or not)
	#qr:not(.has-sjis) #sjis-toggle, // only show shift_jis on boards that support it (/jp/)
	#qr:not(.has-math) #tex-preview-button, // only show tex on boards that support it (/sci/)
	#qr.tex-preview .textarea > :not(#tex-preview), // show the live tex preview
	#qr:not(.tex-preview) #tex-preview, // hide the live tex preview
	#qr:not(.dump) #dump-list-container, // when not in dump mode, hide the dumper
	#qr .oekaki.has-file, // don't offer to start a fresh drawing if there's a file
	#file-n-submit:not(.has-file) #qr-filerm, // file remove icon if there is no file
	#file-n-submit:not(.has-file) #qr-view // file preview icon if there is no file (4chan xt only)
		display none
	
	// XXX: auto-hide checkbox should be keyboard accessible
	#qr
		position fixed
		z-index 10
		background-color var(--background-primary)
		inline-size 35rem
		max-inline-size 100%
		max-block-size 90vh
		z-depth(8)
		borderRadius()
		contain paint
		if ss21QRPosition == 2
			top auto i
			right 0 i
			bottom 0 i
			left auto i
			width 25rem
		> .move
			background-color ss21primary
			tc(@background-color, high)
			padding 0 1.5rem
			display flex
			align-items center
			justify-content space-between
			height 3rem
			> label
				text-transform lowercase
			> .close
				font-size 0
				tc(ss21primary, medium)
				transition color .25s
				order 3
				margin-left 1.5rem
				&:hover
					tc(ss21primary, high)
		form
			padding 1rem
			max-height calc(100vh - 5rem)
			overflow hidden auto
			display flex
			flex-direction column
			gap .5rem
			.persona
				display flex
				.field
					flex 1
					will-change flex
					transition border .25s, box-shadow .25s, flex .25s
					&:not(:first-of-type)
						margin-left .5rem
					&:hover
					&:focus
						flex 1.5
				button
					margin-right .5rem
			.textarea
				position relative
				.field
					display block
					min-height 10rem
					min-width 100%
			> select
				width 100%
			input[type="file"]
				position absolute
				visibility hidden
		select[name] // flag and flash tag selecter
			margin-top .5rem // normally we only apply bottom margin, but this only happens on 3 boards
	
	// when shift_js is enabled, switch the font for the qr and the button
	// https://en.wikipedia.org/wiki/Shift_JIS_art
	#sjis-toggle,
	#qr.sjis-preview textarea
		font 16px/1 "IPAMonaPGothic", "Mona", "MS PGothic", monospace
	
	// make it visually obvious that the sjis mode is on. overrides default button styles
	#qr.sjis-preview #sjis-toggle
		background-color ss21orange
	
	// preserves white space when previewing tex on /sci/
	#tex-preview
		white-space pre-line
	
	// the subset 'E' in 'TEX' looks weird
	#tex-preview-button
		sub
			margin-right .125em
			bottom -.5em
	
	.captcha-container
		display flex
		flex-wrap wrap
		justify-content center
		gap .5rem
		margin auto
		width auto i
	
	// XXX: july 2021: new captcha system
	#t-resp
		font inherit i
		font-family var(--font-monospace) i
		width auto i
		height 42px i
		margin 0 i
		display inline-block
		background inherit
		width calc(50% - 0.5rem) i
		padding .5rem .75rem i
		border 1px solid alpha(ss21OppColour, .33)
		borderRadius()
		transition border .25s, box-shadow .25s
		&:hover
			border-color alpha(ss21OppColour, .8)
		&:focus
			border-color ss21primary
			box-shadow 0 0 0 .2rem alpha(ss21primary, .25)
	
	#t-slider[style*="vis"]
		display none
	
	#t-frame
		height auto i
	
	if ss21readingMode == ss21dark
		#t-cnt
			filter invert(.935)
	
	// XXX: https://github.com/ccd0/4chan-x/issues/3196
	#t-bg
		filter sepia(100%) saturate(500%) hue-rotate(90deg) brightness(100%) contrast(100%)
	
	#t-load
		font-size .875rem i
		padding 0 .75rem i
		margin 0 i
		width calc(50% - 0.5rem) i
		height 42px i
	
	// 4chan captcha solver support
	#t-auto-solve
		font-size inherit i
		padding 0 .75rem i
		margin 0 i
		height auto i
	
	#t-cnt
		margin-top 0 i
	
	#t-msg:not(:empty)
		position relative i
	
	// hides the "?" button next to the captcha input
	#t-help
		display none i
	
	.captcha-counter
		text-align center
	
	// support noscript recaptcha
	#qr.captcha-v2 #qr-captcha-iframe
		width 302px
		height 423px
		display block
		margin auto
	
	// XXX2024: super laggy css, because of the :has([style*="image"]) selector
	// keeping here for memory sake. sidedish now adds a class which should improve performance
	@css {
		@scope (.captcha-root) {
			/* Hide the captcha container when the captcha hasn't rendered/deloads */
			/*
			#t-cnt:has(#t-fg:not([style*="image"])) {
				display: none !important;
			}
			*/
			/* Makes the 'Get Captcha' button full width until there is a captcha to input */
			/*
			.captcha-container:has(#t-fg:not([style*="image"])) {
				#t-load {
					width: 100% !important;
				}
				#t-resp {
					display: none !important;
				}
			}
			*/
			/* If a user has the auto-solver, make each element space evenly */
			/*
			.captcha-container:has(#t-auto-solve:not([style*="none"])) :is(#t-load, #t-resp, #t-auto-solve) {
				width: calc(33% - 0.5rem) !important;
			}
			*/
			/*
			:scope:not(.captcha-loaded) {
				#t-load {
					width: 100% !important;
				}
				#t-resp, #t-cnt {
					display: none !important;
				}
			}*/
		}
	}
	
	// anti-spam styling added to /biz/ first, then /v/, and now all of 4chan
	#t-msg
		top 0 i
		a
			color var(--primary)
	
	// oekaki support for /i/ and /ic/ mainly, but also for any board
	// XXX: find a better way to present the width/height input
	// XXX: make input[type="color"] look potentially nicer
	.oekaki
		display flex
		align-items stretch
		&.has-file
			display none
		#qr-draw-button
			width 15%
		& > label
			display flex
			flex 1 1 auto
			align-items center
			min-width 0
			margin-left .5rem
			& > span
				flex 1 1 auto
				min-width 0
				flex-wrap nowrap
			& > input
				flex 1 1 auto
				width 3rem
				margin-left .25rem
		& > .oekaki-bg
			position relative
			display inline-flex
			align-items center
			justify-content center
			width 15%
			margin-left .5rem
			& input[name="oekaki-bg"]
				position absolute
				top 1px
				left 1px
				&:not(:checked) + input[name="oekaki-bgcolor"]
					visibility hidden // if no background for your drawing is needed, hide the background colour option
	
	input[name="oekaki-bgcolor"]
		padding 0
		border 0
		borderRadius()
		background var(--grey-500)
		height 100%
		width 100%
	
	// file handler for the qr
	#file-n-submit
		display flex
		height calc(2.5rem + 2px) // technically each row of the qr is this height
		//align-items stretch
		input[type="submit"]
			icon-style()
			//width 10%
			margin-left .25rem
			background-color ss21green
			/*
			&:focus
				box-shadow 0 0 0 .25rem alpha(lighten(ss21primary, 50%), .25)
			if ss21buttonStyle == 1
				background-color ss21green
				tc(ss21green, high)
				z-depth(2)
				&:hover
					background-color mix(#fff, @background-color, 10%)
				&:active
					background-color mix(#fff, @background-color, 12%)
					transform translateY(1px)
			else if ss21buttonStyle == 2
				color ss21green
				background transparent
				border 1px solid ss21green
				&:hover
					background-color rgba(ss21green, 0.1)
				&:active
					background-color rgba(ss21green, 0.25)
					transform translateY(1px)
			else if ss21buttonStyle == 3
				color ss21green
				background transparent
				&:hover
					background-color rgba(ss21green, 0.1)
				&:active
					background-color rgba(ss21green, 0.25)
					transform translateY(1px)
	// XXX: make submit button look better
	*/
	// <input type="submit" value="Dead" disabled="">
	#file-n-submit input[type="submit"][value="Dead"]
		background-color var(--grey-500)
	
	#qr-file-button
		icon-style()
		//width 10%
		margin-right .25rem
		&:focus
			box-shadow 0 0 0 .25rem alpha(lighten(ss21primary, 50%), .25)
	
	// this element is given the `.field` class despite not being one, so we can
	// use the handy `all: unset` to help us out and reset it
	#qr-filename-container
		all unset
		flex 1
		min-width 0
		display flex
		align-items center
		position relative
	
	// no file selected text
	#qr-no-file
		color var(--text-secondary-on-background)
		flex 1
		min-width 0
		overflow hidden
		text-overflow ellipsis
		white-space nowrap
		cursor pointer // look, only because you can click it
	
	#file-n-submit.has-file #qr-no-file
		display none
	
	// file selected, also editable
	#qr-filename
		all unset
		display none
		flex 1
		min-width 0
		overflow hidden
		text-overflow ellipsis
		white-space nowrap
		margin-right .25rem
		//&:focus
		// min-width 100% // XXX: something to think about for long filenames
	
	#file-n-submit.has-file #qr-filename
		display inline-block
	
	#qr:not(.has-spoiler) #qr-spoiler-label, // only show spoiler image option on boards that support it
	#file-n-submit:not(.has-file) #qr-spoiler-label // only show spoiler option when a file is uploaded
		display none
	
	// 4chan xt 2.7.0
	#qr-randomize::after
		content ss21iconFont == 1 ? '\F544' : 'shuffle'
		icon-style()
	#qr-restore-name::after
		content ss21iconFont == 1 ? '\F292' : 'history'
		icon-style()
	
	#file-n-submit:not(.has-file)
		#qr-randomize,
		#qr-restore-name
			display none
	
	.row
		display contents
		a
			display inline-flex
	
	#qr-spoiler-label
		display inline-flex
		align-items center
		#qr-file-spoiler
			position absolute
			opacity 0
			z-index 1
			margin 0
			&:checked + .checkbox-letter::after
				tc(rgba(ss21BackgroundElevated), high)
		.checkbox-letter
			font-size 0
			display inline-block
			&::after
				tc(rgba(ss21BackgroundElevated), low)
				transition color .25s
			&:hover::after
				tc(rgba(ss21BackgroundElevated), medium)
	
	#qr-filename-container
		& > a
			display inline-flex
			align-items center
			margin-right .25rem
			cursor pointer
			.fa
				display inline-flex
				align-items center
				&::after
					tc(rgba(ss21BackgroundElevated), low)
					transition color .25s
				&:hover::after
					tc(rgba(ss21BackgroundElevated), medium)
	
	#qr-filename-container #qr-filerm
		.fa-times-circle,
		.remove
			&::after
				color rgba(ss21red, .54)
			&:hover::after
				color rgba(ss21red, .89)
	
	#custom-cooldown-button:not(.disabled) .fa-clock-o::after,
	#qr.dump #dump-button .fa-plus-square::after,
	#qr:has(.oekaki:not([hidden])) .fa-edit::after
		tc(rgba(ss21BackgroundElevated), high)
	
	:root.fourchan-xt #file-n-submit
		a
			display inline-flex
			align-items center
			cursor pointer
			&::after
				tc(rgba(ss21BackgroundElevated), low)
				transition color .25s
			&:hover::after
				tc(rgba(ss21BackgroundElevated), medium)
	
	:root.fourchan-xt #file-n-submit #qr-filerm
		&::after
			color rgba(ss21red, .54)
		&:hover::after
			color rgba(ss21red, .89)
	
	:root.fourchan-xt #custom-cooldown-button:not(.disabled)::after,
	:root.fourchan-xt #qr.dump #dump-button::after,
	:root.fourchan-xt #qr:has(.oekaki:not([hidden])) #qr-oekaki-button::after
		tc(rgba(ss21BackgroundElevated), high)
	
	#char-count
		font-size .75rem
		position absolute
		pointer-events none
		right 1.5rem
		bottom .25rem
	
	// qr dump list ui
	// XXX: holy smokes this looks like ASS
	#dump-list .qr-preview:only-of-type > .remove, // if there's only post in the dump list, don't show the option to remove it
	.qr-preview:not(.has-file) label, // if a post has no file attached, don't show the option to spoiler it
	#qr:not(.has-spoiler) .qr-preview-spoiler // only show the spoiler option if the board supports it
		display none
	
	#qr.dump #dump-list-container
		display block // only display the dump list when enabled
		position relative
		background-color rgba(0, 0, 0, .33)
		borderRadius()
	
	#dump-list
		display flex
		flex-wrap wrap
		padding .25rem
		gap .25rem
		max-height 14rem
		overflow auto
	/*
	#qr.dump #dump-list-container
		display block // only display the dump list when enabled
		position relative
		overflow-y hidden
		margin-bottom .5rem
		background-color rgba(0, 0, 0, .33)
		borderRadius()
	
	#dump-list
		overflow auto
		white-space nowrap
		display flex
		flex-wrap wrap
		min-height 8.5rem // height of 2 previews
		max-height 10rem // height of 3 previews
		padding .25rem
	*/
	.qr-preview
		font-size .75rem
		counter-increment thumbnails
		cursor move // grab?
		//display block
		height 7rem
		width 7rem
		padding .25rem
		//margin .25rem
		opacity .6
		overflow hidden
		position relative
		background-size cover
		white-space normal // reverses what is on dump list, which could also go?
		flex none
		transition opacity .25s, transform .25s
		borderRadius()
		background-color rgba(0,0,0,.2)
		&::before
			content: counter(thumbnails)
			position absolute
			display inline-flex
			align-items center
			justify-content center
			height 1rem
			width 1rem
			border-radius 50%
			top 1px
			right 1px
			font-size .75rem
			background-color rgba(33, 33, 33, .5)
			tc(@background-color, high)
		&:hover
			opacity .87
		&:focus
			opacity .87
			//cursor grabbing // XXX: doesn't maintain this grabbing cursor
		&#selected
			opacity 1
		&.drag
			transform scale(.9)
		&.over
			transform scale(1.05)
			z-index 1
			border 1px dashed rgba(255, 255, 255, .87)
		& > .remove
			display inline-flex
			cursor pointer
			color ss21red
		span
			text-shadow 0 0 5px #000
	
	c(a) {s(replace(",", "\,", a))}
	has(a)   {s(":has(%s)",   c(a))}
	
	.qr-preview-spoiler
		font-size 0
		display inline
		&::after
			tc(#000, medium)
			transition color .25s
		&:hover::after
			tc(#000, high)
		&{has("input:checked")}::after
			color var(--secondary)
		input
			display none
	
	#add-post
		font-size 0
		position absolute
		right 1rem
		bottom 0
		&::after
			font-size 3rem
			color ss21blue
	
	// 4CHANX: settings
	// easier styling thanks to https://github.com/ccd0/4chan-x/pull/2322
	#overlay
		position fixed
		display flex
		align-items center
		justify-content center
		top 0
		left 0
		width 100%
		height 100%
		z-index 20
		background-color rgba(33, 33, 33, .75) // XXX: overlay darkness and alpha needs to be consistent
	
	// the settings itself contains elements that need to be rebooted again
	// due to the way they are used and laid out
	#fourchanx-settings
		background-color var(--background-primary)
		width 75rem
		max-width 90%
		height 90vh
		margin auto
		display flex
		flex-direction column
		contain paint
		z-depth(24)
		borderRadius()
		nav
			font-size 0
			background-color ss21primary
			tc(@background-color, medium)
			display flex
			padding 0 1.5rem
			text-transform lowercase
			.sections-list,
			.credits
				display flex // XXX: needs better overflow support on small resolutions
			// this `p` element is used to spit out the import/export results of 4chan x
			// settings. we conveniently use it to space out the settings nav links
			.imp-exp-result
				flex 1 0 2rem
				margin 0 // unset the margin given in the reboot
			& a:not([download])
				font-size 1rem
				word-break normal // one of the few places we don't want this
				display inline-flex
				align-items center
				height 3rem
				padding 0 .5rem
				cursor pointer
				position relative
				&:hover
					tc(ss21primary, high)
				&:not([download]).tab-selected
					tc(ss21primary, high)
					&::after
						display block
				&:not(.close)::after
					display none
					position absolute
					bottom 0
					left 0
					width 100%
					height 2px
					content ''
					pointer-events none
					background-color var(--secondary)
			a[href="https://www.4chan-x.net/"] // hides the link to 4chan x homepage, nobody actually goes there?
				display none i
		fieldset
			padding 0
			//border 1px solid var(--text-hint-on-background)
			//borderRadius()
			//border-bottom 1px solid var(--text-hint-on-background)
			margin-bottom 1rem
			&:last-of-type
				border 0
				margin 0
		legend
			padding 0
			font-size 1.25rem
			font-weight 700
			text-transform uppercase
		table // keybinds table
			margin auto
		textarea
			width 100%
		.field
			font-family var(--font-monospace)
		code,
		kbd
			font-size .875em
			if ss21readingMode == ss21dark
				color #f5f7ff
				background-color #202746
			else if ss21readingMode == ss21light
				color #202746
				background-color #f5f7ff
			borderRadius()
			padding .2rem .4rem
	
	@css {
		#fourchanx-settings {
			opacity: 1;
		}
		@starting-style {
			#fourchanx-settings {
				opacity: 0;
			}
		}
	}
	
	:root.fourchan-xt .credits a[href="https://github.com/TuxedoTako/4chan-xt"]
		display none i
	
	if ss21navRail == 1
		@css {
			@keyframes slideIn {
				from {
					transform: translateX(-100%);
				}
				to {
					transform: translateX(0);
				}
			}
			@keyframes slideOut {
				from {
					transform: translateX(0);
				}
				to {
					transform: translateX(-100%);
				}
			}
		}
		#overlay:not(.media-preview)
			align-items initial
			justify-content initial
		#fourchanx-settings
			flex-direction row
			margin initial
			block-size 100dvh
			border-radius 0
			transition all .25s
			animation slideIn .25s;
			&.active
				animation slideOut .25s;
			nav
				flex-direction column
				padding .5rem .125rem
				overflow-y auto
				.sections-list,
				.credits
					flex-direction inherit
					gap .25rem
					a
						display inline-flex
						flex-direction column
						align-items center
						justify-content center
						font-size .75rem
						min-width 4rem
						min-height 3rem
				a::before
					@extends $icons
					// added to make it m3
					border-radius 32rem
					padding .25rem 1rem
					transition all .25s
					font-variation-settings "FILL" 0
		#fourchanx-settings nav
			a:hover::before,
			.tab-selected::before
				padding .25rem 1.5rem
				background-color shade(ss21primary, 15%)
				if ss21iconFont == 2
					font-variation-settings "FILL" 1
			.tab-selected::after
				display none i
			.tab-main::before
				content ss21iconFont == 1 ? '\F423' : 'home'
			.tab-filter::before
				content ss21iconFont == 1 ? '\F789' : 'tune'
			.tab-sauce::before
				content ss21iconFont == 1 ? '\F18F' : 'image_search'
			.tab-advanced::before
				content ss21iconFont == 1 ? '\F3E5' : 'settings'
			.tab-keybinds::before
				content ss21iconFont == 1 ? '\F451' : 'keyboard_alt'
			.tab-ss21::before
				content ss21iconFont == 1 ? '\F617' : 'waves'
			.export::before
				content ss21iconFont == 1 ? '\F603' : 'file_upload'
			.import::before
				content ss21iconFont == 1 ? '\F30A' : 'file_download'
			.reset::before
				content ss21iconFont == 1 ? '\F292' : 'history'
			a[href$="CHANGELOG.md"]::before
				content ss21iconFont == 1 ? '\F2C6' : 'commit'
			a[href$="issues"]::before
				content ss21iconFont == 1 ? '\F3CC' : 'report'
			.fa-times::before,
			.close::after
				content ss21iconFont == 1 ? '\F659' : 'menu_open'
			.fa-times::after
				display none
	
	.section-main a,
	.section-filter a,
	.section-advanced a
		color ss21primary
		&:hover
			color shade(ss21primary, 10%)
	
	@media (max-width: 60rem)
		#fourchanx-settings nav a:not([download])
			font-size .75rem
	
	/**
	 * since `.unscroll` isn't added to `body`, we can make use of some bleeding edge
	 * CSS, in the form of `overscroll-behavior`, which means scrolling is contained
	 * to the settings and will not effect the entire document
	 * https://caniuse.com/#feat=css-overscroll-behavior
	 */
	
	.section-container
		flex 1
		overflow auto
		overscroll-behavior contain
		padding 1rem
		position relative
	
	.section-main
		div[data-name]
			padding .25rem
			borderRadius()
			transition background-color .25s
			&:hover
				background-color alpha(shade(ss21BackgroundElevated, 10%), .33)
		input[type="checkbox"]
			float left
			margin-top 12px
			margin-right 12px
		.description
			font-size .875rem
			color var(--text-hint-on-background)
			padding-left 32px
			display block
		.suboption-list
			margin-top .25rem
			margin-left .5rem
		div[data-name="Stubs"] + div
			margin-top .5rem
		div[data-name="Pass Link"] + p
			margin .5rem 0
		button + .description
			padding-left 0
			margin-top .5rem
			margin-left .5rem
			display inline-block
	
	// filter section
	.section-filter
		ul
			padding 0
			margin 0
		li
			margin 0 1.5rem
		select
			width 100%
			margin-bottom 1rem
		textarea
			min-height 70vh
	
	// sauce section
	@css {
		@scope (.section-sauce) {
			#sauce-doc {
				margin-block-end: 1rem;
			}
			ul {
				padding: 0;
			}
			li {
				margin: 0 1.5rem;
			}
			label[for] {
				display: none;
			}
			textarea {
				min-block-size: 10rlh;
				field-sizing: content;
			}
		}
	}
	/*
	.section-sauce
		ul
			padding 0
		li
			margin 0 1.5rem .25rem
		textarea
			min-height 70vh
	*/
	/*
	#sauce-doc-expand:not(:checked) ~ #sauce-doc
		max-height 9rem
		overflow auto
	
	#sauce-doc > label
		float right
	
	#sauce-doc
		margin-bottom 1rem
	*/
	.favicon-preview
		display inline-flex
		flex-direction row
		gap .25rem
		margin-left .25rem
	
	// keybinds section
	.section-keybinds
		div
			margin-bottom .5rem
	
	// advanced section
	// XXX: needs a lot of small tweaks to improve visual/grid consistency + vertical rhythm
	.section-advanced
		.note
			font-size .875rem
		textarea
			min-height 7.5rem
		fieldset:first-child
			position relative
		#archive-table + br
			display none
		.archive-cell
			min-width 10rem
		.note
			color var(--text-secondary-on-background)
		.file-info-preview
			font-size .75rem
			display flex
			align-items center
			gap .25rem
			.fa
				display contents
				&::after
					font-size 1rem
					inline-size .75rem
	#archive-board-select
		position absolute
		top -2.5rem
		left 7rem
		width 7.5rem
	
	// XXX: quick fix for oneechan (which should not be used anyway)
	#sauce-doc-expand + .riceCheck
		display none
	
	// disabled features
	fieldset:has(.warning:not([hidden]))
		opacity .5
	
	// thread updater and stats. ideally, leave these in the header. but if
	// you prefer it to be floating and fixed, support that too
	#updater
		tc(ss21primary, medium)
	
	// at some point, 4chan stopped tracking ips, so hide it
	// XXX: still works on ID'd boards, duh
	#ip-count
		display none
	// but, because of that, there's a stray slash. so we gotta bit more work to do
	#thread-stats
		font-size 0
		span
			font-size .8rem
			tc(ss21primary, medium)
			&:not(:last-child)::after
				content ' / '
				tc(ss21primary, low)
		.warning // have to re-mention this here due to specificty
			color ss21red
	
	:root.float #updater,
	:root.float #thread-stats
		position fixed
		z-index 5
		background-color ss21primary
		display inline-flex
		align-items center
		justify-content center
		//padding .5rem
		borderRadius()
		z-depth(4)
		//height 1.75rem
	
	:root.float
		#thread-stats > .move,
		#updater
			padding .5rem
	
	// make the draggable area a little bigger than the updater itself
	#updater > .move
		position absolute
		z-index -1
		inset -.125rem
	
	// make these appear clickable
	#update-timer,
	#page-count
		cursor pointer
	
	// give `pointer-events: none` so that the element can be dragged around
	// without selecting text
	:root.float #thread-stats > .move > span:not(#page-count)
		pointer-events none
	
	.new
		color ss21green
		margin-right .5rem
	
	// we go a little overboard with the micro-interaction here, but whatever;
	// adds a "ripple" effect when watching a thread
	// XXX: both the heart and star icon don't actually fill up the entire 24px
	// we allocate for icons, which throws off visual consistency by adding a "gap"
	button.watch-thread-link
		all unset
		display inline-flex
		position relative
		opacity .54
		//will-change opacity
		transition opacity .25s
		cursor pointer
	
	.watch-thread-link
		display inline-flex
		position relative
		//margin-right .25rem
		opacity .54
		//will-change opacity
		transition opacity .25s
		&:hover
			opacity .87
		&::before
			content ''
			position absolute
			opacity 0
			pointer-events none
			border-radius 50%
			if ss21watchButtonIcon == 1
				background-color ss21red
			if ss21watchButtonIcon == 2
				background-color ss21orange
			height 1.5rem
			width 1.5rem
			transform scale(.5)
			transform-origin 50% 50%
			//will-change transform, opacity
			transition transform .25s, opacity .25s
		&:active::before
			opacity .25
			transform scale(1.5)
		&::after
			font-size 24px
	
	if ss21watchButton == 2
		.watch-thread-link
			position absolute
			top -1rem
			right 12.5rem
			background-color ss21primary
			border-radius 100%
			padding .25rem
			margin 0
			opacity 0
			z-depth(2)
			pointer-events none
		.opContainer:hover .watch-thread-link
			opacity 1
			pointer-events auto
	
	// thread watcher
	:root.fixed-watcher
		#thread-watcher
			position fixed
			z-index 15
		#watched-threads
			max-height 70vh
	
	#thread-watcher
		position absolute
		z-index 5
		background-color var(--background-primary)
		white-space nowrap
		min-width 20rem
		z-depth(8)
		borderRadius()
		& > .move
			text-transform lowercase
			background-color ss21primary
			tc(@background-color, high)
			display flex
			align-items center
			padding 0 1.5rem
			height 3rem
			border-top-left-radius 4px
			border-top-right-radius 4px
			& > a
				tc(ss21primary, medium)
				transition color .25s
				&:hover
					tc(ss21primary, high)
			& > .refresh
				display inline-flex
				align-items center
				margin-left .5rem
			& > .menu-button
				display inline-flex
				min-width 2rem
			& > .close
				font-size 0
		#menu
			text-transform initial // because of the lowercase aesthetic, the menu is affected
	
	#thread-watcher
		display block
		opacity 1
		transform scale(1)
		transition display .25s, opacity .25s, transform .25s
		transition-behavior allow-discrete
	
	@css {
		@starting-style {
			#thread-watcher {
				display: block;
				opacity: 0;
				transform: scale(.75);
			}
		}
	}
	
	#thread-watcher[hidden]
		display none
		opacity 0
		transform scale(.75)
	
	// used to display the progress of the thread watcher checking the status of threads,
	// but we use it to stretch the distance between the icons
	#watcher-status
		flex 1
		text-align center
		pointer-events none // this is so you can still drag the window around while it's loading
	
	#watched-threads
		overflow hidden auto
		&:empty::after
			content 'No threads to display.'
			display inline-flex
			align-items center
			justify-content center
			width 100%
			height 3rem
		&:not(:hover)
			max-height 12rem
			overflow-y hidden
		& > div
			padding 0 1rem
			height 3rem
			display flex
			align-items center
			&:nth-of-type(odd)
				if ss21readingMode == ss21light
					background-color darken(ss21BackgroundElevated, 3%)
				else if ss21readingMode == ss21dark
					background-color lighten(ss21BackgroundElevated, 6%)
		a:first-of-type,
		.fa-times
			display inline-flex
			margin-right .5rem
			color ss21red
			&::after
				opacity .6
				transition opacity .25s
			&:hover::after
				opacity .87
		.watcher-link
			display inline-flex
			flex-direction row
			max-width 25rem
		.watcher-page,
		.watcher-unread
			flex 0
			margin-right .25rem
		.watcher-title
			overflow hidden
			text-overflow ellipsis
			flex 1
		.current .watcher-title
			font-weight 700
		.dead-thread .watcher-link
			text-decoration line-through
			opacity .75
		.replies-unread .watcher-link
			color ss21blue
		.replies-quoting-you .watcher-link,
		.last-page .watcher-page
			color ss21red
	
	#watcher-link
		position relative
		&.replies-unread::before
			content ''
			display block
			height .5rem
			width .5rem
			background-color ss21red
			position absolute
			top 0
			left 0
			border-radius 100%
			visibility visible
		&.replies-quoting-you::after
			color invert(ss21primary)
	
	:root:not(.shortcut-icons)
		#watcher-link
			&.replies-unread
				text-decoration 2px underline ss21red
				text-underline-offset 2px
				&::before
					display none
			&.replies-quoting-you
				color invert(ss21primary)
	
	/*
	when "show site prefix" is enabled, and you have a thread watched on another domain,
	this is what it would look like. note that with it off, it gets rid of the letter
	before the board (/qa/ instead of k/qa/ in this example)
<div data-full-i-d="qa.101517" data-site-i-d="kissu.moe" data-page="3" class="replies-unread"><a class="fa fa-times" href="javascript:;"></a> <a href="https://kissu.moe/qa/res/101517.html" title="k/qa/ - Winter 2023 Seasonal Anime" class="watcher-link"><span class="watcher-page">[3]</span><span class="watcher-unread">(225)</span><span class="watcher-title">k/qa/ - Winter 2023 Seasonal Anime</span></a></div>
	*/
	
	// menus
	// styled based on:
	// https://www.material.io/components/menus/
	// https://twbs-bootstrap.netlify.com/docs/4.3/components/dropdowns/
	// https://www.carbondesignsystem.com/components/dropdown/code/
	.menu-button
		position relative
		display inline-flex
		align-items center
		justify-content center
		cursor pointer // sometimes it's a `span`, so we need this
		//anchor-name none
	
	/*
		XXX24: holy moley, so in a 500+ post thread, using anchor positioning seems to add
		2-3+ _SECONDS_ of lag on nearly every reaction. most likely because the menu
		is rendered on click, but still, this affects quote preview and other hover
		interactions...
		NOVEMBER: actually this was :has() being expensive, i need to revisit using anchor here
	*/
	
	#menu
		position fixed
		z-index 10
		z-depth(8)
		color ss21TextPrimary
		background-color ss21BackgroundElevated
		padding .25rem 0
		borderRadius()
		white-space nowrap
		outline none // XXX: doesn't need a focus style
		user-select none
		// XXX: don't know why, using flip-block crashes chrome
		display block
		opacity 1
		transform scale(1)
		transition display .25s, opacity .25s, transform .25s
		transition-behavior allow-discrete
	
	@css {
		@starting-style {
			#menu {
				display: block;
				opacity: 0;
				transform: scale(.75);
			}
		}
		@supports (position-anchor: --name) {
			.menu-button.active {
				anchor-name: --menu-button;
			}
			#menu {
				inset: auto !important;
				position-anchor: --menu-button;
				position-area: end;
				position-try-fallbacks: --menu-button-fallback1, --menu-button-fallback2, --menu-button-fallback3;
			}
		}
		@position-try --menu-button-fallback1 {
			position-area: block-end inline-start;
		}
		@position-try --menu-button-fallback2 {
			position-area: block-start inline-end;
		}
		@position-try --menu-button-fallback3 {
			position-area: start;
		}
	}
	
	.entry
		font-size .875rem
		display flex
		align-items center
		justify-content flex-start
		gap .75rem
		min-inline-size 10rem
		padding .25rem .75rem
		position relative // used to align submenus
		transition background-color .25s
		&:hover
			background-color ss21BackgroundColour
		&::after
			order -1 // puts any icons before the text
			color var(--text-hint-on-background)
			font-size 1em
		&.disabled
			opacity .3
			cursor not-allowed
		.field
			width auto
		&.has-shortcut-text
			justify-content space-between
		.shortcut-text
			color var(--text-hint-on-background)
			font-size 75%
		input[type="checkbox"]
			margin 0
			block-size 1em
			inline-size 1em
		input[type="range"] // volume slider on sound-enabled boards
			order 1
			max-width 5rem
		& > label
			display contents
		input[type="number"] // 'show last 1000 posts'
			padding 0 0 0 .25rem
			width 6.5ch
	
	.submenu
		display none
		position absolute
		left 100%
		z-index 10
		z-depth(8)
		background-color ss21BackgroundElevated
		padding .25rem 0
		borderRadius()
		margin-top calc(.25rem * -1) // counters the offset because of the top and bottom padding
		&[style*='m: 0']
			margin-top 0
			margin-bottom calc(.25rem * -1)
	
	// only show the submenu when its parent has hover/focus
	.focused > .submenu
		display block
	
	// moves the menu button of posts to the top right. reset for catalogue posts
	.post .menu-button
		position absolute
		top 2px // XXX: ew, hard coded pixels?
		right 1rem
	
	.post > .postInfo > .menu-button
		opacity 0
		will-change opacity
		transition opacity .25s
		&:focus
			opacity .6
	
	.post > .postInfo > .menu-button.active,
	.post:hover > .postInfo > .menu-button
		opacity .6
		&:hover
			opacity .87
	
	@css {
		@scope (#menu) {
			.shortcut {
				display: contents;
				color: var(--text-primary-on-background);
				a {
					font-size: .875rem !important;
					display: flex;
					gap: .75rem;
					min-inline-size: 10rem;
					padding: .25rem .75rem;
					color: inherit;
					&::after {
						order: -1;
						color: var(--text-hint-on-background) !important;
						font-size: 1em !important;
					}
				}
			}
			.icon--alt-text {
				display: block !important;
			}
		}
	}
	
	.catalog-thread[class*="thread-chip"] .catalog-post::before
		content ''
		font-size .75rem
		tc(ss21primary, high)
		background-color ss21primary
		borderRadius()
		padding 0 .25rem
		position absolute
		z-index 1
		top 0
		left 0
		transform translate(-.25rem, -.25rem)
		pointer-events none
	
	thread-chips = {
		waywt: 'WAYWT',
		girl: 'GRILL',
		edc: 'EDC',
		watch: 'WATCH',
		skin: 'SKIN',
		hair: 'HAIR',
		tattoo: 'TATTOO',
		fragrance: 'SMELL'
	}
	
	for thread, tag in thread-chips
		.catalog-thread.thread-chip--{thread} .catalog-post::before
			content tag
	
	if ss21postInfoFont == 1
		:root.fourchan-xt .is_thread .postContainer
			.hide-reply-button
				height auto
				top 2px
				right 2.25rem
			.hide-reply-button::after
			.menu-button::after
				font-size 1.25rem
	
	/**
	 * `#navlinks` is used to navigate to the next thread on the index, and to the
	 * top and bottom of the page within threads. not needed in catalogue mode, so it
	 * is hidden
	 */
	
	:root.catalog-mode #navlinks
		display none
	
	#navlinks
		position fixed
		z-index 10
		bottom 1rem
		right 1rem
		font-size 0
		color var(--text-secondary-on-primary)
		background-color ss21primary
		borderRadius()
		z-depth(4)
		overflow hidden
		&:not(:hover) // i find this visually annoying, so i think it should fade away
			opacity .5
			transition opacity 10s
		a:hover::after
			background-color darken(ss21primary, 15%)
			transition background-color .25s
	
	:root.bottom-header.fixed #navlinks
		top 1rem
		bottom auto
	
	.ss21--fit,
	#qr
		&:not(:hover, :focus-within)
			opacity .5
			transition opacity 10s
	
	// 4CHANX: embedding
	// if media is embedded, remove the un prefix from inside the post
	.embedder:not(.embedded) > span
		display none
	
	// https://stackoverflow.com/a/60803488/490291
	// XXX: potentially fix resize embedded content
	#embedding .media-embed
		clear both
		display flex
		padding 0
		margin 0
		resize both
		overflow hidden
		iframe
			flex-grow 1
			padding 0
			border 0
			margin 0
			width auto i
			height auto i
	
	// XXX: this should apply only to 4chan xt and when fxtwitter is enabled
	.postMessage .twitter-tweet
		color var(--text-primary-on-background) // this is because it embeds inside `.quote`
		p
			margin 0
		a
			display inline-block
	
	// 4CHANX: floating embed
	#embedding
		background-color var(--background-primary)
		position fixed
		z-index 10
		borderRadius()
		overflow hidden
		z-depth(8)
		&.empty
			display none
		& > div:first-child
			display flex
			align-items center
			font-size 0
			background-color ss21primary
			tc(ss21primary, high)
			padding 0 1.5rem
			height 3rem
		.move
			flex 1
			&::before
				content 'embedded content'
				font-size 1rem
		.jump
			margin-right .5rem
		.jump,
		.close
			opacity .6
			transition opacity .25s
			&:hover
				opacity .87
		audio
			min-width 30rem
	
	// 4CHANXT: fxtwitter embeds
	// first, set up some stylus variables as custom properties for later
	.fxt-card
		if ss21readingMode == ss21light
			--border-colour darken(ss21BackgroundElevated, 10%)
		else if ss21readingMode == ss21dark
			--border-colour lighten(ss21BackgroundElevated, 15%)
		--red ss21red
		--blue ss21blue
		--green ss21green
	@css {
		@scope (.fxt-card) {
			:scope {
				color: var(--text-primary-on-background);
				background-color: var(--background-primary);
				display: flex;
				flex-direction: column;
				gap: .25rem;
				padding: .5rem;
				border: 1px solid var(--border-colour);
				border-radius: .25rem;
				max-inline-size: 20rem;
			}
			.fxt-meta {
				display: flex;
				flex-direction: row;
				align-items: center;
				justify-content: space-between;
			}
			.fxt-meta_profile {
				display: flex;
				flex-direction: row;
				align-items: center;
				gap: .5rem;
				img {
					inline-size: 2rem;
					block-size: 2rem;
					border-radius: 100%;
				}
				.fxt-meta_author {
					display: flex;
					flex-direction: column;
				}
				.fxt-meta_author_username { font-weight: bold }
				.fxt-meta_author_account { font-size: .75rem; }
			}
			a { color: var(--primary) }
			.fxt-media_container:empty { display: none }
			.fxt-quote {
				padding: .5rem;
				border: 1px solid var(--border-colour);
				border-radius: .25rem;
			}
			.fxt-stats {
				font-size: .875rem;
				color: var(--text-hint-on-background);
				display: flex;
				flex-direction: column;
				gap: .25rem;
				.fxt-stats_meta {
					display: flex;
					flex-direction: row;
					justify-content: space-evenly;
					span {
						display: inline-flex;
						align-items: center;
						line-height: 1rem;
						&::after {
							font-size: 1rem;
							margin-inline-start: .25rem;
						}
					}
					.fxt-likes { color: var(--red) }
					.fxt-replies { color: var(--blue) }
					.fxt-reposts { color: var(--green) }
				}
			}
		}
	}
	
	// XXX: when using a quick reply persona, a `datalist` is generated. for
	// whatever reason, it uses this pseudo element
	#qr input[name="name"]::-webkit-calendar-picker-indicator
		padding 0
		opacity .87
		background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='1em' height='1em' viewBox='0 0 24 24'%3E%3Cpath fill='" + hsl(ss21OppColour) + "' d='m12 16.175l3.9-3.875q.275-.275.688-.288t.712.288q.275.275.275.7t-.275.7l-4.6 4.6q-.15.15-.325.213t-.375.062t-.375-.062t-.325-.213l-4.6-4.6q-.275-.275-.288-.687T6.7 12.3q.275-.275.7-.275t.7.275zm0-6L15.9 6.3q.275-.275.688-.287t.712.287q.275.275.275.7t-.275.7l-4.6 4.6q-.15.15-.325.213t-.375.062t-.375-.062t-.325-.213L6.7 7.7q-.275-.275-.288-.687T6.7 6.3q.275-.275.7-.275t.7.275z'/%3E%3C/svg%3E")
		display inline-block i
		inline-size 1em i
		vertical-align -.125em
	
	// 4CHANX: appchan's gallery mode, baked right into 4chan x
	// TODO: when you work out text colour, make the '/' in the counter lighter
	#a-gallery
		position fixed
		inset 0
		display flex
		flex-direction row
		background-color rgba(33, 33, 33, .75)
		z-index 50
	
	// container for images and controls
	.gal-viewport
		display flex
		flex-direction row
		align-items center
		justify-content center
		flex 1
		overflow hidden
		position relative
	
	// gallery controls
	.gal-buttons
		position absolute
		z-index 2
		display flex
		top 1rem
		right 1rem
		background-color rgba(0, 0, 0, .5)
		tc(@background-color, high)
		padding .5rem
		borderRadius()
		& > a
			display inline-flex
	
	.gal-labels
		position absolute
		z-index 2
		right 1rem
		bottom 1rem
		display flex
		flex-direction column
		align-items flex-end
	
	.gal-count,
	.gal-name,
	.gal-sauce
		margin-top .5rem
		background-color rgba(0, 0, 0, .5)
		tc(@background-color, high)
		line-height 1
		padding .5rem
		borderRadius()
	
	.gal-sauce:empty
		display none
	
	// hide the stop icon if not sliding, hide the play if sliding
	.gal-buttons.gal-playing > .gal-start,
	.gal-buttons:not(.gal-playing) > .gal-stop
		display none
	
	.gal-close
		font-size 0
	
	// the image, video, or pdf
	.gal-image
		flex 1
		display flex
		align-items center
		justify-content center
		overflow hidden
		margin 1rem
		position relative
		& > a
			display block
			z-index 1
	
	// make sure it takes up the whole viewport
	:root.gal-pdf .gal-image a,
	.gal-image iframe
		width 100%
		height 100%
	// XXX: i think something has changed, this needs to be adjusted
	// and, either stretch to it or fit to it
	:root.gal-fit-width .gal-image :is(img, video)
		max-width 100%
	
	:root.gal-fit-height .gal-image :is(img, video)
		max-height 85vh
	
	// previous and next buttons for gallery
	.gal-prev
		position absolute
		z-index 0
		left 0
		width 25%
		height 100%
		cursor url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='48' height='48' viewBox='0 0 24 24'%3E%3Cpath fill='rgba(255, 255, 255, .87)' d='M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z'/%3E%3C/svg%3E") 12 24, pointer
		&:hover
			background-image linear-gradient(to right, rgba(33, 33, 33, 1), rgba(0, 0, 0, 0))
	
	.gal-next
		position absolute
		z-index 0
		right 0
		width 25%
		height 100%
		cursor url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='48' height='48' viewBox='0 0 24 24'%3E%3Cpath fill='rgba(255, 255, 255, .87)' d='M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z'/%3E%3C/svg%3E") 36 24, pointer
		&:hover
			background-image linear-gradient(to left, rgba(33, 33, 33, 1), rgba(0, 0, 0, 0))
	
	// container for thumbnails
	// hide it if enabled
	:root.gal-hide-thumbnails .gal-thumbnails
		display none
	
	.gal-thumbnails
		display flex
		flex-direction column
		align-items center
		overflow-y auto
		background-color rgba(33, 33, 33, .25)
		border-left 1px solid tint(ss21BackgroundElevated, 10%)
	
	.gal-thumb
		display block
		max-width 10rem
		max-width 10rem
		padding .25rem
		transition background-color .25s
		position relative
		&:hover
			background-color alpha(invert(ss21primary), .25)
	
	.gal-thumb::after
		position absolute
		font-size .75rem
		text-shadow 0 0 2px #000
		inset-inline-start 6px
		inset-block-end 1px
	.gal-thumb[href$="gif"]::after
		content 'gif'
	.gal-thumb[href$="webm"]::after
		content 'webm'
	.gal-thumb[href$="mp4"]::after
		content 'mp4'
	.gal-thumb[href$="png"]::after
		content 'png'
	.gal-thumb[href$="jpg"]::after
		content 'jpg'
	
	.gal-highlight
		background-color alpha(invert(ss21primary), .75)
	
	/*
	 * 4CHANXT 2.15.0 support
	 * Export settings dialogue box
	 */
	#export-dialog
		position fixed
		z-index 22
		background-color var(--background-primary)
		z-depth(24)
		borderRadius()
	
	// SIDEDISH: support for the board drawer added by sidedish
	.ss21--board-drawer-background
		position fixed
		overflow hidden
		contain strict
		width 100%
		height 100%
		top 0
		left 0
		pointer-events none
		z-index 99
		&::before
			content ''
			display block
			will-change opacity
			background-color rgba(0, 0, 0, .6)
			position absolute
			top 0
			left 0
			height 100%
			width 100%
			opacity 0
			transition opacity .25s
	.drawer-open
		pointer-events auto
		.ss21--board-drawer
			transform translateX(0)
		&::before
			opacity 1
	.ss21--board-drawer
		width 20rem
		left 0
		right initial
		height 100%
		background-color ss21BackgroundElevated
		display flex
		position absolute
		flex-direction column
		//will-change transform
		transform translateX(-100%)
		transition transform .25s
		overflow-y scroll
		overscroll-behavior contain
	.board-list-entry
		tc(ss21BackgroundElevated, high)
		display block
		height 3rem
		line-height 3
		padding 0 .5rem
		margin .5rem .5rem 0
		transition color .25s, background-color .25s
		borderRadius()
		&:last-child
			margin-bottom .5rem
		&.board--ws
			//background-color rgba(#d6daf0, .6)
			&:hover
				color #000
				background-color darken(#d6daf0, 5%)
		&.board--nws
			//background-color rgba(#f0e0d6, .6)
			&:hover
				color #800
				background-color darken(#f0e0d6, 5%)
	
	// SIDEDISH: convert imperial (a.k.a. inferior) to metric
	.ss21--fit
		position fixed
		right 1rem
		z-index 10
		background-color ss21BackgroundElevated
		text-align right
		padding .5rem
		z-depth(4)
		borderRadius()
		transform-origin top right
		transition all .25s
		&:hover
			transform scale(2)
		&.ss21--fit-weight
			top 10rem
			&:hover + .ss21--fit-height
				top 19.5rem
		&.ss21--fit-height
			top 15rem
		.ss21--fit-input
			padding 0
			borderRadius()
			margin-bottom .25rem
			background none
			text-align right
			width 5ch
			border 1px solid alpha(ss21OppColour, .33)
			transition border .25s, box-shadow .25s
			&:hover
				border-color alpha(ss21OppColour, .8)
			&:focus
				border-color ss21primary
				box-shadow 0 0 0 .2rem alpha(ss21primary, .25)
		.ss21--fit-unit
			color var(--text-hint-on-background)
			margin-left .5ch
	
	// april fools 2020 support
	.xa20e::after
		font-size 18px
		line-height 1em
	.xa205 .xa20e::after
		content '☣️'
	.xa209 .xa20e::after
		content '😂'
	.xa202 .post
		box-shadow inset 0 0 10px 0 #26D7525E
	.xa203 .post
		box-shadow inset 0 0 25px 2px #26D75273
	.xa204 .post
		box-shadow inset 0 0 35px 6px #26D752B3
	.xa205 .post
		box-shadow inset 0 0 50px 12px #26D752
	#xa20m
		position fixed
		bottom 0
		z-index 15
		color #fff
		padding .5rem 0
		background-color #C41E3A
		text-shadow 0 1px rgba(0, 0, 0, 0.5)
	
	// halloween 2020 support
	#skellington
		display block i
		position fixed
		right 0
		bottom 0
		pointer-events none
		opacity .87
		&.topskel
			transform rotate(180deg)
			bottom auto
			top 0
	
	// 2021 april fools support
	.xa21-notice
		display block i
		text-align center
		margin-top 1rem
	
	.is_index .xa21-notice
		margin 0 0 2rem 0
	
	.rake-btn
		height 24px
		margin-left .5rem
	
	.rake-btn::after
		content 'brush' // XXX: reduced to just the icon name to save lines
	
	// 2023 april fools support
	if ss21readingMode == ss21dark
		.xa23i
			filter invert(1)
	
	// 2023 merry christmas revert. you still need to disable:
	// https://s.4cdn.org/js/snow.js
	#js-snowfield
		display none i
	.boardBanner, #delform, .navLinksBot.desktop
		padding-top 0
		border 0
		border-image none
	
	if ss21tableView == 1
		:root.all-pages-mode
			.postContainer
				margin 0
				display grid
			.post
				display grid
				grid-template-areas "thumbnail subject comment details"
				grid-auto-flow column
				grid-template-columns 64px 20ch 1fr 1fr
				grid-template-rows 1fr
				background-color initial
				border-radius initial
			.file
				all unset
				grid-column thumbnail
				aspect-ratio 1 / 1
				overflow hidden
				.fileThumb
					all unset
					overflow hidden
				.fileThumb img
					height 100% i
					width initial i
					object-fit cover
				.fileText
					display none
			.postInfo
				all unset
				*:not(.subject)
					display none
			.postMessage
				max-height 3rlh
				overflow hidden
				padding 0
				grid-column span 2
			.summary:not(.preview-summary)
				display none
			.preview-summary
				all unset
				position absolute
				font-size .75rem
				right 0
				bottom 0
			.container
				display none
			.file--tall .fileThumb img
				height initial i
				width 100% i
				object-fit contain
	
	// XXX: archive and /f/ `table` support
	// fun fact, the archive has about 10,000 entries displayed at any one time
	// in the archive table, `.teaser-col` can contain the subject (`b`), `.quote`,
	// or a `wbr` which breaks links
	.is_archive,
	.board_f.is_index
		.board
			max-width none
	
	.flashListing
		max-width 100%
		margin 1rem auto
		position relative
		vertical-align top
		word-break normal
		background-color var(--background-primary)
		td,
		th
			padding .25rem
			border-bottom 1px solid var(--text-hint-on-background)
		.postblock
			background-color ss21primary
			font-weight 700
			tc(@background-color, high)
		tbody
			vertical-align inherit
		.subject::after
			display none
		.file-col
			font-size 0
			a::after
				content attr(title)
				font-size 1rem
				color ss21primary
		.highlightPost
			background-color mix(ss21primary, #1f1f1f, 10%)
	
	/*
	 * 4chan xt 2.24 introduced a scroll marker for (you) posts
	 */
	.scroll-marker-container
		z-index 10
		position fixed
		top calc(var(--headerBar-height) + .25rem)
		right 0
		width 1rem
		height 100dvh
		background-image linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, .2))
		pointer-events none
		user-select none
		.post-scroll-marker
			--main-color var(--mdc-tertiary)
			all unset
			position absolute
			background-color var(--main-color)
			top calc(var(--top) * 1vh)
			right -.5rem
			inline-size 1rem
			border-radius 16px
			block-size calc(var(--height) * 1vh)
			pointer-events auto
			cursor pointer
			&:hover
				background-color oklch(from var(--main-color) .7 c h)
			&.you-scroll-marker
				--main-color var(--mdc-inversePrimary)
	/*
	.post-scroll-marker {
		all unset
		border: none;
		padding: 0;
		position: fixed;
		right: -5px;
		background-color: red;
		border-radius: 3px;
		width: 10px;
		min-height: 5px;
		top: calc(var(--top) * 1vh);
		height: calc(var(--height) * 1vh);
	}
	.post-scroll-marker.you-scroll-marker {
		opacity: 50%;
	}
	.scroll-marker-container {
		display: contents;
	}*/
	
	// attempt to get "yotsuba" theme working
	// since stylus runs after page, it can't retroactively check if the page
	// is a .ws or .nws page, so we can't really even use variables from stylus
	// nor custom properties
	if ss21readingMode == ss21yotsuba
		:root
			&.ws
				color #000
				background-color #eef2ff
				.subject
					color #0f0c5d
				.name,
				.trip
					color #117743
				.postContainer a:not(.replylink)
					color #34343c
					&:hover
						color #d00
				.postContainer a.quotelink
					color #d00
				.boardTitle
					color #af0a0f
				.post
					border 1px solid #b7c5d9
					border-top 0
					border-left 0
				.field
					background #fff
			&.nws
				color #800
				background-color #ffe
				.subject
					color #cc1105
				.name,
				.trip
					color #117743
				.postContainer a:not(.replylink)
					color #00e
					&:hover
						color #f00
				.postContainer a.quotelink
					color #34343c
				.boardTitle
					color #800
				.post
					border 1px solid #d9bfb7
					border-top 0
					border-left 0
				.field
					background #fff
	
	if ss21readingMode == ss21tomorrow
		:root
			color #c5c8c6
			background-color #1d1f21
	
	// please turn off stylechan...
	#StyleChanLink::after
		content ss21iconFont == 1 ? '\F4B1' : 'palette'
	
	// please turn off oneechan...
	:root.oneechan
		.fa-gears,
		#OneeChanLink .settings-link
			&::after
				content ss21iconFont == 1 ? '\F31D' : 'sentiment_dissatisfied'
	:root.oneechan .tab-select:not(:checked) + .options-section
		display none i
	#oneechan-options
		background-color ss21BackgroundElevated
		width 75rem
		max-width 90%
		height 90vh
		margin auto
		display flex
		flex-direction column
		contain paint
		borderRadius()
		z-depth(24)
		position relative
	#options-tabs
		padding 0
		margin 0
		list-style none
		display flex
		flex-direction row
		background-color ss21primary
		padding 0 1.5rem
		text-transform lowercase
		.tab-label
			display inline-flex
			align-items center
			height 3rem
			padding 0 .5rem
			position relative
			tc(ss21primary, medium)
			transition color .25s
			&.selected,
			&:hover
				tc(ss21primary, high)
			&::after
				display none
				position absolute
				bottom 0
				left 0
				width 100%
				height 2px
				content ''
				pointer-events none
				background-color var(--secondary)
			&.selected::after
				display block
	#options-container
		padding 1rem
		flex 1
		overflow-y scroll
		overscroll-behavior contain
	.options-close
		display inline-flex
		justify-content flex-end
		padding .75rem 1rem
		if ss21readingMode == ss21light
			box-shadow 0 -1px 0 0 darken(ss21BackgroundElevated, 10%)
		else if ss21readingMode == ss21dark
			box-shadow 0 -1px 0 0 lighten(ss21BackgroundElevated, 15%)
		.options-button
			margin-left .5rem
			height auto i
			&[name="save"]
				background-color ss21green
				&:hover
					background-color tint(ss21green, 10%)
	
	#main-section
		&::after
			content 'Most of these options exist in ss21. If not, request it.'
		.buttons-container,
		.option
			display none
	
	#themes-section
		.buttons-container,
		.theme-preview
			display none
		&::after
			content 'If you desperately need one ported, request it.'
	
	// oneechan mascot selection
	#mascot-section
		display grid
		grid-gap 1rem
		grid-template-columns repeat(auto-fit, minmax(200px, 1fr))
	.buttons-container
		grid-column 1 / -1
		margin 0
		display flex
		align-items center
		justify-content space-evenly
	.mascot-preview
		// these importants are needed because oneechan applies `background` instead of just `background-image`?
		background-position center i
		background-repeat no-repeat i
		background-size contain i
		height 250px
		position relative
		text-align center
		&:not(:hover) a:not(.mascot-name)
			opacity 0
		&.selected
			background-color rgba(0 0 0 .3) i
		.mascot-buttons
			position absolute
			bottom 0
			left 0
			right 0
		.mascot-link
			background-color rgba(0 0 0 .3)
			tc(@background-color, high)
			borderRadius()
			cursor pointer
			padding .25rem .5rem
		.mascot-name
			display block
		br
			display none
	
	// XXX: so this is the power of oneechan...
	// on that note, this is all you get.
	#overlay2
		position fixed
		top 0
		left 0
		width 100%
		height 100%
		z-index 22
		background-color rgba(33, 33, 33, .75)
	
	#add-mascot
		position fixed
		background-color ss21BackgroundElevated
		inset 0
		height 25rem
		width 75vw
		z-index 23
		padding .75rem 1rem
		margin auto
		borderRadius()
		z-depth(24)
	
	.add-mascot-label
		display block
	
	:root.oneechan #id_css::after
		display none
	#mascot
		position fixed
		right 0
		bottom 0
		z-index -1
		img
			height auto
			width auto
			max-width 20rem
			opacity .25
			filter grayscale(.69)
			pointer-events none
	
	// XXX: `style#fourchanx-bgcolor-css` needs to go
	:root.oneechan .watch-thread-link
		background-image none i
	
	// XXX: oneechan hides checkboxes
	:root.oneechan .riceCheck
		display none
	:root.oneechan
		#fourchanx-settings,
		#qr,
		#menu
			input[type="checkbox"]
				display initial i
	
	/*
	// scroll snapping?
	:root.paged-mode
		scroll-snap-type y proximity
		.navLinks.json-index,
		.thread
			scroll-snap-align start
			scroll-margin-top 2rem // doesn't work when scrolling up due to autohide header
	*/
	
	// XXX: https://github.com/rcc11/4chan-sounds-player
	// users really should disable thread > limit post widths
	:root.fcsp-enabled
		#fcsp-container
			z-index 100
		svg
			display inline-block
		.fcsp-chan-x-controls
			font-size .75rem
			grid-column -9
			grid-row span 2
	
	// XXX: support for post preview
	form[name="post"] .post-preview
		display none
	
	.post-preview
		if ss21readingMode == ss21light
			box-shadow 0 -1px 0 0 darken(ss21BackgroundElevated, 10%)
		else if ss21readingMode == ss21dark
			box-shadow 0 -1px 0 0 lighten(ss21BackgroundElevated, 15%)
		margin-top .5rem
		overflow-y auto
	.post-preview-blockquote
		min-height 80px
		max-height 300px
		word-wrap break-word
		background-color rgba(0, 0, 0, .33)
	.post-preview summary
		padding .25rem .25rem 0
		cursor pointer
		user-select none
	
	.ss21--download-all
		tc(ss21primary, medium)
		cursor pointer
		transition text-shadow .25s
		&:hover
			tc(ss21primary, high)
			text-shadow 0 0 1rem invert(ss21primary)
	
	.is_index .ss21--download-all
		display none
	
	.section-ss21 legend
		text-transform lowercase i
	
	.ss21-option
		min-height 56px
		padding-left 1rem
		margin-bottom -.125rem
	
	.ss21-description
		font-size .875rem
		color var(--text-hint-on-background)
		padding-left 1rem
		display block
	
	.test-page
		position fixed
		z-index 99
		display flex
		align-items center
		justify-content center
		top 0
		left 0
		width 100%
		height 100vh
		background-color rgba(0, 0, 0, .54)
	
	.test-page .page
		height 90vh
		width 90vh
		background-color #2d2d2d
		padding 1rem
		borderRadius()
		overflow-y scroll
		position relative
	
	.ss21-mdc-swatch
		display flex
		width 100%
		height 10rem
		align-items stretch
		.primary
			flex 1
	
	#ss21-downloader
		position fixed
		top 5rem
		right 1rem
		background-color ss21BackgroundElevated
		borderRadius()
		z-depth(4)
		max-height 20rem
		overflow-y scroll
		z-index 11
	
	.ss21-toprow
		background-color ss21primary
		tc(ss21primary, high)
		padding .5rem 1rem
	
	.ss21-thirow
		padding 0 .5rem
		border-bottom 1px solid ss21BackgroundColour
	
	#ss21-proggers
		width 100%
	
	.ss21-filerow:nth-child(odd)
		background-color ss21BackgroundColour
	
	.ss21-secrow,
	.ss21-filerow
		padding .25rem .5rem
		display flex
		flex-direction row
		justify-content space-between
	
	.ss21-fileurl
		color ss21primary
	
	#ss21-frog-counter
		position fixed
		bottom 1rem
		right 1rem
		padding .5rem .75rem
		background-color ss21BackgroundElevated
		borderRadius()
		z-depth(2)
	
	#ss21-frog-list
		max-height 75vh
		overflow auto
	
	:root.is-search
		.boardTitle
			font-size calc(100vw / (var(--length, 1) * 0.5) * .8) i
			white-space nowrap i
		script + .container,
		.threadHideButton,
		.postMenuBtn
			display none
		.commentForm
			width fit-content
			margin 1rem auto 0
	
	:root.is-ext
		#boardNavMobile
			position fixed
			background-color ss21primary
			tc(@background-color, high)
			top 0
			left 0
			width 100%
			z-index 5
			display flex
			align-items center
			justify-content space-between
		.boardSelect,
		.pageJump
			padding .25rem 1rem
		.boardSelect .custom-menu-ctrl
			display none
		.pageJump
			display inline-flex
			a
				font-size 0
				display inline-flex
				min-width 2rem
				align-items center
				justify-content center
				&::after
					icon-style()
			a[href='#bottom']::after
				content ss21iconFont == 1 ? '\F27E' : 'keyboard_double_arrow_down'
			#settingsWindowLinkMobile::after
				content ss21iconFont == 1 ? '\F789' : 'tune'
			a[href='//p.4chan.org/']::after
				content ss21iconFont == 1 ? '\F4E7' : 'phone_iphone'
			a[target='_top']::after
				content ss21iconFont == 1 ? '\F422' : 'home'
	
	:root:not(.sidedish-enabled) #id_css::before
		content 'Just checking, have you got sidedish enabled...?'
		position fixed
		bottom 0
		z-index 3
	
	:root:not(.fourchan-x) #id_css::after
		content 'Just checking, do you even have 4chan X/XT...?'
		position fixed
		bottom 1.5rem
		z-index 3
	
	:root.fourchan-xt #shortcut-ss21 .icon
		display block
		width 1.5rem
		height 1.5rem
	
	#shortcut-search
		display inline-flex
		align-items center
		justify-content center
		padding 0 .25rem
		grid-row span 2
		margin 0
		.icon
			display block
			height 1.25rem
			width 1.25rem
		dialog
			top 5rem
	
	#shortcut-trending
		all unset
		display inline-flex
		align-items center
		justify-content center
		padding 0 .25rem
		grid-row span 2
		margin 0
		.icon
			display block
			height 1.25rem
			width 1.25rem
	/*
<div class="c-thread">
<div class="c-board">/vg/ - Video Game Generals</div>
<a href="//boards.4chan.org/vg/thread/508602586" class="boardlink">
	<img alt="" class="c-thumb" src="//i.4cdn.org/vg/1735787388158089s.jpg" width="118" height="150">
</a>
<div class="c-teaser">
<b>/lisg/ - Life is Strange General #1231</b>
New Year edition
&gt;Previous Thread &gt;&gt;507584047
Life is Strange (LiS) is an episodic narrativ...</div>
<div class="thread-info">
<span class="ss21-chip"><span class="ss21-chip--icon material-symbols-rounded">today</span><span class="ss21-chip--text">2 days ago</span></span>
<span class="ss21-chip"><span class="ss21-chip--icon material-symbols-rounded">forum</span><span class="ss21-chip--text">277</span></span>
<span class="ss21-chip"><span class="ss21-chip--icon material-symbols-rounded">attach_file</span><span class="ss21-chip--text">35</span></span>
</div>
</div>
				*/
	#ss21--popular-threads
		position fixed
		contain strict
		overflow-y scroll
		height 100dvh
		max-width 50vw
		width 50rem
		inset-block-start 0
		inset-inline-end 0
		transform translateX(120%)
		z-index 55
		background-color var(--background-primary)
		transition all .25s
		padding 1.5rem
	h3
		font-size 1.25rem
		text-wrap pretty
		margin-bottom .5rem
	#c-threads
		display grid
		grid-template-columns 1fr 1fr
		gap .5rem
		.c-board
			font-weight 700
			text-align center
			margin-bottom .25rem
		.c-teaser
			padding: .5rem 0
		.c-teaser b
			display block
			text-align center
		.boardlink
			display inline-flex
			justify-content center
		.c-thread
			display flex
			flex-direction column
	.thread-info
		display inline-flex
		flex-wrap wrap
		flex-direction row
		gap .25rem
		justify-content center
	.ss21-chip
		display inline-flex
		align-items center
		justify-content center
		gap .25rem
		font-size .75rem
		line-height 16px
		color var(--mdc-onSecondaryContainer)
		background-color var(--mdc-secondaryContainer)
		padding .125rem .25rem
		borderRadius()
		user-select none
		.material-symbols-rounded
			font-family: 'Material Symbols Outlined';
			font-weight: normal;
			font-style: normal;
			font-size: 16px;
			font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 20
			line-height: 1;
			letter-spacing: normal;
			text-transform: none;
			display: inline-block;
			white-space: nowrap;
			word-wrap: normal;
			direction: ltr;
			-webkit-font-feature-settings: 'liga';
			-webkit-font-smoothing: antialiased;
	
	:root.trending-open #ss21--popular-threads
		transform translateX(0)
		z-depth(24)
	
	// 4CHAN EXT - if you don't enable the 'disable native extension' option
	// in 4chan x, it still shows up as an header shortcut
	#settingsMenu
		position fixed
		display flex
		align-items center
		justify-content center
		inset 0
		inline-size 100vw
		block-size 100vh
		z-index 12
		background-color rgba(33 33 33 .87)
		.panelHeader
			text-transform lowercase
			background-color var(--primary)
			block-size 3rem
			position relative
			display flex
			align-items center
			justify-content center
			.panelCtrl
				cursor pointer
				position absolute
				inset-inline-end 0
		.center
			display initial i
	
	.extPanel
		background-color var(--background-primary)
		max-inline-size 75vw
		max-block-size 80vh
		overflow-y scroll
		ul
			padding 0
			list-style none
			margin 0
		label
			font-weight bold
	
	if ss21allowAds == 1
		.danbo-slot, .adl
			display block i
			text-align center
			margin-block 1rem
		.danbo-slot a
			display inline-block
			margin auto
		.adl a
			color var(--primary)
	
@-moz-document regexp('https://find\\.4chan(?:nel)?\\.org.*')
	body
		padding-top 50px
	.subject::after
		display none
	.postNum > a:first-child
		font-size revert
		&::after
			display none

@-moz-document regexp('https://boards\\.4chan(?:nel)?\\.org\\/(.){1,}\\/catalog')
	.is_catalog #content::before
		content "This won't work because we block the native 4chan JS code. You should be using the 4chan X catalog anyway, so update your URLs."
		color ss21red
		text-align center
		display block
	.is_catalog #content *:not(#threads)
		display none i
