/* ==UserStyle==
@name           ss21
@namespace      https://github.com/saxamaphone69/
@version        2.2.10
@description    a self-centered, fresh attempt at (user)styling 4chan
@author         sax
@homepageURL    https://github.com/saxamaphone69/ss21
@updateURL      https://github.com/saxamaphone69/ss21/raw/master/ss21.user.styl
@supportURL     https://github.com/saxamaphone69/ss21/issues
@license        CC-BY-SA-4.0
@preprocessor   stylus
@var range      ss21fontSize         "Default font size" [16, 10, 18, 2, "px"]
@var checkbox   ss21roundedCorners   "Rounded corners" 1
@var select     ss21readingMode      "Reading mode" ["ss21dark:Dark theme*", "ss21light:Light theme", "ss21yotsuba:Yotsuba", "ss21tomorrow:Tomorrow", "ss21photon:Photon"]
@var color      ss21primary          "Primary colour" #bb2649
@var select     ss21spacingLevel     "Spacing amount" ["0:Comfortable", "1:Compact"]
@var checkbox   ss21underlineLink    "Underline external links" 1
@var checkbox   ss21postWidth        "Full-width posts" 1
@var checkbox   ss21boardCenter      "Centered board" 1
@var select     ss21sidebar          "Sidebar" ["0:None*", "1:Right-hand side", "2:Left-hand side"]
@var select     ss21QRPosition       "QR position" ["1:Floating*", "2:Locked right", "3:Fixed pop-out"]
@var select     ss21buttonStyle      "Button style" ["1:Contained", "2:Outline", "3:Text", "4:Material 3*"]
@var checkbox   ss21quoteColour      "Default olive" 0
@var checkbox   ss21boardBanner      "Enable board title and banner" 1
@var checkbox   ss21evenPosts        "Recolour even post backgrounds" 1
@var checkbox   ss21blotter          "Show blotter" 0
@var select     ss21headerHeight     "Header height" ["1:Tall", "2:Short"]
@var checkbox   ss21opacityHeader    "Make header slightly transparent" 1
@var checkbox   ss21forcedAnon       "Hide all names/tripcodes/IDs" 0
@var select     ss21fileInfo         "File information" ["1:Always displayed", "2:On hover*", "3:As a card"]
@var checkbox   ss21twoWide          "On wide screens, show 2 threads" 1
@var checkbox   ss21thumbnailOpacity "Drastically reduce opacity of thumbnails" 0
@var select     ss21flatness         "Materialness" ["0:Flat", "1:Elevated", "2:Bordered*"]
@var select     ss21openThread       "Open Thread style" ["0:Traditional", "1:FAB*"]
@var checkbox   ss21allowContest     "If unblocked, show contest banners" 0
@var select     ss21iconFont         "Icon font" ["0:Material Icons (old)", "1:Bootstrap", "2:Material Symbols (new)*"]
@var checkbox   ss21navRail          "Display settings as navigation rail" 1
@var select     ss21watchButton      "Watch thread button" ["1:Always displayed*", "2:On hover"]
@var select     ss21watchButtonIcon  "Watch thread icon" ["1:Heart*", "2:Star"]
@var select     ss21catalogueStyle   "Catalogue styling" ["1:Default-esque*", "2:Masonry (buggy)"]
@var select     ss21backlinkStyle    "Backlink styling" ["1:Text*", "2:Icon"]
==/UserStyle== */

@-moz-document regexp('https://(boards|find)\\.4chan(?:nel)?\\.org.*')
	// XXX: probably should allow custom ui font, and monospace font
	@import url('https://rsms.me/inter/inter.css');
	@import url('https://fonts.googleapis.com/css2?family=Inconsolata&display=swap');
	if ss21iconFont == 0
		@import url('https://fonts.googleapis.com/css2?family=Material+Icons&display=swap');
	else if ss21iconFont == 1
		@import url("https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.1/font/bootstrap-icons.css");
	else if ss21iconFont == 2
		@import url('https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200');
	
	/*
	material spec:
	 text black on white, #000 high .87
	 text black on white, #000 medium .6
	 text black on white, #000 disabled .38
	 
	 icon black on white, active+focus .87
	 icon black on white, active+NOT focused .54
	 icon black on white, inactive .38
	*/
	
	/*
	 * yes, ss21 is still around, even 5 years later. it utilises the latest and
	 * greatest web technologies and practices to create a userstyle that is
	 * unique; standing out from the (onee|app)chan styles that the majority of
	 * ricers use.
	 */
	
	// really, this should also be able to accept a text emphasis/state level
	// and then determine how much opacity to apply
	// for example, if te === high, take white and make it .87,
	// if te === medium, take white (or black) and make it .6
	tc(colour, emphasis)
		if emphasis == high
			_emphasis = .87
		if emphasis == medium
			_emphasis = .6
		if emphasis == low
			_emphasis = .38
		if contrast(#fff, colour).ratio >= 4.5
			color rgba(255, 255, 255, _emphasis)
		else
			color rgba(33, 33, 33, _emphasis)
	
	if ss21readingMode == ss21dark
		ss21OppColour = #fff
		ss21TextPrimary = alpha(#fff, .87)
		ss21TextSecondary = alpha(#fff, .6)
		ss21TextHint = alpha(#fff, .38)
		ss21BackgroundColour = #121212
		ss21BackgroundElevated = #1f1f1f
	else if ss21readingMode == ss21light
		ss21OppColour = #212121
		ss21TextPrimary = alpha(#212121, .87)
		ss21TextSecondary = alpha(#212121, .6)
		ss21TextHint = alpha(#212121, .38)
		ss21BackgroundColour = #eaeaea
		ss21BackgroundElevated = #fff
	else if ss21readingMode == ss21yotsuba
		ss21OppColour = #212121
		ss21TextPrimary = alpha(#212121, .87)
		ss21TextSecondary = alpha(#212121, .6)
		ss21TextHint = alpha(#212121, .38)
		ss21BackgroundColour = #eef2ff
		ss21BackgroundElevated = #d6daf0
		:root.ws
			--4chan-subject #0f0c5d
			--4chan-name #117743
			--4chan-trip #117743
			--4chan-quote #789922
			--4chan-link #34345c
			--4chan-link-hover #d00
			--4chan-board-title #af0a0f
			--4chan-text #000
			--4chan-text-link #000
			--4chan-background #eef2ff
			--4chan-post-bg #d6daf0 // header and dialogs
			--4chan-post-border #b7c5d9 // borders and hr
		:root.nws
			--4chan-subject #cc1105
			--4chan-name #117743
			--4chan-trip #117743
			--4chan-quote #789922
			--4chan-link #00e
			--4chan-link-hover #f00
			--4chan-board-title #800
			--4chan-text #800
			--4chan-text-link #800
			--4chan-background #ffe
			--background-primary #f0e0d6 // header and dialogs
			--4chan-post-border #d9bfb7 // borders and hr
	else if ss21readingMode == ss21tomorrow
		ss21OppColour = #212121
		ss21TextPrimary = alpha(#c5c8c6, .87)
		ss21TextSecondary = alpha(#c5c8c6, .6)
		ss21TextHint = alpha(#c5c8c6, .38)
		ss21BackgroundColour = #1d1f21
		ss21BackgroundElevated = #282a2e
	else if ss21readingMode == ss21photon
		ss21OppColour = #212121
		ss21TextPrimary = alpha(#333, .87)
		ss21TextSecondary = alpha(#333, .6)
		ss21TextHint = alpha(#333, .38)
		ss21BackgroundColour = #eee
		ss21BackgroundElevated = #ddd
	
	z-depth(n = 1)
		if n == 1
			box-shadow 0px 2px 1px -1px rgba(0, 0, 0, 0.2), 0px 1px 1px 0px rgba(0, 0, 0, 0.14), 0px 1px 3px 0px rgba(0, 0, 0, 0.12)
		if n == 2 // card, button
			box-shadow 0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)
		if n == 4 // top app bar, button hover
			box-shadow 0px 2px 4px -1px rgba(0, 0, 0, 0.2), 0px 4px 5px 0px rgba(0, 0, 0, 0.14), 0px 1px 10px 0px rgba(0, 0, 0, 0.12)
		if n == 6 // snackbar
			box-shadow 0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.14), 0px 1px 18px 0px rgba(0, 0, 0, 0.12)
		if n == 8 // menu, button active
			box-shadow 0px 5px 5px -3px rgba(0, 0, 0, 0.2), 0px 8px 10px 1px rgba(0, 0, 0, 0.14), 0px 3px 14px 2px rgba(0, 0, 0, 0.12)
		if n == 16 // nav drawer
			box-shadow 0px 8px 10px -5px rgba(0, 0, 0, 0.2), 0px 16px 24px 2px rgba(0, 0, 0, 0.14), 0px 6px 30px 5px rgba(0, 0, 0, 0.12)
		if n == 24 // dialogue
			box-shadow 0px 11px 15px -7px rgba(0, 0, 0, 0.2), 0px 24px 38px 3px rgba(0, 0, 0, 0.14), 0px 9px 46px 8px rgba(0, 0, 0, 0.12)
	
	borderRadius()
		if ss21roundedCorners
			border-radius 4px
	
	i = !important
	
	/* thankfully we have css custom properties (a.k.a. variables) we can use,
	 * along with stylus-lang to create a dynamic and truly customisable
	 * userstyle
	 */
	
	// stylus variables, only so we can use functions
	ss21-primary = ss21primary
	ss21-on-primary = tc(ss21primary, high)
	ss21-surface = #fff
	ss21-on-surface = #000
	ss21posterFounder = #117743
	ss21posterAdmin = #f44336
	ss21posterMod = #9c27b0
	ss21posterDev = #0000f0
	ss21posterManager = #ff0080
	ss21posterVerified = #007fff
	ss21posterPass = #afb42b
	
	ss21poster(type)
		if type == 'founder'
			return #117743
		if type == 'admin'
			return #f44336
		if type == 'mod'
			return #9c27b0
		if type == 'dev'
			return #0000f0
		if type == 'manager'
			return #ff0080
		if type == 'verified'
			return #007fff
		if type == 'pass'
			return #afb42b
	
	ss21red = #f44336
	ss21blue = #2196f3
	ss21green = #4caf50
	ss21purple = #9c27b0
	ss21orange = #ff9800
	ss21minContrastRatio = 3
	
	// should be tint to lighten
	// should be shade to darken
	
	ss21spacer = 1rem
	
	// bootstrap breakpoints
	// sm 540, md 720, lg 960, xl 1140, xxl 1320
	// https://github.com/twbs/bootstrap/blob/master/scss/_variables.scss
	// https://github.com/twbs/bootstrap/blob/master/scss/_functions.scss
	
	:root
		--primary ss21primary
		--secondary invert(ss21primary)
		--text-primary-on-background ss21TextPrimary
		--text-secondary-on-background ss21TextSecondary
		--text-hint-on-background ss21TextHint
		//--text-primary-on-primary ss21-on-primary
		/*
		--text-primary-on-primary textContraster(ss21primary, .87)
		--text-secondary-on-primary textContraster(ss21primary, .6)
		--text-hint-on-primary textContraster(ss21primary, .38)
		*/
		--background-primary ss21BackgroundElevated
		--background-secondary ss21BackgroundColour
		--grey-100 #f8f8fb
		--grey-300 #eeeef2
		--grey-500 #b3b3b6
		--grey-700 #737376
		--grey-900 #303033
		--grey-12 #121212
		--font-default 'Inter var', system-ui
		--font-monospace 'Inconsolata', monospace, monospace
	
	// SIDEDISH: we add a `site-loading` class to `html` to hide content while
	// it loads. also create a pseudo element loader/spinner in the mean time
	:root.site-loading
		#delform
			display flex
			align-items center
			justify-content center
			height 70vh
			&::before
				content ''
				display block
				border .5rem solid grayscale(ss21primary)
				border-top-color ss21primary
				border-radius 50%
				width 10rem
				height 10rem
				margin auto
				animation loading 1s infinite
		#header-bar,
		#bannerCnt,
		.navLinks,
		.board,
		.pagelist
			display none i
	@css {
		@keyframes loading {
			to {
				transform: rotate(359deg);
			}
		}
	}
	
	// let's hide stuff we don't need: ads!
	// first, let's keep `!important` away as to not pollute scope
	.center,
	.arc-ads,
	.adl,
	[hidden]
		display none i
	
	// and while we're here:
	// 1. mobile elements
	// 2. a bunch of elements we never use also have `.desktop`, so that's convenient
	// 3. all `hr` elements, bar the unread line
	// 4. ccd0 caters for mentally challenged people who can't manage to start a thread
	// 5. the original post form (use the qr)
	// 6. checkboxes next to posts (use the menu)
	// 7. ad pleas (buy a 4chan pass, friend)
	// 8. the '>>' to the left of posts when reply hiding isn't on
	.mobile,
	.desktop:not(#bannerCnt, .postInfo, .postNum, .summary, .pagelist, #boardNavDesktopFoot),
	hr:not(#unread-line),
	.qr-link-container,
	.postForm,
	.postInfo > input,
	.ad-plea,
	.adt-800,
	.adaps,
	.sideArrows,
	#navbotright,
	#toggleMsgBtn // sometimes this leaks through, so we add it despite it having `.desktop`
		display none
	
	// as always, using tried and tested web frameworks and design systems to
	// create a reset, reboot, and sensible base
	
	// reset everything on `:root` as opposed to `body`
	// 1. use google web fonts, or `system-ui`
	// 2. set a relative baseline `font-size` and `line-height` for easy math
	// 3. default `color` and `background` to help us determine light|dark mode
	// 4. make text render a little nicer
	// 5. always apply a scrollbar regardless of page height
	:root
		font-family var(--font-default)
		font-size 1rem
		line-height 1.5
		color var(--text-primary-on-background)
		background-color var(--background-secondary)
		-webkit-font-smoothing antialiased
		-moz-osx-font-smoothing grayscale
		//scroll-behavior smooth
		text-rendering optimizeLegibility // XXX: despite https://marco.org/2012/11/15/text-rendering-optimize-legibility - inter ui needs it for ligatures
		overflow-y scroll
		overflow-wrap anywhere
		//word-break break-word // XXX: might not even work tbh
		box-sizing border-box
		transition color .25s, background-color .25s
		accent-color ss21primary
		if ss21readingMode == ss21dark
			color-scheme dark
	
	@css {
		:root .navLinks {
			--is-nws: brown;
			background-color: var(--is-nws, var(--primary)) !important;
		}
		:root.ws .navLinks {
			--is-nws: initial;
		}
	}
	
	// XXX: https://css-tricks.com/fixing-smooth-scrolling-with-find-on-page/
	:root:focus-within
		scroll-behavior smooth
	
	// https://github.com/csstools/sanitize.css/blob/main/sanitize.css#L54
	// this doesn't actually work but?
	:where(body)
		block-size -moz-available
		block-size -webkit-fill-available
		block-size stretch
		min-height 100vh
		//font-size ss21fontSize
	
	// let's reset `box-sizing` so that when we say `1rem`, we mean it
	// http://www.paulirish.com/2012/box-sizing-border-box-ftw/ along with
	// https://css-tricks.com/inheriting-box-sizing-probably-slightly-better-best-practice/
	*,
	::before,
	::after
		box-sizing inherit
	
	// it is bad practice/UX to not give focused elements visual feedback (not
	// to mention against the law), but there is a 0% chance anyone with visual
	// impairments would be using a userstyle
	// XXX: i actually want to support this
	:focus
		outline 0
		//box-shadow 0 0 0 .25rem alpha(lighten(ss21primary, 50%), .25)
		//isolation isolate
	
	:focus-visible
		box-shadow 0 0 0 .25rem alpha(lighten(ss21primary, 50%), .25)
	
	// XXX: should only apply when using keyboard
	:root.keyboard-focus .postContainer:focus-within .post
		background-color mix(ss21primary, ss21BackgroundElevated, 7%)
		box-shadow 0 0 0 .25rem alpha(lighten(ss21primary, 50%), .25)
	
	// 4CHANX: adds `.keyboard-focus` to `html`
	// :root:not(.keyboard-focus) a { outline: none; }
	
	// https://developer.mozilla.org/en-US/docs/Web/CSS/:focus-visible
	// https://developer.paciellogroup.com/blog/2018/03/focus-visible-and-backwards-compatibility/
	
	//[tabindex="-1"]:focus:not(:focus-visible)
	//	outline 0 !important
	
	// make highlighted elements match the theme. also let's appreciate the fact
	// that after 10 years, we no longer need 2 separate declarations here
	// https://bugzilla.mozilla.org/show_bug.cgi?id=509958
	// https://caniuse.com/#feat=css-selection
	::selection
		background-color alpha(lighten(ss21primary, 25%), .1)
	
	// give scrollbars in webkit browsers some non-standard love
	// https://developer.mozilla.org/en-US/docs/Web/CSS/::-webkit-scrollbar
	// and hopefully one day, a standard is agreed upon
	// https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Scrollbars
	// https://drafts.csswg.org/css-scrollbars-1/
	/*
	::-webkit-scrollbar
		width .5rem
		height .5rem
		background-color var(--grey-500)
	::-webkit-scrollbar-thumb
		background-color var(--grey-700)
	*/
	// address `font-weight` set incorrectly in all browsers. while we're here we
	// set other elements we want to `bold`, too
	b, strong, th
		font-weight 700
	
	.subject, .name
		font-weight 700
	
	// XXX: potentially expensive override to inline-styled elements to ensure
	// consistent styling
	[style*="weight:"]
		font-weight 700 i
	
	// reset the default margin given to these elements
	blockquote,
	body,
	h1, h2, h3, h4, h5, h6,
	p
		margin 0
	
	// in the off chance that an announcement is done with the heading elements,
	// at least make it look nice
	h1, h2, h3, h4, h5, h6
		line-height 1.2
		font-weight 700
		margin-bottom .5rem
	
	h1
		font-size calc(1.375rem + 1.5vw)
	
	h2
		font-size calc(1.325rem + .9vw)
	
	h3
		font-size calc(1.3rem + .6vw)
	
	h4
		font-size calc(1.275rem + .3vw)
	
	h5
		font-size 1.25rem
	
	h6
		font-size 1rem
	
	p
		margin-bottom 1rem
	
	// ensure the correct `font-size` in all browsers
	:where(small)
		font-size .875em
	
	// prevent `sup` and `sub` elements from affecting line height
	sup,
	sub
		font-size .75em
		line-height 0
		vertical-align baseline
		position relative
	
	sup
		top -.5em
	
	sub
		bottom -.25em
	
	// opt for `inherit` being used because very few `a` elements are a consistent
	// colour, and also remove all underlines, if enabled
	// XXX: linkify links should be the option, not the exception
	a
		color inherit
		text-decoration none
		transition color .25s
	
	// the exception being linkified links
	// one day:
	// https://developer.mozilla.org/en-US/docs/Web/CSS/text-underline-offset
	.linkify,
	.globalMessage a:not(.fa),
	.postMessage > a[href*="//"]:not([href*="boards.4chan.org"]):not([href*="boards.4channel.org"])
		text-decoration solid underline
		text-underline-offset 2px // XXX: 1px suddenly stopped looking good?
		unless ss21underlineLink
			text-decoration none
		color ss21primary
		&:hover
			color shade(ss21primary, 15%)
	
	// XXX: surely a better way to write this...
	.linkify
		&.twitter::before
			content ''
			display inline-block
			width 1rem
			height 20px
			margin-right .25rem
			vertical-align text-bottom
			background-position 50% 50%
			background-repeat no-repeat
			background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512'%3E%3Cpath fill='%231da1f2' d='M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z'/%3E%3C/svg%3E")
		&.youtube::before
			content ''
			display inline-block
			width 1rem
			height 20px
			margin-right .25rem
			vertical-align text-bottom
			background-position 50% 50%
			background-repeat no-repeat
			background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 576 512'%3E%3Cpath fill='%23f00' d='M549.655 124.083c-6.281-23.65-24.787-42.276-48.284-48.597C458.781 64 288 64 288 64S117.22 64 74.629 75.486c-23.497 6.322-42.003 24.947-48.284 48.597-11.412 42.867-11.412 132.305-11.412 132.305s0 89.438 11.412 132.305c6.281 23.65 24.787 41.5 48.284 47.821C117.22 448 288 448 288 448s170.78 0 213.371-11.486c23.497-6.321 42.003-24.171 48.284-47.821 11.412-42.867 11.412-132.305 11.412-132.305s0-89.438-11.412-132.305zm-317.51 213.508V175.185l142.739 81.205-142.739 81.201z'/%3E%3C/svg%3E"), radial-gradient(white 3px, transparent 3px) //yes, that just happened
		&.vocaroo
			color #CAFF70 i
		&[href^="https://github.com"]::before
			content ''
			display inline-block
			width 1rem
			height 20px
			margin-right .25rem
			vertical-align text-bottom
			background-position 50% 50%
			background-repeat no-repeat
			background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' fill='black' viewBox='0 0 16 16'%3E%3Cpath d='M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z'/%3E%3C/svg%3E")
	
	// correct some weird browser inconsistencies in font inheritance, and while
	// we're here, set tripcodes and user ids to also use a monospace font
	pre,
	code,
	kbd,
	.postertrip,
	.posteruid
		font-family var(--font-monospace)
		font-size 1em
	
	.prettyprint
		font-size .875rem
		-webkit-font-smoothing subpixel-antialiased
		white-space pre-wrap
		word-wrap normal
		word-spacing normal
		word-break normal
		-moz-tab-size 4
		tab-size 4
		hyphens none
		overflow auto // don't allow content to break outside
		padding .125rem .25rem
		margin 0 // remove browser default
		display inline-block
		vertical-align middle
		max-width 100%
		transition color .25s, background-color .25s
	
	// 4chan uses google prettify to format [code] tags on /g/
	// MIT License; github.com/jmblog/color-themes-for-google-code-prettify
	// XXX: this can be cleaned up, and should apply to `kbd` and other `pre` too
	if ss21readingMode == ss21dark
		.prettyprint
			color #f5f7ff
			background-color #202746
			.kwd
			.typ
				color #6679cc
			.com
				color #6b7394
			.tag
				color #c94922
			.atn
				color #c76b29
			.str
			.atv
				color #ac9739
			.lit
			.dec
				color #c76b29
	else if ss21readingMode == ss21light
		.prettyprint
			color #202746
			background-color #f5f7ff
			.kwd
			.typ
				color #6679cc
				font-style italic
			.com
				color #202746
			.tag
				color #c94922
			.atn
				color #c76b29
			.str
			.atv
				color #22a2c9
			.lit
			.dec
				color #c76b29
	
	// fix spacing of media objects, and make them responsive by default
	// XXX: `video` controls will appear slightly off the bottom of the video
	// when height is not a rounded amount
	embed,
	img,
	svg,
	video
		display block // was `vertical-align: middle`
		height auto
		max-width 100%
	
	// `audio` separate, because it doesn't need to be responsive
	:where(audio)
		vertical-align middle
		width 100%
	
	// remove the default border given to `iframe`
	iframe
		border 0
		vertical-align middle
	
	// prevent double borders in tables
	table
		border-collapse collapse
		border-spacing 0
	
	// reset generic form elements to look consistent across browsers
	// XXX: https://bugzil.la/1536148 - except `option` in Firefox, which due to
	// how they "render the process" cannot accept web fonts
	button, input, option, select, textarea
		font inherit
		color inherit
		margin 0
	
	button,
	input[type="button"],
	input[type="submit"],
	a.replylink,
	:root.oneechan .options-button
		font-size .875rem
		line-height 1
		letter-spacing .09em
		text-transform uppercase
		position relative
		display inline-flex
		align-items center
		justify-content center
		//vertical-align middle
		padding 0 .75rem
		border 0
		min-height 2.25rem
		min-width 4rem
		borderRadius()
		cursor pointer
		user-select none
		transition all .25s
		if ss21buttonStyle == 1
			background-color ss21primary
			tc(ss21primary, high)
			z-depth(2)
			&:hover
				background-color mix(#fff, @background-color, 10%)
			&:active
				background-color mix(#fff, @background-color, 12%)
				transform translateY(1px)
		else if ss21buttonStyle == 2
			color ss21primary
			background transparent
			border 1px solid ss21primary
			&:hover
				background-color rgba(ss21primary, 0.1)
			&:active
				background-color rgba(ss21primary, 0.25)
				transform translateY(1px)
		else if ss21buttonStyle == 3
			color ss21primary
			background transparent
			&:hover
				background-color rgba(ss21primary, 0.1)
			&:active
				background-color rgba(ss21primary, 0.25)
				transform translateY(1px)
		else if ss21buttonStyle == 4
			background-color ss21primary
			text-transform none
			border-radius 32rem
			height 40px
			padding 0 24px
			&:hover
				background-color mix(#fff, @background-color, 10%)
			&:active
				background-color mix(#fff, @background-color, 12%)
	
	a.replylink
		min-height initial
		height 1.5rem
		margin-left .25rem
	
	// okay, so there are only a handful of input fields used in 4chan x anyway:
	// index search field (with 3 select dropdowns), qr, and the settings
	.field,
	:root.is-search .commentForm input[name='q']
		display inline-block
		background inherit
		padding .5rem .75rem
		border 1px solid alpha(ss21OppColour, .33)
		borderRadius()
		transition border .25s, box-shadow .25s
		&:hover
			border-color alpha(ss21OppColour, .8)
		&:focus
			border-color ss21primary
			box-shadow 0 0 0 .2rem alpha(ss21primary, .25)
	
	// checkboxes use to be pseudo elements, but generic styling is pretty easy and reliable now
	// HEAVILY inspired from bootstrap, gov.uk, and carbon
	input[type="checkbox"]
		width 1.25em
		height 1.25em
		background-repeat no-repeat
		background-position center
		background-size contain
		border 2px solid alpha(ss21OppColour, .33)
		borderRadius()
		-webkit-appearance none
		-moz-appearance none
		appearance none
		vertical-align text-top
		margin-right .25rem
		cursor pointer // opinionated
		transition all .25s
		&:hover
			border-color alpha(ss21OppColour, .8)
		&:active
			filter brightness(90%)
		&:focus
			outline 0
			box-shadow 0 0 0 .2rem alpha(lighten(ss21primary, 15%), 25%)
		&:checked
			background-color ss21primary
			if contrast(#fff, ss21primary).ratio >= 4.5
				$tick = "%23fff"
			else
				$tick = "%23000"
			background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='" + $tick + "' d='M21 7L9 19l-5.5-5.5 1.41-1.41L9 16.17 19.59 5.59 21 7z'/%3E%3C/svg%3E")
			border-color darken(ss21primary, 33%)
	
	// XXX: dropdown arrow sometimes covers writing, may need more padding on right
	// XXX: the border needs to remain transparent OR opaque, cannot go between each
	:where(select)
		display inline-block
		tc(ss21BackgroundColour, high)
		background-color var(--background-primary)
		background-repeat no-repeat
		background-position bottom 1rem right .5rem
		background-size 16px 12px
		background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cpath fill='" + alpha(ss21OppColour, .54) + "' d='M16.59 8.59L12 13.17 7.41 8.59 6 10l6 6 6-6z'%3E%3C/path%3E%3C/svg%3E")
		padding .5rem 1.75rem .5rem .75rem
		border 1px solid alpha(ss21OppColour, .33)
		borderRadius()
		transition border-color .25s, box-shadow .25s
		word-wrap normal
		-webkit-appearance none
		-moz-appearance none
		appearance none
		&:hover
			border 1px solid alpha(ss21OppColour, .8)
		&:focus
			border 1px solid alpha(tint(ss21primary, 33%), .9)
			box-shadow 0 0 0 .25rem alpha(lighten(ss21primary, 50%), .25)
	
	// `textarea` should only resize vertically as to not break their containers
	textarea
		resize vertical
	
	textarea
		background inherit
		padding .5rem .75rem
		border 1px solid alpha(ss21OppColour, .33)
		borderRadius()
		transition border .25s, box-shadow .25s
		&:hover
			border-color alpha(ss21OppColour, .8)
		&:focus
			border-color ss21primary
			box-shadow 0 0 0 .2rem alpha(ss21primary, .25)
	
	// generic styling for all disabled elements using the pseudo selector
	:disabled
		color var(--grey-900)
		background-color var(--grey-500)
		border 1px solid var(--grey-700)
		//cursor not-allowed
		pointer-events none
		opacity .5
	
	// make `label` elements appear clickable, because that's our opinion
	// https://medium.com/simple-human/buttons-shouldnt-have-a-hand-cursor-b11e99ca374b
	// https://fvsch.com/styling-buttons/
	label
		cursor pointer
	
	// make `fieldset` behave more like a block element
	fieldset
		min-width 0
		padding 0
		border 0
		margin 0
	
	// give `placeholder` text a specific colour, and ensure it renders
	// consistently across browsers
	::placeholder
		color var(--text-hint-on-background)
		opacity 1
	
	// correct cursor style of +/- buttons in safari for `input[type="number"]`
	::-webkit-inner-spin-button
		height auto
	
	// removes the 'clear' button that chrome adds to `input[type=search]` elements
	::-webkit-search-decoration,
	::-webkit-search-cancel-button
		-webkit-appearance none
	
	// remove inner padding and border of buttons in firefox
	::-moz-focus-inner
		padding 0
		border-style none
	
	// ensure the only `hr` you will see, `#unread-line`, is styled consistently
	// across browsers and also set to green (as opposed to red)
	:where(#unread-line)
		box-sizing content-box
		height 0
		overflow visible
		border 0
		border-top 1px solid ss21green
		margin 1rem 0
	
	// `s` is used for [spoiler] text. occasionally, this has issues with
	// links and quoted text within spoilers
	s,
	s > .quote
		text-decoration none
		color var(--grey-12) i
		background-color var(--grey-12) i
		transition color .25s
	
	s:hover,
	s:hover .quote
		color var(--grey-100) i
	
	/*
<blockquote class="postMessage" id="m561357917"><a href="#p561357657" class="quotelink">&gt;&gt;561357657</a><br>Compare pic related to his Dx2 model which looks great<br><s><a class="linkify" rel="noreferrer noopener" target="_blank" href="https://static.wikia.nocookie.net/megamitensei/images/9/95/Metatron_in_DX2.png/revision/latest?cb=20191110121222">https://static.wikia.nocookie.net/m<wbr>egamitensei/images/9/95/Metatron_in<wbr>_DX2.png/revision/latest?cb=2019111<wbr>0121222</a></s></blockquote>

<blockquote class="postMessage" id="m82226876">/mkg/ - God damn it dude I'm so fucking sick of Cherry MX edition<br><br><span class="quote">&gt;Keyboard recommendation template</span><br><a class="linkify pastebin" rel="noreferrer noopener" target="_blank" href="https://pastebin.com/n220xk9V">https://pastebin.com/n220xk9V</a> <a class="embedder" href="javascript:;" data-key="Pastebin" data-uid="n220xk9V" data-options="undefined" data-href="https://pastebin.com/n220xk9V">(<span>un</span>embed)</a><br><br><span class="quote">&gt;Where to buy keyboards</span><br><a class="linkify" rel="noreferrer noopener" target="_blank" href="https://www.alexotos.com/keyboard-vendor-list/">https://www.alexotos.com/keyboard-v<wbr>endor-list/</a><br><a class="linkify" rel="noreferrer noopener" target="_blank" href="https://www.mechmap.tech/themap">https://www.mechmap.tech/themap</a><br><a class="linkify" rel="noreferrer noopener" target="_blank" href="https://keycaplendar.firebaseapp.com">https://keycaplendar.firebaseapp.co<wbr>m</a><br><br><span class="quote">&gt;Charts!</span><br><a class="linkify" rel="noreferrer noopener" target="_blank" href="https://kiibohd.com">https://kiibohd.com</a><br><br><span class="quote">&gt;QMK</span><br><a class="linkify" rel="noreferrer noopener" target="_blank" href="https://config.qmk.fm/">https://config.qmk.fm/</a><br><a class="linkify" rel="noreferrer noopener" target="_blank" href="https://beta.docs.qmk.fm">https://beta.docs.qmk.fm</a><br><br>Last thread: <a href="https://boards.4channel.org/g/thread/82209582/" target="_blank">https://boards.4channel.org/g/threa<wbr>d/82209582/</a></blockquote>

<blockquote class="postMessage" id="m561402095"><a href="#p561401769" class="quotelink">&gt;&gt;561401769</a><br>This is unironically him trying to sweep shit under the rug lmao<br><a href="#p561401960" class="quotelink">&gt;&gt;561401960</a><br>There's archived threads in which he got mass banned, I think this was the first mass ban he scored <a class="linkify quotelink" rel="noreferrer noopener" target="_blank" href="https://arch.b4k.co/v/thread/499343579/#q499358153" data-board-i-d="v" data-thread-i-d="499343579" data-post-i-d="499358153">https://arch.b4k.co/v/thread/499343<wbr>579/#q499358153</a><br>Look for how many posts got deleted</blockquote>

<blockquote class="postMessage" id="m4662311"><a href="#p4662298" class="quotelink">&gt;&gt;4662298</a><br><a href="//boards.4chan.org/r/#s=eddit" class="quotelink">&gt;&gt;&gt;/r/eddit</a></blockquote>

<blockquote class="postMessage" id="m563068435"><s>&gt;Is an asshole to you throughout the game<br><span class="quote">&gt;Tries to kill you and won't tell you why</span><br><span class="quote">&gt;Gets all your friends to betray and try to kill you</span><br><span class="quote">&gt;You still hang out with your "friends" like nothing they don't even bother to tell you why they want you dead and you're such a loser that you're fine with that and them continuing to try to oppose you.</span><br><span class="quote">&gt;You are also fine with her killing your dad, being free to kill you along with your friends trying to kill you.</span><br></s><br><br>No sane humans acts like this.<s><br>Yet you are all fine with it, do you enjoy your friends wanting to kill you and your family?</s><br>Explain.</blockquote>

*/
	
	// 4CHANX: technically not a reset, but this is the only time we mention spoilers
	// so we're putting this here. if the reveal spoilers setting is on, support it
	:root.reveal-spoilers
		s,
		s > a
			color var(--grey-100) i
		.removed-spoiler
			&::before
				content '[spoiler]'
			&::after
				content '[/spoiler]'
	
	// XXX: ICONS! by no means a perfect implementation due to the limitations
	// and the "workarounds" used in order to get icons to appear
	.fa::after,
	.menu-button::after,
	.n-pu::after,
	.contact-links::after,
	#navlinks a::after,
	.postJumper a::after,
	#index-rev::after,
	.indicator::after,
	.pagelist .prev a::after,
	.pagelist .next a::after,
	.watch-thread-link::after,
	#index-search-clear::after,
	#index-rev::after,
	.has-submenu::after,
	.show-announcement::after,
	.report-link::after,
	.download-link::after,
	.copy-text-link::after,
	.qr-preview-spoiler::after,
	.checkbox-letter::after,
	#add-post::after,
	.gal-start::after,
	.gal-stop::after,
	.gal-close::after,
	.close::after,
	.jump::after,
	.file--video:not(.expanded-image) > .post > .file > .fileThumb::after,
	.file--gif:not(.expanded-image) > .post > .file > .fileThumb::after,
	.native-settings::after,
	.post--dubs .postNum a:nth-child(2n)::after,
	span.fileThumb::before,
	.summary::before,
	.ss21--board-drawer-toggle,
	.ss21--download-all
		if ss21iconFont == 0
			font-family 'Material Icons'
			font-weight normal
			font-style normal
			font-size 1.5rem // 24px, ideally
			display inline-flex // better vertical alignment
			justify-content center
			align-items center
			line-height 1 // might not be needed
			text-transform none
			letter-spacing normal
			word-wrap normal
			white-space nowrap
			direction ltr
			-webkit-font-smoothing antialiased
			text-rendering optimizeLegibility
			-moz-osx-font-smoothing grayscale
			font-feature-settings 'liga'
			color inherit // generally not explicity set, but should be
			visibility visible // added from 4chan x
		else if ss21iconFont == 1
			display inline-flex
			font-family bootstrap-icons
			font-style normal
			font-size 24px
			font-weight normal
			font-variant normal
			text-transform none
			line-height 1
			-webkit-font-smoothing antialiased
			-moz-osx-font-smoothing grayscale
			visibility visible // added from 4chan x
		else if ss21iconFont == 2
			font-family 'Material Symbols Outlined'
			font-weight normal
			font-style normal
			font-size 24px
			line-height: 1
			letter-spacing normal
			text-transform none
			display inline-flex // better vertical alignment
			justify-content center
			align-items center
			white-space nowrap
			word-wrap normal
			direction ltr
			-webkit-font-feature-settings 'liga'
			-webkit-font-smoothing antialiased
			color inherit // generally not explicity set, but should be
			visibility visible // added from 4chan x
			font-variation-settings 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24
	
	.fa-spin::after
		animation spin 2s infinite linear
	
	@css {
		@keyframes spin {
			0% {
				transform: rotate(0);
			}
			100% {
				transform: rotate(359deg);
			}
		}
	}
	
	.menu-button::after // menus
		if ss21iconFont == 0
			content 'more_vert'
		else if ss21iconFont == 1
			content '\F5D3'
		else if ss21iconFont == 2
			content 'more_vert'
	.catalog-post .menu-button::after // menus in catalogue mode
		if ss21iconFont == 0
			content 'more_horiz'
		else if ss21iconFont == 1
			content '\F5D4'
		else if ss21iconFont == 2
			content 'more_horiz'
	.fa-eye::after // thread watcher
		if ss21iconFont == 0
			content 'remove_red_eye'
		else if ss21iconFont == 1
			content '\F33E'
		else if ss21iconFont == 2
			content 'remove_red_eye'
	.fa-expand::after // expand all images
		if ss21iconFont == 0
			content 'fullscreen'
		else if ss21iconFont == 1
			content '\F3DF'
		else if ss21iconFont == 2
			content 'fullscreen'
	.fa-compress::after // compress all images
		if ss21iconFont == 0
			content 'fullscreen_exit'
		else if ss21iconFont == 1
			content '\F3DE'
		else if ss21iconFont == 2
			content 'fullscreen_exit'
	.fa-picture-o::after // gallery mode
		if ss21iconFont == 0
			content 'photo'
		else if ss21iconFont == 1
			content '\F42A'
		else if ss21iconFont == 2
			content 'photo'
	.fa-comment-o::after // menus in catalogue mode
		if ss21iconFont == 0
			content 'comment'
		else if ss21iconFont == 1
			content '\F25B'
		else if ss21iconFont == 2
			content 'comment'
	.fa-refresh::after // refresh index
		if ss21iconFont == 0
			content 'refresh'
		else if ss21iconFont == 1
			content '\F116'
		else if ss21iconFont == 2
			content 'refresh'
	.fa-wrench::after // 4chan x settings
		if ss21iconFont == 0
			content 'settings'
		else if ss21iconFont == 1
			content '\F3E2'
		else if ss21iconFont == 2
			content 'settings'
	.fa-minus-square::after,
	.fa-minus-square-o::after // hide post
		if ss21iconFont == 0
			content 'remove_circle'
		else if ss21iconFont == 1
			content '\F2E5'
		else if ss21iconFont == 2
			content 'unfold_less'
	.fa-plus-square::after,
	.fa-plus-square-o::after // show post
		if ss21iconFont == 0
			content 'add_circle'
		else if ss21iconFont == 1
			content '\F4F9'
		else if ss21iconFont == 2
			content 'unfold_more'
	.fa-times::after,
	.close::after,
	.gal-close::after // close
		if ss21iconFont == 0
			content 'close'
		else if ss21iconFont == 1
			content '\F659'
		else if ss21iconFont == 2
			content 'close'
	.fa-bolt::after // prefetch
		if ss21iconFont == 0
			content 'flash_on'
		else if ss21iconFont == 1
			content '\F46E'
		else if ss21iconFont == 2
			content 'flash_on'
	.watch-thread-link::after // watch thread
		if ss21iconFont == 0
			content 'favorite_border'
			color ss21red
		else if ss21iconFont == 1
			content '\F417'
			color ss21red
		else if ss21iconFont == 2
			font-variation-settings 'FILL' 0
			if ss21watchButtonIcon == 1
				content 'favorite'
				color ss21red
			else if ss21watchButtonIcon == 2
				content 'star'
				color ss21orange
	.watch-thread-link.watched::after // watched/unwatch thread
		if ss21iconFont == 0
			content 'favorite'
		else if ss21iconFont == 1
			content '\F415'
		else if ss21iconFont == 2
			font-variation-settings 'FILL' 1
	#navlinks
		a:first-of-type::after // navigate up
			if ss21iconFont == 0
				content 'keyboard_arrow_up'
			else if ss21iconFont == 1
				content '\F286'
			else if ss21iconFont == 2
				content 'keyboard_arrow_up'
		a:last-of-type::after // navigate down
			if ss21iconFont == 0
				content 'keyboard_arrow_down'
			else if ss21iconFont == 1
				content '\F282'
			else if ss21iconFont == 2
				content 'keyboard_arrow_down'
	.postJumper
		a:first-of-type::after // jump to previous post by id
			if ss21iconFont == 0
				content 'arrow_upward'
			else if ss21iconFont == 1
				content '\F148'
			else if ss21iconFont == 2
				content 'arrow_upward'
		a:last-of-type::after // jump to next post by id
			if ss21iconFont == 0
				content 'arrow_downward'
			else if ss21iconFont == 1
				content '\F128'
			else if ss21iconFont == 2
				content 'arrow_downward'
	#index-rev::after // reverse index order
		if ss21iconFont == 0
			content 'swap_vert'
		else if ss21iconFont == 1
			content '\F127'
		else if ss21iconFont == 2
			content 'swap_vert'
	.pagelist
		.prev a::after // pagelist, previous page ($$$?)
			if ss21iconFont == 0
				content 'arrow_back'
			else if ss21iconFont == 1
				content '\F12F'
			else if ss21iconFont == 2
				content 'arrow_back'
		.next a::after // pagelist, next page ($$$?)
			if ss21iconFont == 0
				content 'arrow_forward'
			else if ss21iconFont == 1
				content '\F138'
			else if ss21iconFont == 2
				content 'arrow_forward'
	.fa-edit::after // oeaki mode in qr
		if ss21iconFont == 0
			content 'format_paint'
		else if ss21iconFont == 1
			content '\F4B0'
		else if ss21iconFont == 2
			content 'format_paint'
	.copy-text-link::after,
	.fa-link::after // copy
		if ss21iconFont == 0
			content 'link'
		else if ss21iconFont == 1
			content '\F471'
		else if ss21iconFont == 2
			content 'link'
	#paste-area::after // paste mode in qr
		if ss21iconFont == 0
			content 'content_paste'
		else if ss21iconFont == 1
			content '\F290'
		else if ss21iconFont == 2
			content 'content_paste'
	.fa-clock-o::after // auto poster in qr
		if ss21iconFont == 0
			content 'timer'
		else if ss21iconFont == 1
			content '\F597'
		else if ss21iconFont == 2
			content 'timer'
	#qr .fa-plus-square::after,
	#add-post::after // dump list in qr
		if ss21iconFont == 0
			content 'add_box'
		else if ss21iconFont == 1
			content '\F4FC'
		else if ss21iconFont == 2
			content 'add_box'
	#index-search-clear::after,
	.fa-times-circle::after // remove/clear
		if ss21iconFont == 0
			content 'remove'
		else if ss21iconFont == 1
			content '\F622'
		else if ss21iconFont == 2
			content 'cancel'
			font-variation-settings 'FILL' 0
	.qr-preview-spoiler::after,
	.checkbox-letter::after // spoilers in qr
		if ss21iconFont == 0
			content 'strikethrough_s'
		else if ss21iconFont == 1
			content '\F5F5'
		else if ss21iconFont == 2
			content 'strikethrough_s'
	.gal-start::after // play slideshow in gallery mode
		if ss21iconFont == 0
			content 'play_arrow'
		else if ss21iconFont == 1
			content '\F4F4'
		else if ss21iconFont == 2
			content 'play_arrow'
	.gal-stop::after // stop slideshow in gallery mode
		if ss21iconFont == 0
			content 'stop'
		else if ss21iconFont == 1
			content '\F592'
		else if ss21iconFont == 2
			content 'stop'
	.has-submenu::after // add icon to menu entry
		if ss21iconFont == 0
			content 'keyboard_arrow_right'
		else if ss21iconFont == 1
			content '\F285'
		else if ss21iconFont == 2
			content 'keyboard_arrow_right'
	.left .has-submenu::after // add icon to menu entry
		if ss21iconFont == 0
			content 'keyboard_arrow_left'
		else if ss21iconFont == 1
			content '\F284'
		else if ss21iconFont == 2
			content 'keyboard_arrow_left'
	.jump::after // jumper in embedder
		if ss21iconFont == 0
			content 'subdirectory_arrow_right'
		else if ss21iconFont == 1
			content '\F132'
		else if ss21iconFont == 2
			content 'subdirectory_arrow_right'
	.show-announcement::after // add icon to menu entry
		if ss21iconFont == 0
			content 'announcement'
		else if ss21iconFont == 1
			content '\F483'
		else if ss21iconFont == 2
			content 'announcement'
	.report-link::after // add icon to menu entry
		if ss21iconFont == 0
			content 'warning'
		else if ss21iconFont == 1
			content '\F33A'
		else if ss21iconFont == 2
			content 'warning'
	.file--video:not(.expanded-image) > .post > .file > .fileThumb::after // play icon for webm thumbnails
		if ss21iconFont == 0
			content 'play_circle_outline'
		else if ss21iconFont == 1
			content '\F4F3'
		else if ss21iconFont == 2
			content 'play_circle'
			font-variation-settings 'FILL' 0
	.file--gif:not(.expanded-image) > .post > .file > .fileThumb::after // gif icon for gif thumbnails
		if ss21iconFont == 0
			content 'GIF'
		else if ss21iconFont == 1
			content '\F366'
		else if ss21iconFont == 2
			content 'gif_box'
			font-variation-settings 'FILL' 0
	.fa-download::after,
	.download-link::after // file download and add icon to menu entry
		if ss21iconFont == 0
			content 'file_download'
		else if ss21iconFont == 1
			content '\F30A'
		else if ss21iconFont == 2
			content 'download'
	.n-pu::after // 4chan pass user
		if ss21iconFont == 0
			content 'person'
		else if ss21iconFont == 1
			content '\F4DA'
		else if ss21iconFont == 2
			content 'person'
	#shortcut-werk .indicator::after // werk tyme indicator
		if ss21iconFont == 0
			content 'work'
		else if ss21iconFont == 1
			content '\F1CB'
		else if ss21iconFont == 2
			content 'work'
	#shortcut-fappe .indicator::after // fappe tyme indicator
		if ss21iconFont == 0
			content 'burst_mode'
		else if ss21iconFont == 1
			content '\F219'
		else if ss21iconFont == 2
			content 'burst_mode'
	.native-settings::after // native 4chan extension
		if ss21iconFont == 0
			content 'settings_applications'
		else if ss21iconFont == 1
			content '\F5DB'
		else if ss21iconFont == 2
			content 'settings_applications'
	.contact-links::after // for admins and mods
		if ss21iconFont == 0
			content 'contact_support'
		else if ss21iconFont == 1
			content '\F4DB'
		else if ss21iconFont == 2
			content 'contact_support'
	.post--dubs .postNum a:nth-child(2n)::after // dubs if filtered
		if ss21iconFont == 0
			content 'check'
		else if ss21iconFont == 1
			content '\F26F'
		else if ss21iconFont == 2
			content 'check'
	span.fileThumb::before,
	.dead-thread .fa-times::after // dead thread and remove from thread watcher
		if ss21iconFont == 0
			content 'delete_forever'
		else if ss21iconFont == 1
			content '\F5DD'
		else if ss21iconFont == 2
			content 'delete_forever'
	.fa-play-circle::after // https://github.com/rcc11/4chan-sounds-player support
		if ss21iconFont == 0
			content 'music_note'
		else if ss21iconFont == 1
			content '\F4A0'
		else if ss21iconFont == 2
			content 'music_note'
	
	if ss21iconFont == 1
		.shortcut .fa::after,
		.shortcut .menu-button::after
			font-size 24px
		.watch-thread-link::after,
		.post .menu-button::after,
		.postContainer a[class$='reply-button'] .fa::after
			font-size 18px
		.ss21--board-drawer-toggle
			font-size 0
			&::after
				content '\F479'
				font-size 24px
		.ss21--download-all
			font-size 0
			&::after
				content '\F1B9'
				font-size 24px
	
	if ss21openThread == 1
		.summary::before
			tc(ss21primary, medium)
			font-size .875rem
			margin-right .25rem
			justify-content center
			align-items center
			transition color .25s
			/:root.ua-gecko ^[0]
				margin-top 1px
			if ss21iconFont == 0
				content 'open_in_new'
			else if ss21iconFont == 1
				content '\F1C5'
			else if ss21iconFont == 2
				content 'open_in_new'
		.summary:hover::before
			tc(ss21primary, high)
		.summary-bottom
			display none i
	
	// we also sub out the default 4chan icons to material icons, albeit as svg
	// closed: lock, archive: inbox-multiple, sticky: place/pin
	// XXX: need to make it so this changes along with which icon font you pick
	.closedIcon
		if ss21iconFont == 0
			--closed-icon url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='" + hsl(ss21OppColour) + "' d='M12,17A2,2 0 0,0 14,15C14,13.89 13.1,13 12,13A2,2 0 0,0 10,15A2,2 0 0,0 12,17M18,8A2,2 0 0,1 20,10V20A2,2 0 0,1 18,22H6A2,2 0 0,1 4,20V10C4,8.89 4.9,8 6,8H7V6A5,5 0 0,1 12,1A5,5 0 0,1 17,6V8H18M12,3A3,3 0 0,0 9,6V8H15V6A3,3 0 0,0 12,3Z' /%3E%3C/svg%3E")
		else if ss21iconFont == 1
			--closed-icon url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='" + hsl(ss21OppColour) + "' viewBox='0 0 16 16'%3E%3Cpath d='M8 1a2 2 0 0 1 2 2v4H6V3a2 2 0 0 1 2-2zm3 6V3a3 3 0 0 0-6 0v4a2 2 0 0 0-2 2v5a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2z'/%3E%3C/svg%3E")
		else if ss21iconFont == 2
			--closed-icon url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='" + hsl(ss21OppColour) + "' viewBox='0 0 20 20'%3E%3Cpath d='M5.417 18.917q-.875 0-1.459-.584-.583-.583-.583-1.458V8.708q0-.875.583-1.458.584-.583 1.459-.583v-2q0-1.938 1.343-3.282Q8.104.042 10 .042q1.917 0 3.25 1.343 1.333 1.344 1.333 3.282v2q.875 0 1.459.583.583.583.583 1.458v8.167q0 .875-.583 1.458-.584.584-1.459.584ZM10 14.625q.75 0 1.271-.531.521-.532.521-1.261 0-.75-.532-1.271-.531-.52-1.26-.52-.75 0-1.271.531-.521.531-.521 1.26 0 .75.532 1.271.531.521 1.26.521ZM7.458 6.667h5.084v-2q0-1.063-.74-1.823-.74-.761-1.802-.761t-1.802.761q-.74.76-.74 1.823Z'/%3E%3C/svg%3E");
		height 0
		width 1.25rem
		padding-top 1.25rem
		background-repeat no-repeat
		opacity .87
		margin-left .25rem
		background-image var(--closed-icon)
	
	.stickyIcon
		height 0
		width 1.25rem
		padding-top 1.25rem
		background-repeat no-repeat
		opacity .87
		margin-left .25rem
		background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='" + hsl(ss21OppColour) + "' d='M16,12V4H17V2H7V4H8V12L6,14V16H11.2V22H12.8V16H18V14L16,12Z' /%3E%3C/svg%3E")
	
	.archivedIcon
		height 0
		width 1.25rem
		padding-top 1.25rem
		background-repeat no-repeat
		opacity .87
		margin-left .25rem
		background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='" + hsl(ss21OppColour) + "' d='M19,8V5H5V8H9A3,3 0 0,0 12,11A3,3 0 0,0 15,8H19M19,3A2,2 0 0,1 21,5V12A2,2 0 0,1 19,14H5A2,2 0 0,1 3,12V5A2,2 0 0,1 5,3H19M3,15H9A3,3 0 0,0 12,18A3,3 0 0,0 15,15H21V19A2,2 0 0,1 19,21H5A2,2 0 0,1 3,19V15Z' /%3E%3C/svg%3E")
	
	.identityIcon
		height 0
		width 1.25rem
		padding-top 1.25rem
		background-repeat no-repeat
		opacity .87
		background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0z'/%3E%3Cpath fill='" + hsl(ss21OppColour) + "' d='M23 12l-2.44-2.79.34-3.69-3.61-.82-1.89-3.2L12 2.96 8.6 1.5 6.71 4.69 3.1 5.5l.34 3.7L1 12l2.44 2.79-.34 3.7 3.61.82L8.6 22.5l3.4-1.47 3.4 1.46 1.89-3.19 3.61-.82-.34-3.69L23 12zm-12.91 4.72l-3.8-3.81 1.48-1.48 2.32 2.33 5.85-5.87 1.48 1.48-7.33 7.35z'/%3E%3C/svg%3E")
	
	// XXX: on "retina" (`window.devicePixelRatio >= 2`) displays, 4chan x switches
	// to the @2x version of certain icons. until we switch the identityIcon to an
	// svg, force the icon to still render at the correct size
	.retina
		height 1.25rem
		width 1.25rem
	
	// 4CHANX: while shortcut icons are encouraged, if for some odd reason you
	// choose not to use them, still provide support
	:root.shortcut-icons #shortcuts .fa,
	:root.shortcut-icons .native-settings
		font-size 0
		visibility hidden
		
	:root:not(.shortcut-icons) #shortcuts .fa::after,
	:root:not(.shortcut-icons) .native-settings::after
		display none
	
	// generic classes used throughout 4chan and 4chan x
	// quoted text, a.k.a. >implying implications in current year, ishygddt
	:where(.quote)
		if ss21quoteColour
			color #789922
		else
			color ss21green
	
	// on /gd/'s pinned thread, quotes are hardcoded colour
	:where([style*="color:#789922"])
		if ss21quoteColour
			color #789922 i
		else
			color ss21green i
	
	// make warning text visually different
	.warning
		color ss21red
	
	// ($$$) add another potentially expensive override to inline-styled
	// elements to ensure they use our red, not `red` red
	[color="red"],
	[style*="color:red"],
	[style*="color: red"],
	[style*="color:#ff0000"],
	[style*="color:#FF0000"]
		color ss21red i
	
	:where(.hand)
		cursor pointer
	
	.move
		cursor grab
		overflow hidden
		&:active
			cursor grabbing
	
	// poster unique ids (/bant/, /biz/, /pol/, /qst/, /soc/)
	.posteruid
		font-size 0
		display inline-block
		//margin 0 .25rem
		.hand
			font-size .75rem
	
	// if enabled, poster unique id's are painted different colours to easily
	// identify posters
	.painted
		position relative
		padding .0625rem .25rem .125rem
		borderRadius()
		&::after
			content ''
			display block
			position absolute
			top 0
			left 0
			width 100%
			height 100%
			borderRadius()
			background-color rgba(0 0 0 .1)
			opacity 0
			transition opacity .25s
			pointer-events none
		&:hover::after
			opacity 1
	
	// 4CHANX: anti-autoplay
	// rarely happens, so this is just taken straight from 4chan x
	audio.controls-added
		display block
		margin auto
	:root.anti-autoplay
		div.embed
			position static
			width auto
			height auto
			text-align center
		.autoplay-removed
			visibility visible i
			min-width 640px
			min-height 360px
			margin auto // centers the media (usually an iframe) when shown
	
	// 4chan x header
	// offset the header and body when it's fixed
	// XXX: this first one might not be needed because we have the header transparent
	// until a certain scroll threshold
	
	//:root.fixed.top-header body
	//	padding-top 3rem
	
	//:root.fixed.bottom-header body
	//	padding-bottom 3rem
	
	#header-bar
		right 0
		left 0
		z-index 8
		background-color ss21primary
		tc(@background-color, high)
		if ss21opacityHeader
			background-color alpha(@background-color, .5)
			backdrop-filter blur(1rem)
		z-depth(4)
		position relative
		padding 0 1rem
		display flex
		align-items center
		justify-content space-between
		flex-wrap wrap
		will-change background-color, transform
		transition background-color .25s, transform .25s
	
	:root.fixed #header-bar
		position fixed
	
	:root.top-header #header-bar
		top 0
	
	:root.bottom-header #header-bar
		bottom 0
	
	// 4CHANX: if enabled, center the board links in the header
	:root.centered-links #board-list,
	:root.centered-links #header-bar .boardList
		justify-content center
	
	// autohide the header when not hovered
	:root.fixed.top-header #header-bar.autohide:not(:hover)
		margin-bottom -1rem
		transform translateY(-100%)
	
	:root.fixed.bottom-header #header-bar.autohide:not(:hover)
		transform translateY(100%)
	
	// XXX: better support for long board lists, whether it be scroll or flex-wrapping
	
	// when viewing the full board list, hide all the [, ], and /'s that are
	// used as dividers
	#full-board-list .boardList span
		display none
	
	// XXX: most of these styles are applied to #board-list because we want
	// shortcuts to always stay to the right
	/*
	#board-list
		display flex
		flex 1
		width 100%
		overflow auto hidden
		white-space nowrap // forces a scrollbar for long board lists
		a
			padding .25rem
	#board-list
		padding .5rem
	*/
	// XXX: i am sure this can go...
	/*
	#board-list,
	#custom-board-list,
	#full-board-list,
	#full-board-list .boardList
		display flex
		align-items center
	*/
	// SIDEDISH: button to toggle the off canvas menu
	.ss21--board-drawer-toggle
		display inline-flex
		align-items center
		justify-content center
		order -1
		cursor pointer
		min-width 3rem
		opacity .6
		will-change opacity
		transition opacity .25s
		&:hover
			opacity .87
	
	// 4CHANX: container for the board list, custom or not
	
	#board-list
		display flex
		flex 1
		width 100%
		user-select none
		margin-right .5rem
		//margin-bottom -1rem
		//padding -.5rem 0
		//margin -.75rem 0
		overflow auto hidden
		white-space nowrap
		a
			//text-transform lowercase
			display inline-flex
			align-items center
			justify-content center
			//position relative
			height 3rem
			min-width 2rem
			padding 0 .5rem
			transition opacity .25s
			/*
			if ss21headerHeight == 1
				height 3rem
			else if ss21headerHeight == 2
				height 2rem
				*/
			&:not(.current)
				opacity .7
				&:hover
					opacity .85
		.current
			box-shadow inset 0 -2px 0 invert(ss21primary)
			opacity 1
	
	#custom-board-list
		display flex
		align-items center
	
	/*
			&::after
				display none
				position absolute
				bottom 0
				left 0
				width 100%
				height 2px
				content ''
				pointer-events none
				background-color invert(ss21primary)
			&:hover::after,
			&.current::after
				display block*/
	/*
	if ss21headerHeight == 2
		#board-list a
			font-size .75rem
			min-width 2rem
		.ss21--board-drawer-toggle,
		.ss21--download-all,
		.shortcut .fa::after,
		.shortcut .menu-button::after
			font-size 18px // XXX: it's insane how bad this looks lmao
	*/
	// 4CHANX: in the event there are no shortcuts (not sure when this is),
	// hide the whole element
	#shortcuts:empty
		display none
	
	// 4CHANX: at some point, 4chan x may add `.autohiding-scrollbar`, so if this
	// affects you, we support you
	:root.autohiding-scrollbar #shortcuts
		margin-right 2rem
	
	#shortcuts
		display flex
		align-items center
		//position relative
		/*
		&::before
			content ''
			position absolute
			background-image linear-gradient(to right, rgba(0, 0, 0, 0), rgba(ss21primary, .8))
			pointer-events none
			height 100%
			width 1.5rem
			right 100%
	*/
	.shortcut
		//min-width 2rem
		/*
		if ss21headerHeight == 1
			height 3rem
		else if ss21headerHeight == 2
			height 2rem
		*/
		display inline-flex
		align-items center
		justify-content center
		//padding 0 .25rem
		padding .25rem
		a,
		.menu-button
			tc(ss21primary, medium)
			transition color .25s
		a:hover,
		.menu-button:hover,
		.menu-button.active,
		.fa-bolt:not(.disabled),
		#watcher-link:not(.disabled),
		.fa-comment-o:not(.disabled)
			tc(ss21primary, high)
	
		/*
		.fa::after,
		.menu-button::after,
		.native-settings::after
			tc(ss21primary, medium)
			transition color .25s
		.fa:hover::after,
		.menu-button.active::after,
		.menu-button:hover::after,
		.fa-bolt:not(.disabled)::after,
		#watcher-link:not(.disabled)::after,
		.fa-comment-o:not(.disabled)::after
			tc(ss21primary, high)
		& > .menu-button
			display inline-flex
	*/
	
	// 4CHANX: only show fappe/werk indicators when they're active
	:root:not(.fappeTyme) #shortcut-fappe,
	:root:not(.werkTyme) #shortcut-werk
		display none
	
	// 4CHANX: `#scroll-marker` is used to determine unread post position, amongst
	// other things
	#scroll-marker
		position absolute
		display none
		height 1rem
		right 0
		left 0
	
	#header-bar:not(.autohide) #scroll-marker
		pointer-events none
	
	:root.fixed #scroll-marker
		display block
	
	:root.fixed.top-header #scroll-marker
		top 100%
	
	:root.fixed.bottom-header #scroll-marker
		bottom 100%
	
	// SIDEDISH: we add a scrolling progress indicator
	// XXX: this only works if `#header-bar` is set to fixed
	#scroll-progress
		appearance none
		border 0
		position absolute
		top 100%
		left 0
		width 100%
		height .25rem
		opacity 0
		background-color var(--grey-500)
		will-change opacity
		transition opacity .25s
		pointer-events none
		&::-webkit-progress-bar
			background-color var(--grey-500)
		&::-webkit-progress-value
			background-color ss21green
		&::-moz-progress-bar
			background-color ss21green
	
	:root.bottom-header #scroll-progress
		top auto
		bottom 100%
	
	#header-bar.scrolled #scroll-progress
		opacity 1
	
	@media (max-width: 66rem)
		#header-bar
			padding 0 .5rem
		.ss21--board-drawer-toggle
			min-width 1.5rem
		#board-list a
			font-size .875rem
			min-width 1.5rem
		.shortcut
			min-width 1.5rem
			padding 0 .25rem
	
	// notifications
	// styled half-way between an alert and a snackbar
	/*
	4CHANX: here's the js to make a notification:
	document.dispatchEvent(new CustomEvent('CreateNotification', {
	detail: {
	type: 'success', // info, warning, error
	content: 'TEXT HERE',
	lifetime: 0
	}
	}));
	*/
	
	#notifications
		position fixed
		inset 0
		&:empty
			display none
	
	// this adjusts the notifications' y position when the header is hidden
	:root.fixed.top-header:not(.gallery-open) #notifications,
	:root.fixed.top-header #header-bar.autohide #notifications
		position absolute
		top 100%
	
	.notification
		color #fff // XXX: this should be text-on-primary
		display flex
		align-items center
		justify-content center
		padding .75rem .5rem .75rem .75rem // XXX: customisable
		borderRadius()
		margin .5rem auto
		width 50rem
		max-width 100% // XXX: responsive?
		z-depth(6)
		will-change opacity
		transition opacity .25s
		&.error
			background-color ss21red // 4chan x is 90% transparent (.9)
		&.info
			background-color ss21blue
		&.success
			background-color ss21green
		&.warning
			background-color ss21orange
		.message
			order -1
			flex-grow 1
			max-height 10rem
			white-space pre-line
			overflow auto
			a
				text-decoration solid underline
				text-decoration-skip ink
		.close
			display inline-flex
			align-items center
			margin-left .5rem
			opacity .6
			will-change opacity
			transition opacity .25s
			&:hover
				opacity .87
	
	// in the event of multiple 4chan x instances running
	:root.tainted .report-error
		display none
	
	// if enabled, show the board title as a customisable hero image
	if ss21boardBanner
		.boardBanner
			color rgba(255, 255, 255, .87)
			position relative
			display flex // XXX: was inline-flex, but left like a 8px margin between the bottom and next item
			flex-direction column
			align-items center
			justify-content center
			text-align center
			height 33vh
			width 100%
			//z-index -1
			background-image linear-gradient(45deg, #8c696f, #014c82)
			background-size 400% 400%
			overflow hidden
			user-select none
			contain layout
			transform translate3d(0, 0, 0)
			will-change transform
			//box-shadow inset 0 0 0px 20px red
			animation gradientShift 10s ease infinite
			&::after
				content ''
				display block
				//background red
				//background-image linear-gradient(to bottom, rgba(ss21BackgroundColour, 0), 80%, rgba(ss21BackgroundColour, 1))
				//box-shadow inset 0 0 50px 0 blue
				position absolute
				height calc(100% + 2rem)
				width calc(100% + 2rem)
				top -1rem
				left -1rem
				background-size cover
				background-repeat no-repeat
				background-position 50% 50%
				box-shadow inset 0 0 10rem 2rem #000
				filter blur(2px) saturate(.75)
				z-index -1
				pointer-events none
		@css {
			@keyframes gradientShift {
				0% {
					background-position: 84% 0%;
					}
				50% {
					background-position: 17% 100%;
					}
				100% {
					background-position: 84% 0%;
				}
			}
		}
		
		.ss21--op-banner
			position absolute
			height 100%
			width 100%
			filter blur(3px) saturate(.75)
			z-index 0
			object-fit cover
			transform scale(1.075)
			transform-origin 50% 50%
			pointer-events none
		
		.boardTitle
			font-size calc(100% + 5vw)
			color ss21BackgroundColour
			line-height 1
			text-transform lowercase
			--primary-500 ss21primary
			text-shadow 1rem 1rem 0 var(--primary-500)
			will-change text-shadow
			transition text-shadow .1s
			z-index 1
		
		// support for custom board titles in 4chan x, making it visually obvious they can be edited
		.boardTitle,
		.boardSubtitle
			white-space pre-line
			&[title]
				cursor help
			&[contenteditable="true"]
				cursor text
				border-bottom 1px dashed
		
		// since you ignored our request to block title cards, here's your support.
		// don't get upset if it doesn't work well
		#bannerCnt
			position absolute
			top 0
			left 0
			height 100%
			width 100%
			> img
				height 100%
				width 100%
				z-index 0
				object-fit cover
				filter blur(3px) saturate(.5)
	else
		body
			padding-top 3rem
		.boardBanner
			display none
		.navLinks.json-index
			margin 1rem auto i
	
	// SIDEDISH: check if the board banner was actually blocked
	:root.ss21--banner-blocked #bannerCnt
		display none
	
	// announcement hiding
	:root.hide-announcement .globalMessage
		display none
	
	// ideally the icon should just be a dismiss label button
	// and since the announcement is always inconsistent with h* and links,
	// it's difficult to style this consistently and per material spec
	// XXX: FIX FOR UNDER 75REM
	.globalMessage
		background-color ss21BackgroundElevated
		position fixed
		top 3rem
		width 100%
		padding 1rem 1.5rem
		display grid
		grid-template-columns 1fr auto 1fr
		z-index 3
		z-depth(6)
		transition top .25s
		&::before,
		&::after
			content ''
			display block
		&::before
			grid-column 1
		*
			margin 0
			grid-column 2
		&::after
			grid-column 3
		.hide-announcement-button
			position absolute
			display block
			opacity .55
			height 1.5rem
			top calc(50% - .75rem)
			grid-column 1
			transition opacity .25s
			&:hover
				opacity .84
	
	:root.top-header
		#header-bar.autohide ~ .globalMessage
			top 0
		#header-bar.scrolled ~ .globalMessage
			top .25rem
		#header-bar.scrolled:not(.autohide) ~ .globalMessage
			top 3.25rem
		//#header-bar.autohide.scrolled ~ .globalMessage
		//	top .5rem
	:root.bottom-header,
	:root.top-header:not(.fixed) #header-bar.scrolled ~ 
		.globalMessage
			top 0
	
	// blotter support - one day it'd be nice if 4chan x could hide this in a
	// similar fashion to announcement hiding, where it only shows when its
	// content changes
	if ss21blotter == 1
		#blotter
			display table i
			min-width 40rem
			max-width 100%
			margin 1rem auto 2.5rem // need to account for boardBanner being present or not, plus header-bar/autohide
			borderRadius()
			background-color ss21BackgroundElevated
			overflow hidden
			position relative
			tr:not(:only-child)
				if ss21readingMode == ss21light
					border-bottom 1px solid darken(ss21BackgroundElevated, 10%)
				else if ss21readingMode == ss21dark
					border-bottom 1px solid lighten(ss21BackgroundElevated, 15%)
			td
				padding .5rem 1rem
			thead
				background-color ss21primary
				color tc(ss21primary, high)
				td::before
					content '4chan blotter (barely updated, best kept hidden within ss21)'
			#blotter-msgs
				.blotter-date
					color var(--text-hint-on-background)
				.blotter-content a
					color ss21primary
			tfoot
				text-align right
				a
					color ss21primary
					transition color .25s
					&:hover
						color shade(ss21primary, 10%)
		.is_thread #blotter
			margin-bottom 1rem
	
	// XXX: if you unblock and want to see contest banners, you need to enable
	// this setting within ss21
	if ss21allowContest == 1
		.middlead
			display block i
			a
				display block
				width 468px
				height 60px
				margin 1rem auto 0
	
	// XXX: Thread closed. You may not reply at this time.
	.closed
		font-size 2rem
		font-weight 700
		text-align center
		background-color ss21red
		position relative
	
	// index sorting and what not. only enabled with json mode in 4chan x
	// first up, only some elements are shown, depending on which mode is enabled
	.indexlink, // hide the link to the original index
	.cataloglink, // hide the link to the original catalogue
	.archlistlink, // hide the link to the original archive
	.bottomlink, // hide the link that navigates to the bottom of the page
	:root:not(.paged-mode) .pagelist, // hide the page list except for when in paged mode
	:root:not(.catalog-mode) #hidden-label, // hide the hidden threads viewer except for when in catalogue mode
	:root:not(.catalog-mode) #index-size, // hide the thumbnail size option except for when in catalogue mode
	#index-search:not([data-searching]) + #index-search-clear // unless searching the index, hide the 'clear search' icon
		display none
	
	.navLinks.json-index
		background-color ss21primary
		tc(@background-color, high)
		//width 100%
		max-width 75rem
		padding .25rem 1.5rem
		margin -1.5rem auto 1.5rem
		position relative
		z-index 1
		display flex
		flex-wrap wrap
		align-items center
		justify-content center
		borderRadius()
		select
			background-color ss21BackgroundElevated
			tc(@background-color, high)
			margin-right .25rem
			&:last-child
				margin-right 0
	
	@media (max-width: 77rem)
		.navLinks.json-index
			margin -1.5rem 1rem 1.5rem
			max-width none
		#index-last-refresh,
		#hidden-label
			font-size .875rem
			min-width 0
			white-space nowrap
			overflow hidden
			text-overflow ellipsis
		#index-search
			max-width 10rem
	
	#index-search
		background-color ss21BackgroundElevated
		tc(@background-color, high)
		padding-right 1rem
		margin-left .5rem
	
	#hidden-label
		tc(ss21primary, medium)
		margin-left .5rem
	
	#index-rev
		visibility hidden
		width 1.5rem
		height 100%
		//margin 0 .25rem
		display inline-flex
		align-items center
		&::after
			visibility visible
			cursor pointer
		&:checked::after
			color var(--secondary)
	
	#index-options
		display flex
		align-items center
	
	#lastlong-options
		display inline-flex
		flex-direction column
		margin-right .25rem
		& > input
			font-family var(--font-monospace)
			text-align center
			background none
			height 50%
			width 2.25rem
			padding 0
			border 0
			margin 1px 0
	
	// replace the original clear search 'x' with an icon
	// XXX: `:focus` is off
	#index-search-clear
		font-size 0
		width 0
		&::after
			position relative
			color ss21red
			left -2rem
			opacity .54
			transition opacity .25s
		&:hover::after
			opacity .87
	
	// since `a` has `color: inherit`, a lot of the linked elements within
	// posts need to be recoloured
	// XXX: can still sometimes be too/under specific
	.postNum a:not(.replylink),
	.quotelink,
	.backlink,
	.embedder,
	.hashlink
		color ss21primary
		&:hover
			color shade(ss21primary, 15%)
	
	// a very crude and simple sidebar, for those that can't let go of oneechan
	if ss21sidebar != 0
		body
			if ss21sidebar == 1
				padding-right 25rem
			if ss21sidebar == 2
				padding-left 25rem
		/*
		.boardBanner
			position fixed
			width 25rem
			top 0
			right 0
			transform none i
			.boardTitle
				font-size 2rem
		.navLinks.json-index
			margin 4.5rem auto 1.5rem
		*/
		#id_css
			position fixed
			pointer-events none
			z-index -1
			bottom 0
			right 0
			display block
			opacity .45
			width 25rem
			height 25rem
			background-repeat no-repeat
			background-position 100% 100%
	
	.board
		padding 0 1rem
		if ss21boardCenter
			margin 1rem auto
			max-width 75rem
		else
			margin 1rem 0
		transition margin .25s
	
	.thread
		position relative
		padding 0 1.5rem
		margin-bottom 1rem // this collapses anyway
	
	.board .thread:last-of-type
		margin-bottom 0
	
	// XXX: if there are no search results from index
	:root.ss21--index-searching .board:empty::after
		content 'no results; try another search term'
		color var(--text-secondary-on-background)
		display flex
		justify-content center
		align-items center
		min-height 10rem
		if ss21twoWide
			grid-column span 2
	
	if ss21twoWide
		@media (min-width: 75rem)
			:root.paged-mode .is_index .board
				max-width none
				display grid
				grid-gap 0
				grid-template-columns repeat(2, 50%)
				.thread:last-of-type:nth-of-type(odd)
					grid-column span 2
	
	.postContainer
		position relative
		margin-bottom 1rem
		if ss21postWidth
			max-width 100%
		else
			display table
	
	.thread .postContainer:last-of-type
		margin-bottom 0
	
	.post
		display flow-root
		background-color var(--background-primary)
		//padding .75rem 1rem
		borderRadius()
		max-width 100%
		transition background-color .25s
	
	if ss21flatness == 2
		.post,
		.catalog-post,
		.summary,
		.stub,
		#menu,
		.submenu
			if ss21readingMode == ss21light
				border 1px solid darken(ss21BackgroundElevated, 10%)
			else if ss21readingMode == ss21dark
				border 1px solid lighten(ss21BackgroundElevated, 15%)
	
	// XXX: when fappe tyme enabled, this won't work due to the elements retaining
	// their odd or even-ness in the dom tree
	if ss21evenPosts
		.postContainer:nth-of-type(even) > .post
			if ss21readingMode == ss21light
				background-color darken(ss21BackgroundElevated, 3%)
			else if ss21readingMode == ss21dark
				background-color lighten(ss21BackgroundElevated, 5%)
	
	// XXX: USE GAP FOR ALL THE POST INFO ELEMENTS
	:where(.postContainer) > :where(.post) > .postInfo
		if ss21readingMode == ss21light
			background-color rgba(33, 33, 33, .02)
		else if ss21readingMode == ss21dark
			background-color rgba(255, 255, 255, .05)
		display flex
		flex-flow row wrap
		align-items center
		//flex-wrap nowrap // XXX: not ideal, especially on boards like /pol/
		//padding .125rem 4rem .25rem 1rem
		padding .125rem 4rem .125rem .5rem
		// XXX: provides space for menu/hide button on long post infos
		//height 1.75rem XXX: 2021-12 the cut off subjects always bothered me
		gap 0 .25rem
		borderRadius()
		border-bottom-left-radius 0
		border-bottom-right-radius 0
	
	.noFile > .post > .postInfo
		if ss21readingMode == ss21light
			box-shadow 0 1px 0 0 darken(ss21BackgroundElevated, 10%)
		else if ss21readingMode == ss21dark
			box-shadow 0 1px 0 0 lighten(ss21BackgroundElevated, 15%)
	
	.subject
		&:empty
			display none
	
	.nameBlock
		//margin-right .25rem
		display inline-flex
		align-items center
		gap 0 .25rem
	
	if ss21forcedAnon == 1
		.nameBlock
			display none
		.subject:not(:empty)::after
			display none i
		.subject
			//margin-right .25rem
	
	// if a post from a new ip is added to a thread, 4chan x makes a guess that
	// the recent posts are of that new ip and adds an indicator
	// XXX: make this consistent
	.ip-counter
		color var(--text-hint-on-background)
		//margin-left .25rem
	
	.dateTime
		color var(--text-hint-on-background)
		//margin-right .25rem
	
	.page-num
		color var(--text-hint-on-background)
		margin-left .25rem
	
	.postNum
		display inline-flex
		align-items center
	
	// coverts the "No.6900" into "#6900", where the '#' functions the same
	// as the 'No.'
	.postNum
		> a:first-child
			font-size 0
			&::after
				content '#'
				font-size 1rem
		> span:last-child
			font-size 0
	
	.postMessage
		padding .5rem .75rem // XXX: was `.75rem 1.5rem`
		&:empty
			display none
	
	// make subjects look nice by adding 'by'
	.subject:not(:empty)::after
		content ' by'
		color var(--text-hint-on-background)
		font-weight 400
		//margin 0 .25rem
	
	// XXX: thread summaries are targeted in sidedish to make the numbers
	// wrapped in bold
	.summary
		display block
		text-align center
		background-color var(--background-primary)
		line-height 3
		margin-top 1px
		z-index 1
		position relative
		borderRadius()
		&:focus
			box-shadow 0 0 0 .25rem alpha(lighten(ss21primary, 50%), .25)
	
	// XXX: when a thread is expanded on index, maintain our usual margins
	.is_index .summary + .postContainer,
	.summary-bottom
		margin-top 1rem
	
	.is_thread .summary
		display none
	
	if ss21postWidth == 0
		.summary
			display inline-block
			padding 0 1rem
	
	if ss21openThread == 1
		// get rid if [View] / [Reply]
		.postNum span:last-child
			display none
		// give the FAB a bit more breathing room
		.thread
			margin-bottom 1.5rem
		// turn it into a FAB
		.summary
			//all unset
			margin-top 0
			border 0
			tc(ss21primary, high)
			display flex
			align-items center
			background-color ss21primary
			font-size 0
			border-radius 1.5rem
			height 1.5rem
			padding 0 .75rem
			position absolute
			top -.75rem
			right 6rem
			z-index 2
			transition background-color .25s
			z-depth(2)
			&:hover
				background-color lighten(ss21primary, 5%)
			b
				font-size .875rem
				font-weight 400
				&:last-child:not(:only-child)::before
					content ' / '
					tc(ss21primary, low)
					margin-left .25rem
	
	// Comment too long, and also EXIF data on /p/
	.abbr
		color var(--text-hint-on-background)
		a
			color alpha(ss21primary, .54)
			&:hover
				color alpha(ss21primary, .87)
	
	// EXIF data table
	.exif
		display none
		font-size .75rem
	
	// on october 1st, we celebrate 4chan's birthday (est. 2003)
	.party-hat
		position absolute
		margin-top -2.5rem
		left 0
		z-index 1
		opacity .87
		pointer-events none
	
	// 4CHANX: quote previews (hovering over quotelinks and backlinks) along
	// with image hovering (and youtube thumbnails).
	// XXX: `#qp` has no children, just the text content 'Loading post No. XXX'
	#qp,
	#ihover
		position fixed
		z-index 15
		background-color var(--background-primary)
		borderRadius()
		z-depth(8)
	#qp
		& > .postContainer
			margin 0
		&.warning
			padding .5rem 1rem
		img // XXX: would this even work? straight from 4chan x but like, what about videos?
			max-height 80vh
			max-width 50vw
	#ihover
		pointer-events none
		max-height 95vh
		max-width 100vw
	
	// 4CHANX: quote threading (we reddit now)
	.threadContainer
		position relative
		margin 0 0 1rem 1rem // bottom margin is the usual offset, left is the indent
		&::before
			content ''
			position absolute
			left -.5rem
			top -1rem
			display block
			width 2px
			height 100%
			background-color var(--background-primary)
	
	// 4chan x has border-left: 1px solid rgba(128,128,128,.3);
	// it also uses .threadOP clear both but i don't think we have that issue
	
	// 4CHANX: thread and reply hiding, and stubs
	.hide-thread-button,
	.hide-reply-button
		position absolute
		top 0
		right 2.75rem
		opacity 0
		z-index 1
		will-change opacity
		display inline-flex
		align-items center
		height 1.75rem
		transition opacity .25s
		&:focus
			opacity .54
		& > span
			display inline-flex
			align-items center
	
	// XXX: high specificity to only show the button for the post being hovered
	.postContainer:hover > .hide-thread-button,
	.postContainer:hover > div > .hide-reply-button
		opacity .54
		&:hover
			opacity .87
	
	// XXX: stubs are gross and horrible. hopefully they are rewritten soon(tm)
	// and then they can be given some better love
	// icon black on white, active+focus .87
	// icon black on white, active+NOT focused .54
	// icon black on white, inactive .38
	
	// .stub ~ * is probably a little too expensive $$$ - but it's there because
	// if json index is off and replies are shown, it covers all bases
	.stub ~ *
		display none
	
	.stub
		display flex
		align-items center
		justify-content left
		padding .5rem 1rem
		height 3rem
		background-color var(--background-primary)
		borderRadius()
		.show-thread-button,
		.show-reply-button
			flex 1
			display flex
			align-items center
			> .fa
				display inline-flex
				margin-right .5rem
				&::after
					opacity .54
					transition opacity .25s
			&:hover .fa::after
				opacity .87
	
	// file formatting
	.file
		color var(--text-hint-on-background)
		position relative
	/*
<div class="file" id="f82365267"><div class="fileText" id="fT82365267"><span class="file-info"><a href="https://i.4cdn.org/g/1625305273170.jpg" target="_blank">4327773466e141f8b5cdbf29b5c4ad3b.jpeg.1280x0_q85-4327773466e141f8b5cdbf29b5c4ad3b.jpeg.1280x0_q85.jpg</a> (153 KB, 1200x1600) <a href="https://i.4cdn.org/g/1625305273170.jpg" download="4327773466e141f8b5cdbf29b5c4ad3b.jpeg.1280x0_q85-4327773466e141f8b5cdbf29b5c4ad3b.jpeg.1280x0_q85.jpg" class="fa fa-download download-button"></a> <a href="javascript:;" class="fa fa-times quick-filter-md5"></a></span><span class="fileText-original">File: <a title="4327773466e141f8b5cdbf29b5c4ad3b.jpeg.1280x0_q85-4327773466e141f8b5cdbf29b5c4ad3b.jpeg.1280x0_q85.jpg" href="https://i.4cdn.org/g/1625305273170.jpg" target="_blank">4327773466e141f8b5cdbf29b(...).jpg</a> (153 KB, 1200x1600)</span> <a target="_blank" class="sauce" href="https://www.google.com.au/searchbyimage?image_url=https%3A%2F%2Fi.4cdn.org%2Fg%2F1625305273170.jpg&amp;safe=off">g</a> <a target="_blank" class="sauce" href="https://yandex.com/images/search?rpt=imageview&amp;url=https%3A%2F%2Fi.4cdn.org%2Fg%2F1625305273170.jpg">yan</a> <a target="_blank" class="sauce" href="//iqdb.org/?url=https%3A%2F%2Fi.4cdn.org%2Fg%2F1625305273170.jpg">iqdb</a> <a target="_blank" class="sauce" href="https://trace.moe/?auto&amp;url=https%3A%2F%2Fi.4cdn.org%2Fg%2F1625305273170.jpg">trace</a> <a target="_blank" class="sauce" href="//saucenao.com/search.php?url=https%3A%2F%2Fi.4cdn.org%2Fg%2F1625305273170.jpg">sauce</a></div><a class="fileThumb" href="https://i.4cdn.org/g/1625305273170.jpg" target="_blank"><img src="//i.4cdn.org/g/1625305273170s.jpg" alt="153 KB" data-md5="xVHNvpcDjD6lFlYEvST5Pw==" style="height: 250px; width: 187px;" loading="lazy"></a></div>

<div class="fileText" id="fT4662288"><span class="file-info"><a href="https://i.4cdn.org/qa/1625528343446.jpg" target="_blank">__shikinami_asuka_langley_and_souryuu_asuka_langley_evangelion_3_0_you_can_not_redo_neon_genesis_evangelion_and_rebuild_of_evangelion_drawn_by_rabbit_wlsdnjs950__7da53d97f3f82326f2420446d168ddcc.jpg</a> (103 KB, 609x1000) <a href="https://i.4cdn.org/qa/1625528343446.jpg" download="__shikinami_asuka_langley_and_souryuu_asuka_langley_evangelion_3_0_you_can_not_redo_neon_genesis_evangelion_and_rebuild_of_evangelion_drawn_by_rabbit_wlsdnjs950__7da53d97f3f82326f2420446d168ddcc.jpg" class="fa fa-download download-button"></a> <a href="javascript:;" class="fa fa-times quick-filter-md5"></a></span><span class="fileText-original">File: <a title="__shikinami_asuka_langley_and_souryuu_asuka_langley_evangelion_3_0_you_can_not_redo_neon_genesis_evangelion_and_rebuild_of_evangelion_drawn_by_rabbit_wlsdnjs950__7da53d97f3f82326f2420446d168ddcc.jpg" href="https://i.4cdn.org/qa/1625528343446.jpg" target="_blank">__shikinami_asuka_langley(...).jpg</a> (103 KB, 609x1000)</span> <a target="_blank" class="sauce" href="https://www.google.com.au/searchbyimage?image_url=https%3A%2F%2Fi.4cdn.org%2Fqa%2F1625528343446.jpg&amp;safe=off">g</a> <a target="_blank" class="sauce" href="https://yandex.com/images/search?rpt=imageview&amp;url=https%3A%2F%2Fi.4cdn.org%2Fqa%2F1625528343446.jpg">yan</a> <a target="_blank" class="sauce" href="//iqdb.org/?url=https%3A%2F%2Fi.4cdn.org%2Fqa%2F1625528343446.jpg">iqdb</a> <a target="_blank" class="sauce" href="https://trace.moe/?auto&amp;url=https%3A%2F%2Fi.4cdn.org%2Fqa%2F1625528343446.jpg">trace</a> <a target="_blank" class="sauce" href="//saucenao.com/search.php?url=https%3A%2F%2Fi.4cdn.org%2Fqa%2F1625528343446.jpg">sauce</a></div>


<blockquote class="postMessage" id="m149986685"><a href="//boards.4chan.org/r/#s=eddit" class="quotelink">&gt;&gt;&gt;/r/eddit</a></blockquote>
	*/
	.fileText
		--file-gap .25rem
		font-size .75rem
		position relative
		display flex
		align-items center
		gap var(--file-gap)
		white-space normal // copied from 4chan x
		padding-inline .5rem
		padding-block-end .25rem
		if ss21readingMode == ss21light
			background-color rgba(33, 33, 33, .02)
		else if ss21readingMode == ss21dark
			background-color rgba(255, 255, 255, .05)
		if ss21readingMode == ss21light
			box-shadow inset 0 -1px 0 0 darken(ss21BackgroundElevated, 10%)
		else if ss21readingMode == ss21dark
			box-shadow inset 0 -1px 0 0 lighten(ss21BackgroundElevated, 15%)
		a
			color ss21primary
			unicode-bidi isolate // used to counter "malicious" filenames
			&:hover
				color shade(ss21primary, 10%)
		> a
			flex 0 0 auto
		.file-info
			display flex
			flex-wrap nowrap
			align-items center
			min-width 0
			white-space nowrap
			&:has(.fnswitch)
				white-space nowrap
			gap var(--file-gap)
			a:has(> .fnswitch)
				display contents
				white-space initial
			a[target]:not(:has(> .fnswitch))
				white-space nowrap
				overflow hidden
				text-overflow ellipsis
				&:hover
					white-space initial
					overflow initial
					text-overflow initial
			.download-button,
			.quick-filter-md5
				display contents // treat the icons as if they were just there
				align-self flex-end
				&::after
					font-size 1rem // make the icon slightly bigger than the font
					inline-size .75rem
	
	.fileText-original, // the original file text
	.fnswitch:hover > .fntrunc, // when hovering over a filename, hide the truncated version
	.fnswitch:not(:hover) > .fnfull, // when not hovering over a truncated version, hide the full filename
	.expanded-image > .post > .file > .fileThumb > video[data-md5], // when expanded, hide the thumbnail
	.expanded-image > .post > .file > .fileThumb > img[data-md5] // when expanded, hide the thumbnail
		display none
	
	// XXX: these are very specific as to not effect inlined posts
	.expanded-image > .post > .file > .fileThumb > .full-image
		display block
	
	// this is actually `.postContainer`
	.expanded-image
		clear left
		overflow-wrap normal // XXX: this should force text to go under an expanded image if it would be wrapped otherwise
	
	// `.fileThumb > img:first-child`
	.expanding
		opacity .5
	
	:root.fit-height .full-image
		max-height 100vh
	
	:root.fit-height.fixed .full-image
		max-height calc(100vh - 4rem)
	
	// XXX: these might not be needed since we make media responsive
	:root.fit-width .full-image
		max-width 100%
	
	:root.ua-gecko.fit-width .full-image
		width 100%
	/*
	.is_thread .expanded-image.file--wide
		.fileThumb
			margin 0
			opacity 1
			float none
			display block
		.full-image
			max-width none
			width 80vw
			position relative
			left calc(-40vw + (70rem / 2) - 2rem)
	*/
	.fileThumb
		float left
		margin .5rem
		if ss21readingMode == ss21dark
			opacity .8
		& > .warning
			clear both // if the file is deleted
		img[alt]
			borderRadius()
	
	/*
	<a class="fileThumb" href="https://i.4cdn.org/pol/1628658711552.webm" target="_blank"><img src="//i.4cdn.org/pol/1628658711552s.jpg" alt="2.26 MB" data-md5="usgTmBCj/BQFUGOYBO2zpg==" style="height: 125px; width: 125px;" loading="lazy" class=""><div class="warning">Error: Corrupt or unplayable video</div><div data-tip="" data-tip-cb="mShowFull" class="mFileInfo mobile">2.26 MB WEBM</div></a>
	this is what the html looks like with an error, which messes up webms
	*/
	
	span.fileThumb
		if ss21readingMode == ss21light
			background-color rgba(33, 33, 33, .02)
		else if ss21readingMode == ss21dark
			background-color rgba(255, 255, 255, .05)
		borderRadius()
		border 1px solid rgba(ss21red, .5)
		padding 1rem
		display inline-flex
		flex-direction column
		align-items center
		justify-content center
		&::before
			font-size 3rem
			color rgba(ss21red, .84)
			text-align center
		&::after
			content 'File deleted.'
			color var(--text-secondary-on-background)
		img
			display none
	
	// in the event the file is deleted, this is what the HTML becomes
	/*
	<span class="fileThumb">
	<img src="//s.4cdn.org/image/filedeleted-res.gif" alt="File deleted." class="fileDeletedRes retina">
	</span>
	*/
	
	// 4CHANX: `.webm` metadata
	.webm-title
		& > a::before
			content 'title'
		&.loading > a::after
			content '...'
		&.error > a:hover::before
			content 'error'
		& > span
			cursor text
		&.not-found > span::before
			content 'not found'
		&:not(:hover) > span,
		&:hover > span + a
			display none
	/*
	// make the icons you can add to the file info a little smaller
	// XXX: needs better vertical alignment
	.download-button,
	.quick-filter-md5
		&::after
			font-size 1rem
	
	// XXX: convert sauce links to icons for fun
	// XXX: on mac + chrome, have to add `white-space: pre` otherwise it still renders
	// the text
	.sauce[href*='google']
		color transparent i
		display inline-block
		white-space pre
		width .75rem
		opacity .54
		background-repeat no-repeat
		background-position 50% 50%
		background-image url("data:image/svg+xml,%3Csvg viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12.24 10.285V14.4h6.806c-.275 1.765-2.056 5.174-6.806 5.174-4.095 0-7.439-3.389-7.439-7.574s3.345-7.574 7.439-7.574c2.33 0 3.891.989 4.785 1.849l3.254-3.138C18.189 1.186 15.479 0 12.24 0c-6.635 0-12 5.365-12 12s5.365 12 12 12c6.926 0 11.52-4.869 11.52-11.726 0-.788-.085-1.39-.189-1.989H12.24z' fill='" + hsl(ss21primary) + "' /%3E%3C/svg%3E")
		transition opacity .25s
		&:hover
			opacity .8
	
	.file--huge > .post > .file .fileText .sauce[href*='google']
		color transparent
		background-image url("data:image/svg+xml,%3Csvg viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12.24 10.285V14.4h6.806c-.275 1.765-2.056 5.174-6.806 5.174-4.095 0-7.439-3.389-7.439-7.574s3.345-7.574 7.439-7.574c2.33 0 3.891.989 4.785 1.849l3.254-3.138C18.189 1.186 15.479 0 12.24 0c-6.635 0-12 5.365-12 12s5.365 12 12 12c6.926 0 11.52-4.869 11.52-11.726 0-.788-.085-1.39-.189-1.989H12.24z' fill='" + hsl(ss21green) + "' /%3E%3C/svg%3E")
	*/
	if ss21thumbnailOpacity == 1
		.fileThumb
			opacity .05
			transition opacity .25s
			&:hover
				opacity .15
	
	if ss21fileInfo == 2
		.postInfo
			if ss21readingMode == ss21light
				box-shadow 0 1px 0 0 darken(ss21BackgroundElevated, 10%)
			else if ss21readingMode == ss21dark
				box-shadow 0 1px 0 0 lighten(ss21BackgroundElevated, 15%)
		.file .fileText
			pointer-events none
			opacity 0
			position absolute
			z-index 1
			borderRadius()
			background-color ss21BackgroundColour
			box-shadow none
			padding .25rem .5rem
			max-width fit-content
			top 0
			transition transform .25s, opacity .25s
			transform-origin left bottom
			transform scale(0) translateY(-15%)
		.file:hover,
		:root.keyboard-focus .file:focus-within,
		:root.werkTyme .post:hover
			.fileText
				pointer-events auto
				transform scale(1) translateY(-70%)
				opacity .9
				display flex
	
	//@var checkbox   ss21fileCard         "Turns files into a card as opposed to the classic look" 0
	if ss21fileInfo == 3
		.file,
		.file a,
		.file span,
		.fileText
			all unset
		.fileText-original
			display none i
		.file
			display flex
			flex-direction column
			float inline-start
			margin .5rem
			background-color lighten(ss21BackgroundElevated, 3%)
			borderRadius()
			overflow hidden
			z-depth(4)
			width 150px
		.expanded-image .file
			width auto
		.fileThumb
			order 1
			display block
			cursor pointer
			width 100%
			img
				object-fit cover
				width 100% i
		.fileText
			order 2
			font-size .75rem
			padding .25rem .5rem
			.file-info
				display block
				white-space initial
			a
				color ss21primary
				cursor pointer
				&:hover
					color shade(ss21primary, 10%)
	
	/**
	 * fancy underline animation, courtesy of https://theoutline.com
	 * https://www.news47ell.com/articles/use-svg-css-instead-text-decoration-underline/
	 * https://codepen.io/tigt/post/optimizing-svgs-in-data-uris
	 * thanks to stylus we can just escape at the right point in the string to add the
	 * variable'd colour. otherwise, we would not be able to access css variables
	 * from within an escaped svg within css added to the page
	 */
	.forwardlink
		background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 4'%3E%3Cpath fill='none' stroke='" + hsl(ss21primary) + "' class='s' d='M0 3.5c5 0 5-3 10-3s5 3 10 3 5-3 10-3 5 3 10 3'/%3E%3Cstyle%3E.s %7B animation: shift 0.3s linear infinite; %7D @keyframes shift %7B from %7B transform: translateX(0); %7D to %7B transform: translateX(-20px); %7D %7D%3C/style%3E%3C/svg%3E")
		background-position 0 100%
		background-size auto 3px
		background-repeat repeat-x
	
	.hashlink::before
		content ' '
	
	.filtered,
	.deadlink
		text-decoration line-through i // only because of the highly specific "links in a post" selector earlier
		opacity .6
	
	:root.hide-backlinks .backlink.filtered,
	:root.hide-backlinks .backlink.filtered + .hashlink.filtered
		display none
	
	.inlined
		opacity .6
	
	.inline
		display flow-root
		font-size 1rem
		clear both
		margin .5rem
		borderRadius()
		z-depth(2)
	
	// XXX: make special kinds of quotelinks appear `sup`-scripted
	+prefix-classes('qmark-')
		.ct
			font-size 0
			&::after
				content ' (CT)'
		.op,
		.you,
		.ct::after,
		.dead
			position relative
			font-size .75rem
			vertical-align baseline
			top -.5em
			left -.25ch
	
	// 4CHANX: backlinks
	:where(.container)
		display block
		font-size .75rem
		font-family var(--font-monospace)
		width 100%
		clear both // clears bottom container under file thumbnails
	.backlink.deadlink
		text-decoration none i // XXX: why !important (earlier)
	
	// top backlinks, enforcing the 'quoted by' style
	:where(:root:not(.bottom-backlinks)) :where(.container:not(:empty))
		color var(--text-hint-on-background)
		padding-inline-start .5rem
		&::before
			content 'quoted by: '
		&::after
			content '.'
		:where(.backlink:not(:only-of-type):not(:last-of-type))::after
			content ', '
			color var(--text-hint-on-background)
		:where(.backlink:not(:only-of-type):last-of-type)::before
			content ' and '
			color var(--text-hint-on-background)
	
	// bottom backlinks
	:where(:root.bottom-backlinks) :where(.container)
		padding .125rem .5rem
		if ss21readingMode == ss21light
			background-color rgba(33, 33, 33, .02)
			box-shadow inset 0 1px 0 0 darken(ss21BackgroundElevated, 10%)
		else if ss21readingMode == ss21dark
			background-color rgba(255, 255, 255, .05)
			box-shadow inset 0 1px 0 0 lighten(ss21BackgroundElevated, 15%)
	
	if ss21backlinkStyle == 2
		:where(.container)
			display flex
			flex-wrap wrap
		:where(.container) :where(.backlink)
			font-size 0
		:where(.container) :where(.backlink)::after
			content 'reply'
			font-family 'Material Symbols Outlined'
			font-weight normal
			font-style normal
			font-size 18px
			line-height: 1
			letter-spacing normal
			text-transform none
			display inline-flex // better vertical alignment
			justify-content center
			align-items center
			white-space nowrap
			word-wrap normal
			direction ltr
			-webkit-font-feature-settings 'liga'
			-webkit-font-smoothing antialiased
			color ss21primary
			font-variation-settings 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 24
			opacity .54
			will-change opacity
			transition opacity .25s
		:where(.container) :where(.backlink):hover::after
			opacity .87
		:where(.backlink.deadlink) span
			display none // removes the qmarks from dead backlinks
	
	/*
	<a href="#p91030252" class="backlink deadlink">#91030252<span class="qmark-dead">&nbsp;(Dead)</span></a>
	*/
	
	:where(.container:empty)
		display none
	
	// 4CHANX: fappe and werk tyme support, including shortcuts indicators
	.indicator
		font-size 0
		color #fff
		background-color invert(ss21primary)
		display inline-flex
		align-items center
		justify-content center
		height 2rem
		width 2rem
		borderRadius()
		cursor pointer
	
	:root.fappeTyme .thread > .noFile,
	:root.fappeTyme .threadContainer > .noFile
		display none
	
	:root.werkTyme .postContainer:not(.noFile) .fileThumb,
	:root.werkTyme .catalog-thumb:not(.deleted-file):not(.no-file),
	:root:not(.werkTyme) .werkTyme-filename
		display none
	
	// 4CHANX: post highlighting and filter effects
	// some of these will only work if you added the filters i asked you to install
	.postContainer > .post:target, // for when a post is quoted in the url
	.filter-highlight > .post, // posts that match the default 4chan x highlight filter
	.highlight, // ???
	.postContainer > .qphl, // the current post being previewed from the post list
	:root.highlight-own .yourPost > .post, // post that is marked as your own
	:root.highlight-own .yourPost .stub // stubs of posts marked as your own
		background-color mix(#FFECB3, ss21BackgroundElevated, 7%) i
	
	:root.highlight-you .quotesYou > .post // replies to posts marked as your own
		background-color mix(#FFCDD2, ss21BackgroundElevated, 7%)
	
	// when in catalogue mode, give threads a red glow to show they are highlighted
	// XXX: probably can be simplified in our version of the catalogue
	:root:not(.werkTyme) .catalog-thread.filter-highlight .catalog-thumb,
	:root.werkTyme .catalog-thread.filter-highlight:not(:hover),
	:root.werkTyme:not(.catalog-hover-expand) .catalog-thread.filter-highlight,
	:root.werkTyme.catalog-hover-expand .catalog-thread.filter-highlight > .catalog-container:hover > .catalog-post,
	:root.catalog .thread.filter-highlight
		box-shadow 0 0 3px 3px rgba(255, 0, 0, .5)
	
	// when in catalogue mode, give watched threads a red outline
	// XXX: same here
	:root:not(.werkTyme) .catalog-thread.watched .catalog-thumb,
	:root:root.werkTyme .catalog-thread.watched:not(:hover),
	:root:root.werkTyme:not(.catalog-hover-expand) .catalog-thread.watched,
	:root.werkTyme.catalog-hover-expand .catalog-thread.watched > .catalog-container:hover > .catalog-post
		border 2px solid rgba(255, 0, 0, .75)
	
	// XXX: needs to be coincided with normal .fileText
	.file--huge > .post > .file > .fileText > .file-info > a:first-child
		color ss21green
		&:hover
			color darken(ss21green, 10%)
	
	.postContainer.post--hot > .post
		background-image linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(140, 35, 50, .33))
	/*
url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='" + hsl(ss21poster(admin)) + "' viewBox='0 0 16 16'%3E%3Cpath d='M10.067.87a2.89 2.89 0 0 0-4.134 0l-.622.638-.89-.011a2.89 2.89 0 0 0-2.924 2.924l.01.89-.636.622a2.89 2.89 0 0 0 0 4.134l.637.622-.011.89a2.89 2.89 0 0 0 2.924 2.924l.89-.01.622.636a2.89 2.89 0 0 0 4.134 0l.622-.637.89.011a2.89 2.89 0 0 0 2.924-2.924l-.01-.89.636-.622a2.89 2.89 0 0 0 0-4.134l-.637-.622.011-.89a2.89 2.89 0 0 0-2.924-2.924l-.89.01-.622-.636zm.287 5.984-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 1 1 .708-.708L7 8.793l2.646-2.647a.5.5 0 0 1 .708.708z'/%3E%3C/svg%3E")
*/
	.postContainer.poster--admin
		> .post
			background-color mix(ss21posterAdmin, ss21BackgroundColour, 10%)
			.identityIcon
				background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0z'/%3E%3Cpath fill='" + hsl(ss21poster(admin)) + "' d='M23 12l-2.44-2.79.34-3.69-3.61-.82-1.89-3.2L12 2.96 8.6 1.5 6.71 4.69 3.1 5.5l.34 3.7L1 12l2.44 2.79-.34 3.7 3.61.82L8.6 22.5l3.4-1.47 3.4 1.46 1.89-3.19 3.61-.82-.34-3.69L23 12zm-12.91 4.72l-3.8-3.81 1.48-1.48 2.32 2.33 5.85-5.87 1.48 1.48-7.33 7.35z'/%3E%3C/svg%3E")
			> .postInfo > .nameBlock
				color ss21posterAdmin
	
	.stub:has(+ .poster--mod)
		background-color mix(ss21posterAdmin, ss21BackgroundColour, 10%)
	
	.postContainer.poster--mod
		> .post
			background-color mix(ss21poster(mod), ss21BackgroundColour, 10%)
			.identityIcon
				background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0z'/%3E%3Cpath fill='" + hsl(ss21poster(mod)) + "' d='M23 12l-2.44-2.79.34-3.69-3.61-.82-1.89-3.2L12 2.96 8.6 1.5 6.71 4.69 3.1 5.5l.34 3.7L1 12l2.44 2.79-.34 3.7 3.61.82L8.6 22.5l3.4-1.47 3.4 1.46 1.89-3.19 3.61-.82-.34-3.69L23 12zm-12.91 4.72l-3.8-3.81 1.48-1.48 2.32 2.33 5.85-5.87 1.48 1.48-7.33 7.35z'/%3E%3C/svg%3E")
			> .postInfo > .nameBlock
				color ss21poster(mod)
	
	.stub:has(+ .poster--mod)
		background-color mix(ss21poster(mod), ss21BackgroundColour, 10%)
	
	.postContainer.poster--verified
		> .post
			background-color mix(ss21posterVerified, ss21BackgroundColour, 10%)
			.identityIcon
				background-image url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='none' d='M0 0h24v24H0z'/%3E%3Cpath fill='" + hsl(ss21poster(verified)) + "' d='M23 12l-2.44-2.79.34-3.69-3.61-.82-1.89-3.2L12 2.96 8.6 1.5 6.71 4.69 3.1 5.5l.34 3.7L1 12l2.44 2.79-.34 3.7 3.61.82L8.6 22.5l3.4-1.47 3.4 1.46 1.89-3.19 3.61-.82-.34-3.69L23 12zm-12.91 4.72l-3.8-3.81 1.48-1.48 2.32 2.33 5.85-5.87 1.48 1.48-7.33 7.35z'/%3E%3C/svg%3E")
			> .postInfo > .nameBlock
				color ss21posterVerified
	
	:where(:root:not(.anonymize)) :where(.postContainer.poster--pass)
		> .post
			background-color mix(ss21posterPass, ss21BackgroundColour, 10%)
			> .postInfo > .nameBlock
				color ss21posterPass
		+ :where(.summary)
			background-color mix(ss21posterPass, ss21BackgroundColour, 10%)
	
	.postContainer.post--aus
		> .post
			background-color mix(blue, ss21BackgroundColour, 3%)
	
	.n-pu
		display inline-flex
		&::after
			font-size 20px //XXX: what is with this inconsistent icon sizing???
			opacity .54
	
	// give webms and gifs a little visual icon overlay
	// XXX: if a thumbnail is <32px high, the icon is higher than that
	.file--gif,
	.file--video
		.fileThumb
			position relative
		&:not(.expanded-image) > .post > .file
			& > .fileThumb::after
				font-size 3rem
				position absolute
				inset 0
				display inline-flex
				align-items center;
				justify-content center
				background-image linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 1))
				color #fff
				opacity .8
				will-change opacity
				transition opacity .25s
				pointer-events none
				overflow hidden
			&:hover > .fileThumb::after
				opacity .6
	
	.thread-chip--mire .post
		background-color mix(pink, ss21BackgroundColour, 10%)
	
	.post--dubs
		will-change transform
		transform perspective(1px) translateZ(0)
		animation buzz .25s linear infinite
		z-index 1 // for some reason the menu gets offset when transformed
		.postNum a:nth-child(2n)::after
			color ss21green
			vertical-align text-bottom
			margin-left .25rem
			pointer-events none
	
	@css {
		@keyframes buzz {
			50% {
				transform: translateX(2px) rotate(.5deg);
			}
			100% {
				transform: translateX(-2px) rotate(-.5deg);
			}
		}
	}
	
	// posts that get deleted have `.deleted-post` added to `.postContainer`,
	// along with a `<strong class="warning">[Deleted]</strong>` added between
	// `.postInfo`'s checkbox and `.nameBlock`
	.deleted-post
		opacity .54
		.post,
		.stub
			background-color mix(ss21red, ss21BackgroundColour, 10%)
	
	// 4CHANX: applies contact links to admins and mods
	.contact-links
		display inline-flex
		a
			margin-right .25rem
		&::after
			font-size 20px
			cursor help
	.contact-links:not(:hover) a
		display none
	
	// 4CHANX: anonymise
	:root.anonymize
		.name
			font-size 0
			&::before
				content 'Anonymous'
				font-size 1rem
		.postertrip, // hide tripcodes
		.n-pu // hide pass identifier
			display none
	
	// `<strong>[Deleted]</strong>` appears before `.nameBlock`
	.postInfo .warning
		//margin-right .25rem
	
	// 4CHANX: if enabled, allow you to jump to posts by the same id
	.is_index .postJumper
		display none // only show it in threads
	
	// we get fancy with the styling and make it stack
	.postJumper
		font-size 0
		display inline-flex
		flex-direction column
		justify-content center
		//margin 0 .25rem
		a
			width .75rem
			&::after
				font-size .75rem
				transition opacity .25s
				opacity .54
			&:hover::after
				opacity .89
	
	.flag
		//margin 0 .25rem
	
	// 4CHANX: copy text link hidden textarea
	// wonder if a visiblity: hidden would suffice here
	.copy-text-element
		height 0
		width 0
		position absolute
		top -100rem
	
	// 4CHANX: permanent announcement on /qa/
	.fcx-announcement
		position fixed
		z-index 5
		bottom 1rem
		left 1rem
		background-color ss21BackgroundElevated
		padding .5rem 1rem
		borderRadius()
		z-depth(8)
		a
			color ss21primary
			&:hover
				color shade(ss21primary, 10%)
	
	/**
	* catalogue support 
	* what level of css archeticure are you on?
	* idk, bem or something
	* ha, pathetic; watch this
	*/
	// XXX: 2022 WOW CONTAINER QUERIES
	// might be useful somehow
	/*
	.catalog-thread
		container inline-size / post
	
	@container post (max-width: 30ch)
		.catalog-post
			background red
	*/
	// first thing, hide a bunch of elements not needed when in catalogue mode.
	// because normal threads/posts are given their own visual style,
	// and because most of the information is hidden when shown in this particular
	// card style, a lot of that has to get reset when represented here
	.catalog-container > .hide-thread-button, // if enabled, thread hiding button
	.catalog-post .container, // backlink container
	.catalog-post .file, // all file-related information
	.catalog-post .watch-thread-link, // love heart for watching threads
	.catalog-post .postJumper, // post jumper
	.catalog-post .postNum, // view/reply button
	.catalog-post .postInfo .menu-button, // original menu button
	.catalog-post .extra-linebreak,
	.catalog-post [class^='qmark'] // XXX: due to the way ss21 does qmarks, this looks weird
		display none
	
	// hides small/large thumbnail options when viewing as masonry
	if ss21catalogueStyle == 2
		#index-size
			display none
		.navLinks::after
			content '"Masonry" mode might require an F5 to look good. Ignore the bottom of the page...'
			display block
			text-align center
			padding .5rem 1rem
			borderRadius()
			background-color rgba(0, 0, 0, .69)
			tc(@background-color, high)
			position absolute
			bottom 0
			left 50%
			max-width 20rem
			transform translateX(-50%) translateY(-75%)
			pointer-events none
	
	// removes the direct link to thread thumbnail and thread stats when
	// switching between 4chan x index and catalog (it keeps the old html for some reason)
	:root:not(.catalog-mode)
		.catalog-link,
		.catalog-stats,
		.catalog-replies
			display none
	
	// lots of explanation here for future looking back
	// next thing we do is reset `.board` a little
	:root.catalog-mode .board
		max-width 100% // normally `75rem`
		display grid
		grid-gap 1rem
		grid-auto-flow dense // honestly, this probably does nothing
		if ss21catalogueStyle == 1 // default-esque style
			grid-auto-rows 15rem // automatically create rows that are `240px` high
		if ss21catalogueStyle == 2
			grid-template-columns repeat(auto-fit, minmax(min(15em, 100%), 1fr))
			grid-template-rows masonry // lifted from https://css-tricks.com/a-lightweight-masonry-solution/
			justify-content center
	
	if ss21catalogueStyle == 2
		:root.catalog-mode .board:is([data-thread-count="1"], [data-thread-count="2"], [data-thread-count="3"], [data-thread-count="4"], [data-thread-count="5"], [data-thread-count="6"])
			grid-template-columns repeat(6, 1fr)
	
	if ss21catalogueStyle == 1
		:root.catalog-mode
			.board
				&.catalog-small
					grid-template-columns repeat(12, 1fr) // 12 rows for 'Small'
				&.catalog-large
					grid-template-columns repeat(8, 1fr) // 8 rows for 'Large'
		.catalog-thread
			height 15rem
			.postMessage
				max-height calc(15rem - 7rem - 27px)
				overflow hidden
			&.thread--extra-long,
			&.thread--silly-long,
			&.thread--new-lines
				grid-column span 2
				grid-row span 2
				height 31rem
				.catalog-thumb,
				.catalog-thumb-video
					height 15rem i
				.postMessage
					max-height calc(31rem - 15rem - 1rem - .8rem)
					overflow hidden
	
	.catalog-thread
		// reset what would normally be `.thread`
		padding 0
		margin 0
		// the article says you need `align-self: start;`, but this doesn't apply to `block` elements...
		align-self start
		&:hover
			z-index 2
	
	// in order to achieve the "whole card exapnded on hover"
	// but, this only applies in default-esque mode because in masonry mode, you will always
	// see the whole thread
	if ss21catalogueStyle == 1
		.catalog-container
			position absolute
			inset 0
			max-width none // normally `100%`, though not sure if it affects it
			&:hover
				.catalog-post
					transform scale(1.05) translateY(-1%)
					//margin -1rem -3rem
					// because menu is a child of the catalog post, the pixels used to calculate where to position it
					// next to the button you just clicked also get scaled up, so we try to counter the scale here
					.menu-button.active + #menu
						transform scale(1) translateX(70%) translateY(5%)
						position absolute
						top 16px i
						left auto i
						right 0 i
						&.left
							transform scale(1) translateX(0) translateY(5%)
				.postMessage
					max-height none
					overflow auto
	
	// regardless of `ss21catalogueStyle`, posts look different in catalogue mode
	.catalog-post
		// reset what would normally be `.post`
		display flex
		flex-direction column
		min-height 100% // XXX: better way to fill up container?
		transition all .25s
		width 100%
		position relative
	
	/**
	* html order is: file, link/thumb, stats, postinfo, postmessage
	* we switch it to: file, link/thumb, postinfo, postmessage, stats
	*/
	.file
		// XXX: if you ask me, this is not required and should not be used from the catalogue. even on hover
		order 1
	.catalog-link
		order 2
		display block // required to it being an `a` element
		.catalog-thumb,
		.catalog-thumb-video
			border-radius 4px 4px 0 0
			width 100% i
			// so the trade off here, is that you lose the "fluidity" of cards, that is
			// can't enforce the threads to keep to their 15rem height if each thumbnail
			// varies in height, so we force it at `7rem` which shrinks big images and
			// enlarges small ones
			height 7rem i
			if ss21catalogueStyle == 2
				height auto i
			// object-fit is here to try and make it look better, but since we can't determine
			// what image a user will upload, it may cut off in the grid
			object-fit cover
			if ss21readingMode == ss21dark
				opacity .8
			&.deleted-file
				min-height auto
		&:has(.no-file)
			min-height 4rem
	.catalog-stats
		order 5
		font-size .75rem
		padding .25rem .5rem
		margin-top auto
		display flex
		align-items center
		border-top 1px solid tint(ss21BackgroundElevated, 5%)
		span[title]
			color var(--text-hint-on-background)
			cursor help
			span
				color var(--text-primary-on-background)
		.catalog-icons
			flex 1
			display flex
			justify-content flex-end
		.menu-button
			opacity 1
			transition opacity .25s
			will-change opacity
	.catalog-post
		.postInfo
			all unset
			order 3
			position relative
			*
				display none
		.postMessage
			order 4
			font-size .75rem
			padding .25rem .5rem
			&:empty
				display block // this forces `catalog-stats` to the bottom
			if ss21catalogueStyle == 1
				flex 1
				//flex 1 1 0 // XXX: DUH WHY DONT I UTILISE FLEX BASES
				//overflow hidden
			if ss21catalogueStyle == 2
				flex 1
			// XXX: temp solution, make [code] %-based
			.prettyprint
				font-size 87.5%
	
	// XXX: keep the subject overlay separate
	.catalog-post .subject:not(:empty)
		display block
		text-shadow 0 1px 2px rgba(0 0 0 .3)
		background-image linear-gradient(to top, black, transparent)
		padding .5rem
		width calc(100% - 1rem)
		position absolute
		bottom 0
		// 1 line subject, overflow hidden
		//overflow: hidden;
		//white-space: nowrap;
		//text-overflow: ellipsis;
		// https://ishadeed.com/article/css-short-long-content/
		// fancy line-clamp, but can't use padding
		padding-bottom .25rem
		display -webkit-box
		-webkit-line-clamp 2
		-webkit-box-orient vertical
		overflow hidden
		pointer-events none
		/*
		tc(black, high)
		text-shadow 0 1px 2px rgba(0 0 0 .3)
		background-image linear-gradient(to top, black, transparent)
		padding .5rem
		width 100%
		position absolute
		top calc(var(--tn-h) * 1px)
		pointer-events none
		*/
		&::after
			// get rid of 'by' that normally is applied
			display none
	
	:root.werkTyme .catalog-post .werkTyme-filename
		height 7rem
		display block
		width 100%
		text-align center
		overflow hidden
	
	// 4CHANX: if 'show replies' is enabled, on catalogue they are added to
	// `.catalog-post` upon hovering over `.thread`
	// XXX: at this stage, the issue is the text is not respecting the max width of each column in the grid
	/*
	* https://codepen.io/eddiebluh/pen/EyoWvp
	* https://codepen.io/shadeed/pen/mdyMmwd/398ccffcd437a2fb042f5ce3bdd68c57
	* https://ishadeed.com/article/min-max-css/#setting-min-width-to-zero-with-flexbox
	* https://ishadeed.com/article/css-short-long-content/
	*/
	.catalog-replies
		//display none i
		order 6
		font-size .75rem
		.catalog-reply
			display flex
			flex-direction row
			flex-wrap wrap
			align-items stretch
			padding .25rem
			border-top 1px solid darken(ss21BackgroundElevated, 25%)
			span
				font-size 0
				color var(--text-hint-on-background)
				margin-right .25rem
				time
					font-size .75rem
			.catalog-reply-excerpt
				overflow hidden
				white-space nowrap
				text-overflow ellipsis
				flex 1
				min-width 0
			.catalog-reply-preview
				margin-left .25rem
	
	// hide replies after hovering is done so they don't stay rendered
	.catalog-thread:not(:hover) .catalog-replies
		display none
	
	// only show the menu on hover
	// XXX: probably needs a background
	.catalog-thread:not(:hover):not(:focus-within) .menu-button
		opacity 0
	
	// pagelist styling
	.pagelist
		display flex
		margin 1rem
		button
			display none // we utilise icons as opposed to buttons
		.pages:not(.cataloglink)
			font-size 0 // get rid of surrounding brackets
			flex-grow 1 // make all the pages fill the center
			display flex
			justify-content space-between // auto space, as pages can differ
			align-items center
			strong
				display contents
				a
					background-color ss21primary
		a
			font-size 2rem
			font-weight 700
			flex-shrink 0
			display inline-flex
			justify-content center
			align-items center
			background-color transparent
			border-radius 100%
			aspect-ratio 1/1
			width 4rem
			transition background-color .25s
			&:hover
				background-color alpha(ss21primary, .54)
		.prev,
		.next
			display contents
			&:has(button[disabled]) a
				pointer-events none
				opacity .42
	@media (max-width: 75rem)
		.pagelist
			overflow-x auto
			a
				font-size 1rem
				width 2rem
	
	// non json index support
	.pagelist.desktop
		display flex i // XXX: might be able to drop the important with better selectors
		.prev,
		.next
			.pageSwitcherForm
				display contents
			span
				// treat it as a button, though this won't honour the button style
				font-size 0.875rem
				line-height 1
				letter-spacing 0.09em
				display inline-flex
				align-items center
				padding 0 0.75rem
				min-height 2.25rem
				min-width 4rem
				color var(--grey-900)
				background-color var(--grey-500)
				pointer-events none
				opacity .42
				border-radius 32rem
				padding 0 24px
			input[type="submit"]
				height auto
	
	// bottom board navigation
	// XXX: on fresh 4chan x install, this is disabled
	:root.hide-bottom-board-list
		#boardNavDesktopFoot
			display none
		.absBotText
			border-radius 64px 64px 0 0
	
	// SIDEDISH: this grabs the current board list and categories from 4chan.org
	// !important is used because it grabs the literal HTML, inline styles and all
	#boardNavDesktopFoot
		color var(--grey-500)
		background-color var(--grey-900)
		padding 3rem 1.5rem 1rem
		position relative
		border-radius 64px 64px 0 0
		margin 0 1rem
		.boardList
			display grid
			grid-gap 1rem
			grid-template-columns repeat(5, 1fr)
			max-width 75rem
			margin auto
			overflow-x auto
		h3
			font-size 1.25rem
			letter-spacing 0.03em
			text-transform uppercase
			color var(--grey-300)
			text-decoration none i
			display inline-block i
		ul
			list-style none
			padding 0
			margin 0 0 1rem 0
		li
			margin-bottom .25rem
		sup
			color ss21red
			vertical-align baseline i
		a:hover,
		.current
			color var(--grey-300)
		.clear-bug
			display none
	
	// copyright information in the footer
	:root.hide-bottom-board-list .absBotDisclaimer
		border-top 0
		padding-top 3rem
	
	.absBotText
		font-size .875rem
		color var(--grey-500)
		background-color var(--grey-900)
		padding 0 1.5rem
		position relative
		overflow hidden
		margin 0 1rem
		user-select none
	
	.absBotDisclaimer
		display block
		border-top 1px solid var(--grey-500)
		max-width 75rem
		padding-top 1rem
		margin 0 auto 1rem
	
	#footer-links
		font-size 0
		max-width 75rem
		padding-bottom 3rem
		margin auto
		position relative
		&::after
			content url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQAgMAAABinRfyAAAACVBMVEUAAAAAAABmzDMXpqcGAAAAAXRSTlMAQObYZgAAADxJREFUCNdjYIADVgfGAAapCWxLGNiWSE1gkFoitYSBNYA1gAEJBLAyMDAukXKAKIEQKZITGBgFWBzACgCbuwrJhJgswAAAAABJRU5ErkJggg==')
			display block
			position absolute
			top 0
			right 0
			filter grayscale(1)
			opacity .69
		a
			font-size .875rem
			display inline-block
			margin-right 3rem
			&:hover
				color var(--grey-300)
	
	.ss21--spinner-text
		color var(--grey-500)
		position absolute
		pointer-events none
		width 250px
		top 0
		right 50px
		animation spinningText 40s infinite
		transform-origin 50% 50%
		svg
			font-size 63px
			letter-spacing 22px
			font-weight 900
			fill var(--grey-500)
	
	@media (max-width: 1600px)
		.ss21--spinner-text
			top 69px
	
	@css {
		@keyframes spinningText {
			0% {
				transform: rotate(0deg);
				animation-timing-function: linear;
			}
			100% {
				transform: rotate(360deg);
			}
		}
	}
	
	// the quick reply
	// XXX: https://developer.mozilla.org/en-US/docs/Web/CSS/::file-selector-button
	// XXX: https://github.com/twbs/bootstrap/compare/98cd0eee62...a1d0afe81c
	// the qr is rendered the same essentially on every board, so let's get this
	// massive selector chain over and done with
	#qr.autohide:not(.focus):not(:hover):not(:active) > form, // autohide the qr form when not in use
	#autohide, // the checkbox to autohide (click the label)
	#qr.reply-to-thread:not(.show-new-thread-option) select[data-name="thread"], // hide new thread options if enabled
	body:not(.board_f) #qr [name="filetag"], // tag for flash files when not on /f/
	#qr.reply-to-thread [name="filetag"], // tag for flash files when in a thread (regardless if on /f/ or not)
	#qr:not(.has-sjis) #sjis-toggle, // only show shift_jis on boards that support it (/jp/)
	#qr:not(.has-math) #tex-preview-button, // only show tex on boards that support it (/sci/)
	#qr.tex-preview .textarea > :not(#tex-preview), // show the live tex preview
	#qr:not(.tex-preview) #tex-preview, // hide the live tex preview
	#qr:not(.dump) #dump-list-container, // when not in dump mode, hide the dumper
	#qr .oekaki.has-file, // don't offer to start a fresh drawing if there's a file
	#file-n-submit:not(.has-file) #qr-filerm // file remove icon if there is no file
		display none
	
	// XXX: auto-hide checkbox should be keyboard accessible
	
	#qr
		position fixed
		z-index 10
		background-color var(--background-primary)
		width 35rem
		max-height 90vh
		z-depth(8)
		borderRadius()
		contain paint
		if ss21QRPosition == 2
			top auto i
			right 0 i
			bottom 0 i
			left auto i
			width 25rem
		> .move
			background-color ss21primary
			tc(@background-color, high)
			padding 0 1.5rem
			display flex
			align-items center
			justify-content space-between
			height 3rem
			> label
				text-transform lowercase
			> .close
				font-size 0
				tc(ss21primary, medium)
				transition color .25s
				order 3
				margin-left 1.5rem
				&:hover
					tc(ss21primary, high)
		form
			padding 1rem
			max-height calc(100vh - 5rem)
			overflow hidden auto
			.persona
				display flex
				margin-bottom .5rem
				.field
					flex 1
					will-change flex
					transition border .25s, box-shadow .25s, flex .25s
					&:not(:first-of-type)
						margin-left .5rem
					&:hover
					&:focus
						flex 1.5
				button
					margin-right .5rem
			.textarea
				position relative
				margin-bottom .5rem
				.field
					display block
					min-height 10rem
					width 100%
			> select
				width 100%
			input[type="file"]
				position absolute
				visibility hidden
		select[name] // flag and flash tag selecter
			margin-top .5rem // normally we only apply bottom margin, but this only happens on 3 boards
	
	// when shift_js is enabled, switch the font for the qr and the button
	// https://en.wikipedia.org/wiki/Shift_JIS_art
	#sjis-toggle,
	#qr.sjis-preview textarea
		font 16px/1 "IPAMonaPGothic", "Mona", "MS PGothic", monospace
	
	// make it visually obvious that the sjis mode is on. overrides default button styles
	#qr.sjis-preview #sjis-toggle
		background-color ss21orange
	
	// preserves white space when previewing tex on /sci/
	#tex-preview
		white-space pre-line
	
	// the subset 'E' in 'TEX' looks weird
	#tex-preview-button
		sub
			margin-right .125em
			bottom -.5em
	
	// 4CHANX: this exists in the original 4chan x css, no clue when the element even appears
	//#qrtab { border-radius: 3px 3px 0 0;margin-bottom: 1px; }
	
	// recaptcha related
	.captcha-root
		position relative
		margin-bottom .5rem

	.captcha-container > div
		margin auto
	
	.captcha-counter
		text-align center
	
	// support noscript recaptcha
	#qr.captcha-v2 #qr-captcha-iframe
		width 302px
		height 423px
		display block
		margin auto
	
	// oekaki support for /i/ and /ic/ mainly, but also for any board
	// XXX: find a better way to present the width/height input
	// XXX: make input[type="color"] look potentially nicer
	.oekaki
		display flex
		align-items stretch
		margin-bottom .5rem
		&.has-file
			display none
		#qr-draw-button
			width 15%
		& > label
			display flex
			flex 1 1 auto
			align-items center
			min-width 0
			margin-left .5rem
			& > span
				flex 1 1 auto
				min-width 0
				flex-wrap nowrap
			& > input
				flex 1 1 auto
				width 3rem
				margin-left .25rem
		& > .oekaki-bg
			position relative
			display inline-flex
			align-items center
			justify-content center
			width 15%
			margin-left .5rem
			& input[name="oekaki-bg"]
				position absolute
				top 1px
				left 1px
				&:not(:checked) + input[name="oekaki-bgcolor"]
					visibility hidden // if no background for your drawing is needed, hide the background colour option
	
	input[name="oekaki-bgcolor"]
		padding 0
		border 0
		borderRadius()
		background var(--grey-500)
		height 100%
		width 100%
	
	// file handler for the qr
	#file-n-submit
		display flex
		height calc(2.5rem + 2px) // technically each row of the qr is this height
		//align-items stretch
		input[type="submit"]
			width 15%
			margin-left .25rem
			background-color ss21green
			/*
			&:focus
				box-shadow 0 0 0 .25rem alpha(lighten(ss21primary, 50%), .25)
			if ss21buttonStyle == 1
				background-color ss21green
				tc(ss21green, high)
				z-depth(2)
				&:hover
					background-color mix(#fff, @background-color, 10%)
				&:active
					background-color mix(#fff, @background-color, 12%)
					transform translateY(1px)
			else if ss21buttonStyle == 2
				color ss21green
				background transparent
				border 1px solid ss21green
				&:hover
					background-color rgba(ss21green, 0.1)
				&:active
					background-color rgba(ss21green, 0.25)
					transform translateY(1px)
			else if ss21buttonStyle == 3
				color ss21green
				background transparent
				&:hover
					background-color rgba(ss21green, 0.1)
				&:active
					background-color rgba(ss21green, 0.25)
					transform translateY(1px)
	// XXX: make submit button look better
	*/
	#qr-file-button
		width 15%
		margin-right .25rem
		&:focus
			box-shadow 0 0 0 .25rem alpha(lighten(ss21primary, 50%), .25)
	
	// this element is given the `.field` class despite not being one, so we can
	// use the handy `all: unset` to help us out and reset it
	#qr-filename-container
		all unset
		flex 1
		min-width 0
		display flex
		align-items center
		position relative
	
	// no file selected text
	#qr-no-file
		color var(--text-secondary-on-background)
		flex 1
		min-width 0
		overflow hidden
		text-overflow ellipsis
		white-space nowrap
		cursor pointer // look, only because you can click it
	
	#file-n-submit.has-file #qr-no-file
		display none
	
	// file selected, also editable
	#qr-filename
		all unset
		display none
		flex 1
		min-width 0
		overflow hidden
		text-overflow ellipsis
		white-space nowrap
		margin-right .25rem
		//&:focus
		// min-width 100% // XXX: something to think about for long filenames
	
	#file-n-submit.has-file #qr-filename
		display inline-block
	
	#qr:not(.has-spoiler) #qr-spoiler-label, // only show spoiler image option on boards that support it
	#file-n-submit:not(.has-file) #qr-spoiler-label // only show spoiler option when a file is uploaded
		display none
	
	#qr-spoiler-label
		display inline-flex
		align-items center
		margin-right .25rem
		#qr-file-spoiler
			position absolute
			visibility hidden
			margin 0
			&:checked + .checkbox-letter::after
				tc(rgba(ss21BackgroundElevated), high)
		.checkbox-letter
			font-size 0
			display inline-block
			&::after
				tc(rgba(ss21BackgroundElevated), low)
				transition color .25s
			&:hover::after
				tc(rgba(ss21BackgroundElevated), medium)
	
	#qr-filename-container
		& > a
			display inline-flex
			align-items center
			margin-right .25rem
			cursor pointer
			.fa
				display inline-flex
				align-items center
				&::after
					tc(rgba(ss21BackgroundElevated), low)
					transition color .25s
				&:hover::after
					tc(rgba(ss21BackgroundElevated), medium)
	
	#qr-filename-container #qr-filerm .fa-times-circle
		&::after
			color rgba(ss21red, .54)
		&:hover::after
			color rgba(ss21red, .89)
	
	#custom-cooldown-button:not(.disabled) .fa-clock-o::after,
	#qr.dump #dump-button .fa-plus-square::after
		tc(rgba(ss21BackgroundElevated), high)
	
	#char-count
		font-size .75rem
		position absolute
		pointer-events none
		right .75rem
		bottom 0
	
	// qr dump list ui
	#dump-list .qr-preview:only-of-type > .remove, // if there's only post in the dump list, don't show the option to remove it
	.qr-preview:not(.has-file) label, // if a post has no file attached, don't show the option to spoiler it
	#qr:not(.has-spoiler) .qr-preview-spoiler // only show the spoiler option if the board supports it
		display none
	
	#qr.dump #dump-list-container
		display block // only display the dump list when enabled
		position relative
		overflow-y hidden
		margin-bottom .5rem
		background-color rgba(0, 0, 0, .33)
	
	#dump-list
		overflow auto
		white-space nowrap
		display flex
		flex-wrap wrap
		min-height 8.5rem // height of 2 previews
		max-height 10rem // height of 3 previews
		padding .25rem
		.qr-preview
			counter-increment thumbnails
			cursor move // grab?
			display inline-block
			height 5rem
			width 5rem
			padding .25rem
			margin .25rem
			opacity .6
			overflow hidden
			position relative
			background-size cover
			flex none
			transition opacity .25s, transform .25s
			&::before
				content: counter(thumbnails)
				position absolute
				display inline-flex
				align-items center
				justify-content center
				height 1rem
				width 1rem
				border-radius 50%
				top 1px
				right 1px
				font-size .625rem
				color #fff
				background-color rgba(33, 33, 33, .5)
			&:hover
				opacity .87
			&:focus
				opacity .87
				//cursor grabbing // XXX: doesn't maintain this grabbing cursor
			&#selected
				opacity 1
			&.drag
				transform scale(.8)
			&.over
				transform scale(1.1)
				z-index 1
				border 1px dashed #fff
			& > .remove
				display inline-flex
				cursor pointer
				color ss21red
	
	#add-post
		font-size 0
		position absolute
		right 0
		bottom 0
		&::after
			font-size 3rem
			color ss21blue
	
	// XXX: july 2021: new captcha system
	#t-resp
		font inherit i
		font-family var(--font-monospace) i
		width auto i
		height auto i
		margin-right .5rem i
		display inline-block
		background inherit
		padding .5rem .75rem i
		border 1px solid alpha(ss21OppColour, .33)
		borderRadius()
		transition border .25s, box-shadow .25s
		&:hover
			border-color alpha(ss21OppColour, .8)
		&:focus
			border-color ss21primary
			box-shadow 0 0 0 .2rem alpha(ss21primary, .25)
	
	#t-cnt:not([style*="width"]),
	#t-slider[style*="vis"]
		display none
	
	#t-slider
		margin-top .25rem i
	
	if ss21readingMode == ss21dark
		#t-cnt
			filter invert(.935)
	
	// XXX: https://github.com/ccd0/4chan-x/issues/3196
	#t-bg
		filter sepia(100%) saturate(500%) hue-rotate(90deg) brightness(100%) contrast(100%)
	
	.captcha-container
		button
			font-size .875rem i
			padding 0 .75rem i
			margin 0 i
			width auto i
			height 42px i
			&:first-of-type
				margin-right .5rem i
	
	// 4CHANX: settings
	// easier styling thanks to https://github.com/ccd0/4chan-x/pull/2322
	#overlay
		position fixed
		display flex
		align-items center
		justify-content center
		top 0
		left 0
		width 100%
		height 100%
		z-index 20
		background-color rgba(33, 33, 33, .75) // XXX: overlay darkness and alpha needs to be consistent
	
	// the settings itself contains elements that need to be rebooted again
	// due to the way they are used and laid out
	#fourchanx-settings
		background-color var(--background-primary)
		width 75rem
		max-width 90%
		height 90vh
		margin auto
		display flex
		flex-direction column
		contain paint
		z-depth(24)
		borderRadius()
		nav
			font-size 0
			background-color ss21primary
			tc(@background-color, medium)
			display flex
			padding 0 1.5rem
			text-transform lowercase
			.sections-list,
			.credits
				display flex // XXX: needs better overflow support on small resolutions
			// this `p` element is used to spit out the import/export results of 4chan x
			// settings. we conveniently use it to space out the settings nav links
			.imp-exp-result
				flex 1
				margin 0 // unset the margin given in the reboot
			& a:not([download])
				font-size 1rem
				word-break normal // one of the few places we don't want this
				display inline-flex
				align-items center
				height 3rem
				padding 0 .5rem
				cursor pointer
				position relative
				&:hover
					tc(ss21primary, high)
				&:not([download]).tab-selected
					tc(ss21primary, high)
					&::after
						display block
				&:not(.close)::after
					display none
					position absolute
					bottom 0
					left 0
					width 100%
					height 2px
					content ''
					pointer-events none
					background-color var(--secondary)
			a[href="https://www.4chan-x.net/"] // hides the link to 4chan x homepage, nobody actually goes there?
				display none i
		fieldset
			padding 0
			//border 1px solid var(--text-hint-on-background)
			//borderRadius()
			//border-bottom 1px solid var(--text-hint-on-background)
			margin-bottom 1rem
			&:last-of-type
				border 0
				margin 0
		legend
			padding 0
			font-size 1.25rem
			font-weight 700
			text-transform uppercase
		table // keybinds table
			margin auto
		textarea
			width 100%
		.field
			font-family var(--font-monospace)
		code,
		kbd
			font-size .875em
			if ss21readingMode == ss21dark
				color #f5f7ff
				background-color #202746
			else if ss21readingMode == ss21light
				color #202746
				background-color #f5f7ff
			borderRadius()
			padding .2rem .4rem
	
	if ss21navRail == 1
		@css {
			@keyframes slideIn {
				from {
					transform: translateX(-100%);
				}
				to {
					transform: translateX(0);
				}
			}
			@keyframes slideOut {
				from {
					transform: translateX(0);
				}
				to {
					transform: translateX(-100%);
				}
			}
		}
		#overlay
			align-items initial
			justify-content initial
		#fourchanx-settings
			flex-direction row
			margin initial
			height 100vh
			border-radius 0
			transition all .25s
			animation slideIn .25s;
			&.active
				animation slideOut .25s;
			nav
				flex-direction column
				padding .5rem .125rem
				.sections-list,
				.credits
					flex-direction inherit
					a
						display inline-flex
						flex-direction column
						align-items center
						justify-content center
						font-size .75rem
						min-height 4rem
						min-width 4rem
						height auto
				a::before
					font-family: 'Material Symbols Outlined';
					font-weight: normal;
					font-style: normal;
					font-size: 24px;
					line-height: 1;
					letter-spacing: normal;
					text-transform: none;
					display: inline-block;
					white-space: nowrap;
					word-wrap: normal;
					direction: ltr;
					-webkit-font-feature-settings: 'liga';
					-webkit-font-smoothing: antialiased;
					// added to make it m3
					border-radius 32rem
					padding .25rem 1rem
					transition all .25s
		#fourchanx-settings nav
			a:hover::before,
			.tab-selected::before
				font-variation-settings "FILL" 1
				padding .25rem 1.5rem
				background-color shade(ss21primary, 15%)
			.tab-selected::after
				display none i
			.tab-main::before
				content 'home'
			.tab-filter::before
				content 'tune'
			.tab-sauce::before
				content 'image_search'
			.tab-advanced::before
				content 'settings'
			.tab-keybinds::before
				content 'keyboard_alt'
			.tab-ss21::before
				content 'waves'
			.export::before
				content 'file_upload'
			.import::before
				content 'file_download'
			.reset::before
				content 'history'
			a[href*="blob"]::before
				content 'commit'
			a[href*="report"]::before
				content 'report'
			.fa-times::before
				content 'menu_open'
			.fa-times::after
				display none
	
	.section-main a,
	.section-filter a,
	.section-advanced a
		color ss21primary
		&:hover
			color shade(ss21primary, 10%)
	
	@media (max-width: 60rem)
		#fourchanx-settings nav a:not([download])
			font-size .75rem
	
	/**
	 * since `.unscroll` isn't added to `body`, we can make use of some bleeding edge
	 * CSS, in the form of `overscroll-behavior`, which means scrolling is contained
	 * to the settings and will not effect the entire document
	 * https://caniuse.com/#feat=css-overscroll-behavior
	 */
	
	.section-container
		flex 1
		overflow auto
		overscroll-behavior contain
		padding 1rem
		position relative
	
	.section-main
		div[data-name]
			padding .25rem
			borderRadius()
			transition background-color .25s
			&:hover
				background-color alpha(shade(ss21BackgroundElevated, 50%), .33)
		input[type="checkbox"]
			float left
			margin-top 12px
			margin-right 12px
		.description
			font-size .875rem
			color var(--text-hint-on-background)
			padding-left 32px
			display block
		.suboption-list
			margin-top .25rem
			margin-left .5rem
		div[data-name="Stubs"] + div
			margin-top .5rem
		div[data-name="Pass Link"] + p
			margin .5rem 0
		button + .description
			padding-left 0
			margin-top .5rem
			margin-left .5rem
			display inline-block
	
	// filter section
	.section-filter
		ul
			padding 0
			margin 0
		li
			margin 0 1.5rem .25rem
		select
			width 100%
			margin-bottom 1rem
		textarea
			min-height 70vh
	
	// sauce section
	.section-sauce
		ul
			padding 0
		li
			margin 0 1.5rem .25rem
		textarea
			min-height 70vh
	
	#sauce-doc-expand:not(:checked) ~ #sauce-doc
		max-height 9rem
		overflow auto
	
	#sauce-doc > label
		float right
	
	#sauce-doc
		margin-bottom 1rem
	
	.favicon-preview
		display inline-flex
		flex-direction row
		gap .25rem
		margin-left .25rem
	
	// keybinds section
	.section-keybinds
		div
			margin-bottom .5rem
	
	// advanced section
	// XXX: needs a lot of small tweaks to improve visual/grid consistency + vertical rhythm
	.section-advanced
		textarea
			min-height 7.5rem
		fieldset:first-child
			position relative
		#archive-table + br
			display none
		.archive-cell
			min-width 10rem
		.note
			color var(--text-secondary-on-background)
		.file-info-preview
			font-size .75rem
			display flex
			align-items center
			gap .25rem
			.fa
				display contents
				&::after
					font-size 1rem
					inline-size .75rem
	#archive-board-select
		position absolute
		top -2.5rem
		left 7rem
		width 7.5rem
	
	// XXX: quick fix for oneechan (which should not be used anyway)
	#sauce-doc-expand + .riceCheck
		display none
	
	// disabled features
	fieldset:has(.warning:not([hidden]))
		opacity .5
	
	// thread updater and stats. ideally, leave these in the header. but if
	// you prefer it to be floating and fixed, support that too
	#updater
		tc(ss21primary, medium)
	
	#thread-stats
		tc(ss21primary, low)
		span
			tc(ss21primary, medium)
		.warning // have to re-mention this here due to specificty
			color ss21red
	
	:root.float #updater,
	:root.float #thread-stats
		position fixed
		z-index 5
		background-color ss21primary
		display inline-flex
		align-items center
		justify-content center
		padding .5rem
		borderRadius()
		z-depth(4)
		//height 1.75rem
	
	// make the draggable area a little bigger than the updater itself
	#updater > .move
		position absolute
		z-index -1
		top -.125rem
		right -.125rem
		bottom -.125rem
		left -.125rem
	
	// make these appear clickable
	#update-timer,
	#page-count
		cursor pointer
	
	// give `pointer-events: none` so that the element can be dragged around
	// without selecting text
	:root.float #thread-stats > .move > span:not(#page-count)
		pointer-events none
	
	.new
		color ss21green
		margin-right .5rem
	
	// we go a little overboard with the micro-interaction here, but whatever;
	// adds a "ripple" effect when watching a thread
	// XXX: both the heart and star icon don't actually fill up the entire 24px
	// we allocate for icons, which throws off visual consistency by adding a "gap"
	.watch-thread-link
		display inline-flex
		position relative
		//margin-right .25rem
		opacity .54
		will-change opacity
		transition opacity .25s
		&:hover
			opacity .87
		&::before
			content ''
			position absolute
			opacity 0
			pointer-events none
			border-radius 50%
			background-color ss21red
			height 1.5rem
			width 1.5rem
			transform scale(.5)
			transform-origin 50% 50%
			will-change transform, opacity
			transition transform .25s, opacity .25s
		&:active::before
			opacity .25
			transform scale(1.5)
		&::after
			font-size 24px
	
	if ss21watchButton == 2
		.watch-thread-link
			position absolute
			top -1rem
			right 12.5rem
			background-color ss21primary
			border-radius 100%
			padding .25rem
			margin 0
			opacity 0
			z-depth(2)
			pointer-events none
		.opContainer:hover .watch-thread-link
			opacity 1
			pointer-events auto
	
	// thread watcher
	:root.fixed-watcher
		#thread-watcher
			position fixed
			z-index 15
		#watched-threads
			max-height 70vh
	
	#thread-watcher
		position absolute
		z-index 5
		background-color var(--background-primary)
		white-space nowrap
		min-width 15rem
		z-depth(8)
		borderRadius()
		& > .move
			text-transform lowercase
			background-color ss21primary
			tc(@background-color, high)
			display flex
			align-items center
			padding 0 1.5rem
			height 3rem
			border-top-left-radius 4px
			border-top-right-radius 4px
			& > a
				tc(ss21primary, medium)
				transition color .25s
				&:hover
					tc(ss21primary, high)
			& > .refresh
				display inline-flex
				align-items center
				margin-left .5rem
			& > .menu-button
				display inline-flex
				min-width 2rem
			& > .close
				font-size 0
		#menu
			text-transform capitalize // because of the lowercase aesthetic, the menu is affected
	
	// used to display the progress of the thread watcher checking the status of threads,
	// but we use it to stretch the distance between the icons
	#watcher-status
		flex 1
		text-align center
		pointer-events none // this is so you can still drag the window around while it's loading
	
	#watched-threads
		overflow hidden auto
		&:empty::after
			content 'No threads to display.'
			display inline-flex
			align-items center
			justify-content center
			width 100%
			height 3rem
		&:not(:hover)
			max-height 12rem
			overflow-y hidden
		& > div
			padding 0 1rem
			height 3rem
			display flex
			align-items center
			&:nth-of-type(odd)
				if ss21readingMode == ss21light
					background-color darken(ss21BackgroundElevated, 3%)
				else if ss21readingMode == ss21dark
					background-color lighten(ss21BackgroundElevated, 6%)
		.fa-times
			display inline-flex
			margin-right .5rem
			color ss21red
			&::after
				opacity .6
				transition opacity .25s
			&:hover::after
				opacity .87
		.watcher-link
			display inline-flex
			flex-direction row
			max-width 25rem
		.watcher-page,
		.watcher-unread
			flex 0
			margin-right .25rem
		.watcher-title
			overflow hidden
			text-overflow ellipsis
			flex 1
		.current .watcher-title
			font-weight 700
		.dead-thread .watcher-link
			text-decoration line-through
			opacity .75
		.replies-unread .watcher-link
			color ss21blue
		.replies-quoting-you .watcher-link,
		.last-page .watcher-page
			color ss21red
	
	.shortcut #watcher-link.replies-quoting-you::after
		color invert(ss21primary)
	
	// menus
	// styled based on:
	// https://www.material.io/components/menus/
	// https://twbs-bootstrap.netlify.com/docs/4.3/components/dropdowns/
	// https://www.carbondesignsystem.com/components/dropdown/code/
	.menu-button
		position relative
		display inline-flex
		align-items center
		justify-content center
		cursor pointer // sometimes it's a `span`, so we need this
	
	#menu
		position fixed
		z-index 10
		z-depth(8)
		color ss21TextPrimary
		background-color var(--background-primary)
		padding .5rem 0
		borderRadius()
		white-space nowrap
		outline none // XXX: doesn't need a focus style
		user-select none
	
	.entry
		display flex
		//justify-content space-between
		align-items center
		position relative
		min-width 10ch
		cursor pointer
		//padding 0 2.5rem 0 1rem
		padding 0 1rem
		line-height 2
		transition background-color .25s
		&:hover
			background-color var(--background-secondary)
		&::after
			// XXX: icons are added to some menu entries to look fancy
			//position absolute
			//right .75rem
			order -1
			font-size 18px
			margin-right 1rem
			//height 2.5rem
			color var(--text-hint-on-background)
		&.has-shortcut-text
			display flex
			justify-content space-between
			align-items center
		&[title*="volume"]
			display inline-flex
			align-items center
			justify-content center
			input
				order 1
				margin-left .5rem
		.shortcut-text
			color var(--text-hint-on-background)
			font-size 75%
			position absolute
			right .75rem
			line-height 2.5rem
		.field
			width auto
		input[type="number"]
			min-width 3.5rem
			width 3rem
			padding 0 0 0 .5rem
			margin-left 1rem
		input[type="checkbox"]
			margin-right 1rem
			height 1em
			width 1em
	
	.left .has-submenu
		padding 0 1rem
		&::after
			right auto
			left .75rem

	.submenu
		display none
		position absolute
		left 100%
		z-index 10
		z-depth(8)
		background-color var(--background-primary)
		padding .5rem 0
		borderRadius()
		margin-top calc(.5rem * -1) // counters the offset because of the top and bottom padding
		&[style*='m: 0']
			margin-top 0
			margin-bottom calc(.5rem * -1)
	
	// only show the submenu when its parent has hover/focus
	.focused > .submenu
		display block
	
	// moves the menu button of posts to the top right. reset for catalogue posts
	.post .menu-button
		position absolute
		top 2px
		right 1rem
	
	.post > .postInfo > .menu-button
		opacity 0
		will-change opacity
		transition opacity .25s
		&:focus
			opacity .6
	
	.post > .postInfo > .menu-button.active,
	.post:hover > .postInfo > .menu-button
		opacity .6
		&:hover
			opacity .87
	
	.catalog-thread[class*="thread-chip"] .catalog-post::before
		content ''
		font-size .75rem
		tc(ss21primary, high)
		background-color ss21primary
		borderRadius()
		padding 0 .25rem
		position absolute
		z-index 1
		top 0
		left 0
		transform translate(-.25rem, -.25rem)
		pointer-events none
	
	.catalog-thread.thread-chip--waywt .catalog-post::before
		content 'WAYWT'
	.catalog-thread.thread-chip--girl .catalog-post::before
		content 'GRILL'
	.catalog-thread.thread-chip--edc .catalog-post::before
		content 'EDC'
	.catalog-thread.thread-chip--watch .catalog-post::before
		content 'WATCH'
	.catalog-thread.thread-chip--skin .catalog-post::before
		content 'SKIN'
	.catalog-thread.thread-chip--hair .catalog-post::before
		content 'HAIR'
	.catalog-thread.thread-chip--tattoo .catalog-post::before
		content 'TATTOO'
	.catalog-thread.thread-chip--fragrance .catalog-post::before
		content 'SMELL'
	
	/**
	 * `#navlinks` is used to navigate to the next thread on the index, and to the
	 * top and bottom of the page within threads. not needed in catalogue mode, so it
	 * is hidden
	 */
	
	:root.catalog-mode #navlinks
		display none
	
	#navlinks
		position fixed
		z-index 10
		bottom 1rem
		right 1rem
		font-size 0
		color var(--text-secondary-on-primary)
		background-color ss21primary
		borderRadius()
		z-depth(4)
		overflow hidden
		&:not(:hover) // i find this visually annoying, so i think it should fade away
			opacity .5
			transition opacity 10s
		a:hover::after
			background-color darken(ss21primary, 15%)
			transition background-color .25s
	
	// 4CHANX: embedding
	// if media is embedded, remove the un prefix from inside the post
	.embedder:not(.embedded) > span
		display none
	
	// https://stackoverflow.com/a/60803488/490291
	// XXX: potentially fix resize embedded content
	.media-embed
		clear both
		display flex
		padding 0
		margin 0
		resize both
		overflow hidden
		iframe
			flex-grow 1
			padding 0
			border 0
			margin 0
	
	#embedding
		background-color var(--background-primary)
		position fixed
		z-index 10
		borderRadius()
		overflow hidden
		z-depth(8)
		&.empty
			display none
		& > div:first-child
			display flex
			align-items center
			font-size 0
			background-color ss21primary
			tc(ss21primary, high)
			padding 0 1.5rem
			height 3rem
		.move
			flex 1
			&::before
				content 'embedded content'
				font-size 1rem
		.jump
			margin-right .5rem
			opacity .6
			transition opacity .25s
			&:hover
				opacity .87
		.close
			opacity .6
			transition opacity .25s
			&:hover
				opacity .87
		audio
			min-width 30rem
	
	// 4CHANX: appchan's gallery mode, baked right into 4chan x
	// TODO: when you work out text colour, make the '/' in the counter lighter
	#a-gallery
		position fixed
		inset 0
		display flex
		flex-direction row
		background-color rgba(33, 33, 33, .75)
		z-index 50
	
	// container for images and controls
	.gal-viewport
		display flex
		flex-direction row
		align-items stretch
		flex 1
		overflow hidden
		position relative
	
	// gallery controls
	.gal-buttons
		position absolute
		z-index 2
		display flex
		top 1rem
		right 1rem
		background-color rgba(0, 0, 0, .5)
		tc(@background-color, high)
		padding .5rem
		borderRadius()
		& > a
			display inline-flex
	
	.gal-labels
		position absolute
		z-index 2
		right 1rem
		bottom 1rem
		display flex
		flex-direction column
		align-items flex-end
	
	.gal-count,
	.gal-name,
	.gal-sauce
		margin-top .5rem
		background-color rgba(0, 0, 0, .5)
		tc(@background-color, high)
		line-height 1
		padding .5rem
		borderRadius()
	
	.gal-sauce:empty
		display none
	
	// hide the stop icon if not sliding, hide the play if sliding
	.gal-buttons.gal-playing > .gal-start,
	.gal-buttons:not(.gal-playing) > .gal-stop
		display none
	
	.gal-close
		font-size 0
	
	// the image, video, or pdf
	.gal-image
		flex 1
		display flex
		align-items flex-start
		justify-content space-around
		overflow hidden
		margin 1rem
		& > a
			display block
			margin auto
	
	// make sure it takes up the whole viewport
	:root.gal-pdf .gal-image a,
	.gal-image iframe
		width 100%
		height 100%
	// XXX: i think something has changed, this needs to be adjusted
	// and, either stretch to it or fit to it
	:root.gal-fit-width .gal-image img,
	:root.gal-fit-width .gal-image video
		max-width 100%
	
	:root.gal-fit-height .gal-image img,
	:root.gal-fit-height .gal-image video
		max-height 85vh
	
	// previous and next buttons for gallery
	// XXX: this can look misaligned, and hovering prev/next is weird with overlapping of actual media
	.gal-prev
		position absolute
		z-index 1
		width 25%
		height 100%
		cursor url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='48' height='48' viewBox='0 0 24 24'%3E%3Cpath fill='rgba(255, 255, 255, .87)' d='M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z'/%3E%3C/svg%3E"), pointer
		&:hover
			background-image linear-gradient(to right, rgba(33, 33, 33, 1), rgba(0, 0, 0, 0))
	
	.gal-next
		position absolute
		z-index 1
		right 0
		width 25%
		height 100%
		cursor url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='48' height='48' viewBox='0 0 24 24'%3E%3Cpath fill='rgba(255, 255, 255, .87)' d='M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z'/%3E%3C/svg%3E") 48 0, pointer
		&:hover
			background-image linear-gradient(to left, rgba(33, 33, 33, 1), rgba(0, 0, 0, 0))
	
	// container for thumbnails
	// hide it if enabled
	:root.gal-hide-thumbnails .gal-thumbnails
		display none
	
	.gal-thumbnails
		display flex
		flex-direction column
		align-items center
		overflow-y auto
		background-color rgba(33, 33, 33, .25)
		border-left 1px solid tint(ss21BackgroundElevated, 10%)
	
	.gal-thumb
		display block
		max-width 10rem
		max-width 10rem
		padding .25rem
		transition background-color .25s
		&:hover
			background-color alpha(invert(ss21primary), .25)
	
	.gal-highlight
		background-color alpha(invert(ss21primary), .5)
	
	// SIDEDISH: support for the board drawer added by sidedish
	.ss21--board-drawer-background
		position fixed
		overflow hidden
		contain strict
		width 100%
		height 100%
		top 0
		left 0
		pointer-events none
		z-index 99
		&::before
			content ''
			display block
			will-change opacity
			background-color rgba(0, 0, 0, .6)
			position absolute
			top 0
			left 0
			height 100%
			width 100%
			opacity 0
			transition opacity .25s
	.drawer-open
		pointer-events auto
		.ss21--board-drawer
			transform translateX(0)
		&::before
			opacity 1
	.ss21--board-drawer
		width 20rem
		left 0
		right initial
		height 100%
		background-color ss21BackgroundElevated
		display flex
		position absolute
		flex-direction column
		will-change transform
		transform translateX(-100%)
		transition transform .25s
		overflow-y scroll
	.board-list-entry
		tc(ss21BackgroundElevated, high)
		display block
		height 3rem
		line-height 3
		padding 0 .5rem
		margin .5rem .5rem 0
		transition color .25s, background-color .25s
		borderRadius()
		&:last-child
			margin-bottom .5rem
		&.board--ws
			//background-color rgba(#d6daf0, .6)
			&:hover
				color #000
				background-color darken(#d6daf0, 5%)
		&.board--nws
			//background-color rgba(#f0e0d6, .6)
			&:hover
				color #800000
				background-color darken(#f0e0d6, 5%)
	
	// SIDEDISH: convert imperial (a.k.a. inferior) to metric
	.ss21--fit
		position fixed
		right 1rem
		z-index 10
		background-color ss21BackgroundElevated
		text-align right
		padding .5rem
		z-depth(4)
		borderRadius()
		transform-origin top right
		transition all .25s
		&:hover
			transform scale(2)
		&.ss21--fit-weight
			top 10rem
			&:hover + .ss21--fit-height
				top 19.5rem
		&.ss21--fit-height
			top 15rem
		.ss21--fit-input
			padding 0
			borderRadius()
			margin-bottom .25rem
			background none
			text-align right
			width 5ch
			border 1px solid alpha(ss21OppColour, .33)
			transition border .25s, box-shadow .25s
			&:hover
				border-color alpha(ss21OppColour, .8)
			&:focus
				border-color ss21primary
				box-shadow 0 0 0 .2rem alpha(ss21primary, .25)
		.ss21--fit-unit
			color var(--text-hint-on-background)
			margin-left .5ch
	
	// april fools 2020 support
	.xa20e::after
		font-size 18px
		line-height 1em
	.xa205 .xa20e::after
		content ''
	.xa209 .xa20e::after
		content ''
	.xa202 .post
		box-shadow inset 0 0 10px 0 #26D7525E
	.xa203 .post
		box-shadow inset 0 0 25px 2px #26D75273
	.xa204 .post
		box-shadow inset 0 0 35px 6px #26D752B3
	.xa205 .post
		box-shadow inset 0 0 50px 12px #26D752
	#xa20m
		position fixed
		bottom 0
		z-index 15
		color #fff
		padding .5rem 0
		background-color #C41E3A
		text-shadow 0 1px rgba(0, 0, 0, 0.5)
	
	// halloween 2020 support
	#skellington
		display block i
		position fixed
		right 0
		bottom 0
		pointer-events none
		opacity .87
		&.topskel
			transform rotate(180deg)
			bottom auto
			top 0
	
	// 2021 april fools support
	.xa21-notice
		display block i
		text-align center
		margin-top 1rem
	
	.is_index .xa21-notice
		margin 0 0 2rem 0
	
	.rake-btn
		height 24px
		margin-left .5rem
	
	.rake-btn::after
		content 'brush' // XXX: reduced to just the icon name to save lines
	
	// XXX: archive and /f/ `table` support
	// fun fact, the archive has about 10,000 entries displayed at any one time
	// in the archive table, `.teaser-col` can contain the subject (`b`), `.quote`,
	// or a `wbr` which breaks links
	.is_archive,
	.board_f.is_index
		.board
			max-width none
	
	.flashListing
		max-width 100%
		margin 1rem auto
		position relative
		vertical-align top
		word-break normal
		background-color var(--background-primary)
		td,
		th
			padding .25rem
			border-bottom 1px solid var(--text-hint-on-background)
		.postblock
			background-color ss21primary
			font-weight 700
			tc(@background-color, high)
		tbody
			vertical-align inherit
		.subject::after
			display none
		.file-col
			font-size 0
			a::after
				content attr(title)
				font-size 1rem
				color ss21primary
		.highlightPost
			background-color mix(ss21primary, #1f1f1f, 10%)
	
	// attempt to get "yotsuba" theme working
	// since stylus runs after page, it can't retroactively check if the page
	// is a .ws or .nws page, so we can't really even use variables from stylus
	// nor custom properties
	if ss21readingMode == ss21yotsuba
		:root
			&.ws
				color #000
				background-color #eef2ff
				.subject
					color #0f0c5d
				.name,
				.trip
					color #117743
				.postContainer a:not(.replylink)
					color #34343c
					&:hover
						color #d00
				.postContainer a.quotelink
					color #d00
				.boardTitle
					color #af0a0f
				.post
					border 1px solid #b7c5d9
					border-top 0
					border-left 0
				.field
					background #fff
			&.nws
				color #800
				background-color #ffe
				.subject
					color #cc1105
				.name,
				.trip
					color #117743
				.postContainer a:not(.replylink)
					color #00e
					&:hover
						color #f00
				.postContainer a.quotelink
					color #34343c
				.boardTitle
					color #800
				.post
					border 1px solid #d9bfb7
					border-top 0
					border-left 0
				.field
					background #fff
	
	if ss21readingMode == ss21tomorrow
		:root
			color #c5c8c6
			background-color #1d1f21
	
	// please turn off oneechan...
	:root.oneechan .fa-gears::after
		content 'sentiment_very_dissatisfied'
	:root.oneechan .tab-select:not(:checked) + .options-section
		display none i
	#oneechan-options
		background-color ss21BackgroundElevated
		width 75rem
		max-width 90%
		height 90vh
		margin auto
		display flex
		flex-direction column
		contain paint
		borderRadius()
		z-depth(24)
		position relative
	#options-tabs
		padding 0
		margin 0
		list-style none
		display flex
		flex-direction row
		background-color ss21primary
		padding 0 1.5rem
		text-transform lowercase
		.tab-label
			display inline-flex
			align-items center
			height 3rem
			padding 0 .5rem
			position relative
			tc(ss21primary, medium)
			transition color .25s
			&:hover
				tc(ss21primary, high)
			&::after
				display none
				position absolute
				bottom 0
				left 0
				width 100%
				height 2px
				content ''
				pointer-events none
				background-color var(--secondary)
			&.selected::after
				display block
	#options-container
		padding 1rem
		flex 1
		overflow-y scroll
		overscroll-behavior contain
	.buttons-container
		position absolute
		left 0
		bottom 0
	.import-input
		position absolute i
		width 1px i
		height 1px i
		padding 0 i
		margin -1px i
		overflow hidden i
		clip rect(0,0,0,0) i
		white-space nowrap i
		border 0 i
	.options-close
		display inline-flex
		justify-content flex-end
		padding .75rem 1rem
		if ss21readingMode == ss21light
			box-shadow 0 -1px 0 0 darken(ss21BackgroundElevated, 10%)
		else if ss21readingMode == ss21dark
			box-shadow 0 -1px 0 0 lighten(ss21BackgroundElevated, 15%)
		&::before
			content "This won't work... ->"
			line-height 36px
		.options-button
			margin-left .5rem
	
	#main-section
		.option
			display flex
			align-content center
			line-height 2.5rem
			height 2.5rem
			if ss21readingMode == ss21light
				border-top 1px solid darken(ss21BackgroundElevated, 10%)
			else if ss21readingMode == ss21dark
				border-top 1px solid lighten(ss21BackgroundElevated, 15%)
			&.header
				font-weight 700
		input[type="checkbox"]
			display inline-block i
			margin-top .65rem
			margin-right 1rem
			order -1
	
	// oneechan mascot selection
	#mascot-section
		display grid
		grid-gap 1rem
		grid-template-rows 1.5rem 1fr
		grid-template-columns repeat(auto-fit, minmax(200px, 1fr))
	.buttons-container
		grid-column 1 / -1
		margin 0
	.mascot-preview
		// these importants are needed because oneechan applies `background` instead of just `background-image`?
		background-position center i
		background-repeat no-repeat i
		background-size contain i
		height 250px
		position relative
		text-align center
		&:not(:hover) a:not(.mascot-name)
			opacity 0
		&.selected
			background-color rgba(0 0 0 .3) i
		.mascot-buttons
			position absolute
			bottom 0
			left 0
			right 0
		.mascot-link
			background-color rgba(0 0 0 .3)
			tc(@background-color, high)
			borderRadius()
			cursor pointer
			padding .25rem .5rem
		.mascot-name
			display block
		br
			display none
	
	:root.oneechan #id_css::after
		display none
	#mascot
		position fixed
		right 0
		bottom 0
		z-index -1
		img
			height auto
			width auto
			max-width 20rem
			opacity .25
			filter grayscale(.69)
			pointer-events none
	
	// XXX: `style#fourchanx-bgcolor-css` needs to go
	:root.oneechan .watch-thread-link
		background-image none i
	/*
	#oneechan-options
		background-color var(--background-primary)
		padding 1rem
		borderRadius()
		z-depth(8)
		&::after
			content "I told you, this isn't going to work."
		*
			display none
	*/
	/*
	// scroll snapping?
	:root.paged-mode
		scroll-snap-type y proximity
		.navLinks.json-index,
		.thread
			scroll-snap-align start
			scroll-margin-top 2rem // doesn't work when scrolling up due to autohide header
	*/
	// XXX: https://github.com/rcc11/4chan-sounds-player
	// users really should disable thread > limit post widths
	:root.fcsp-enabled
		#fcsp-container
			z-index 100
		svg
			display inline-block
	
	.ss21--download-all
		tc(ss21primary, medium)
		cursor pointer
		transition text-shadow .25s
		&:hover
			tc(ss21primary, high)
			text-shadow 0 0 1rem invert(ss21primary)
	
	.is_index .ss21--download-all
		display none
	
	.section-ss21 legend
		text-transform lowercase i
	
	.ss21-option
		min-height 56px
		padding-left 1rem
		margin-bottom -.125rem
	
	.ss21-description
		font-size .875rem
		color var(--text-hint-on-background)
		padding-left 1rem
		display block
	
	.test-page
		position fixed
		z-index 99
		display flex
		align-items center
		justify-content center
		top 0
		left 0
		width 100%
		height 100vh
		background-color rgba(0, 0, 0, .54)
	
	.test-page .page
		height 90vh
		width 90vh
		background-color #2d2d2d
		padding 1rem
		borderRadius()
		overflow-y scroll
		position relative
	
	.ss21-mdc-swatch
		display flex
		width 100%
		height 10rem
		align-items stretch
		.primary
			flex 1
	
	:root.is-search
		.boardTitle
			font-size calc(100vw / (var(--length, 1) * 0.5) * .8) i
			white-space nowrap i
		script + .container,
		.threadHideButton,
		.postMenuBtn
			display none
		.commentForm
			width fit-content
			margin 1rem auto 0
